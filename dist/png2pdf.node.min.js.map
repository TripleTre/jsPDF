{"version":3,"file":"png2pdf.node.min.js","sources":["../src/libs/AtobBtoa.js","../src/libs/globalObject.js","../src/libs/console.js","../src/jspdf.js","../src/modules/addimage.js","../src/libs/png.js","../src/modules/png_support.js","../src/index.js"],"sourcesContent":["import { globalObject } from \"./globalObject.js\";\n\nvar atob, btoa;\n\n(function() {\n\n  atob = require(\"atob\");\n  btoa = require(\"btoa\");\n})();\n\nexport { atob, btoa };\n","export var globalObject = (function() {\n  return \"undefined\" !== typeof window\n    ? window\n    : \"undefined\" !== typeof global\n    ? global\n    : \"undefined\" !== typeof self\n    ? self\n    : this;\n})();\n","import { globalObject } from \"./globalObject.js\";\n\nfunction consoleLog() {\n  if (globalObject.console && typeof globalObject.console.log === \"function\") {\n    globalObject.console.log.apply(globalObject.console, arguments);\n  }\n}\n\nfunction consoleWarn(str) {\n  if (globalObject.console) {\n    if (typeof globalObject.console.warn === \"function\") {\n      globalObject.console.warn.apply(globalObject.console, arguments);\n    } else {\n      consoleLog.call(null, arguments);\n    }\n  }\n}\n\nfunction consoleError(str) {\n  if (globalObject.console) {\n    if (typeof globalObject.console.error === \"function\") {\n      globalObject.console.error.apply(globalObject.console, arguments);\n    } else {\n      consoleLog(str);\n    }\n  }\n}\nexport var console = {\n  log: consoleLog,\n  warn: consoleWarn,\n  error: consoleError\n};\n","/* eslint-disable no-console */\n\nimport { globalObject } from \"./libs/globalObject.js\";\nimport { btoa } from \"./libs/AtobBtoa.js\";\nimport { console } from \"./libs/console.js\";\n/**\n * jsPDF's Internal PubSub Implementation.\n * Backward compatible rewritten on 2014 by\n * Diego Casorran, https://github.com/diegocr\n *\n * @class\n * @name PubSub\n * @ignore\n */\nfunction PubSub(context) {\n  if (typeof context !== \"object\") {\n    throw new Error(\n      \"Invalid Context passed to initialize PubSub (jsPDF-module)\"\n    );\n  }\n  var topics = {};\n\n  this.subscribe = function(topic, callback, once) {\n    once = once || false;\n    if (\n      typeof topic !== \"string\" ||\n      typeof callback !== \"function\" ||\n      typeof once !== \"boolean\"\n    ) {\n      throw new Error(\n        \"Invalid arguments passed to PubSub.subscribe (jsPDF-module)\"\n      );\n    }\n\n    if (!topics.hasOwnProperty(topic)) {\n      topics[topic] = {};\n    }\n\n    var token = Math.random().toString(35);\n    topics[topic][token] = [callback, !!once];\n\n    return token;\n  };\n\n  this.unsubscribe = function(token) {\n    for (var topic in topics) {\n      if (topics[topic][token]) {\n        delete topics[topic][token];\n        if (Object.keys(topics[topic]).length === 0) {\n          delete topics[topic];\n        }\n        return true;\n      }\n    }\n    return false;\n  };\n\n  this.publish = function(topic) {\n    if (topics.hasOwnProperty(topic)) {\n      var args = Array.prototype.slice.call(arguments, 1),\n        tokens = [];\n\n      for (var token in topics[topic]) {\n        var sub = topics[topic][token];\n        try {\n          sub[0].apply(context, args);\n        } catch (ex) {\n          if (globalObject.console) {\n            console.error(\"jsPDF PubSub Error\", ex.message, ex);\n          }\n        }\n        if (sub[1]) tokens.push(token);\n      }\n      if (tokens.length) tokens.forEach(this.unsubscribe);\n    }\n  };\n\n  this.getTopics = function() {\n    return topics;\n  };\n}\n\n/**\n * Creates new jsPDF document object instance.\n * @name jsPDF\n * @class\n * @param {Object} [options] - Collection of settings initializing the jsPDF-instance\n * @param {string} [options.orientation=portrait] - Orientation of the first page. Possible values are \"portrait\" or \"landscape\" (or shortcuts \"p\" or \"l\").<br />\n * @param {string} [options.unit=mm] Measurement unit (base unit) to be used when coordinates are specified.<br />\n * Possible values are \"pt\" (points), \"mm\", \"cm\", \"in\", \"px\", \"pc\", \"em\" or \"ex\". Note that in order to get the correct scaling for \"px\"\n * units, you need to enable the hotfix \"px_scaling\" by setting options.hotfixes = [\"px_scaling\"].\n * @param {string/Array} [options.format=a4] The format of the first page. Can be:<ul><li>a0 - a10</li><li>b0 - b10</li><li>c0 - c10</li><li>dl</li><li>letter</li><li>government-letter</li><li>legal</li><li>junior-legal</li><li>ledger</li><li>tabloid</li><li>credit-card</li></ul><br />\n * Default is \"a4\". If you want to use your own format just pass instead of one of the above predefined formats the size as an number-array, e.g. [595.28, 841.89]\n * @param {boolean} [options.putOnlyUsedFonts=false] Only put fonts into the PDF, which were used.\n * @param {boolean} [options.compress=false] Compress the generated PDF.\n * @param {number} [options.precision=16] Precision of the element-positions.\n * @param {number} [options.userUnit=1.0] Not to be confused with the base unit. Please inform yourself before you use it.\n * @param {string[]} [options.hotfixes] An array of strings to enable hotfixes such as correct pixel scaling.\n * @param {Object} [options.encryption]\n * @param {string} [options.encryption.userPassword] Password for the user bound by the given permissions list.\n * @param {string} [options.encryption.ownerPassword] Both userPassword and ownerPassword should be set for proper authentication.\n * @param {string[]} [options.encryption.userPermissions] Array of permissions \"print\", \"modify\", \"copy\", \"annot-forms\", accessible by the user.\n * @param {number|\"smart\"} [options.floatPrecision=16]\n * @returns {jsPDF} jsPDF-instance\n * @description\n * ```\n * {\n *  orientation: 'p',\n *  unit: 'mm',\n *  format: 'a4',\n *  putOnlyUsedFonts:true,\n *  floatPrecision: 16 // or \"smart\", default is 16\n * }\n * ```\n *\n * @constructor\n */\nfunction jsPDF(options) {\n  var orientation = typeof arguments[0] === \"string\" ? arguments[0] : \"p\";\n  var unit = arguments[1];\n  var format = arguments[2];\n  var compressPdf = arguments[3];\n  var filters = [];\n  var userUnit = 1.0;\n  var precision;\n  var floatPrecision = 16;\n\n  options = options || {};\n\n  if (typeof options === \"object\") {\n    orientation = options.orientation;\n    unit = options.unit || unit;\n    format = options.format || format;\n    compressPdf = options.compress || options.compressPdf || compressPdf;\n    userUnit =\n      typeof options.userUnit === \"number\" ? Math.abs(options.userUnit) : 1.0;\n    if (typeof options.precision !== \"undefined\") {\n      precision = options.precision;\n    }\n    if (typeof options.floatPrecision !== \"undefined\") {\n      floatPrecision = options.floatPrecision;\n    }\n  }\n\n  filters =\n    options.filters || (compressPdf === true ? [\"FlateEncode\"] : filters);\n\n  unit = unit || \"mm\";\n  orientation = (\"\" + (orientation || \"P\")).toLowerCase();\n\n  var API = {\n    internal: {},\n    __private__: {}\n  };\n\n  API.__private__.PubSub = PubSub;\n\n  var pdfVersion = \"1.3\";\n  var getPdfVersion = (API.__private__.getPdfVersion = function() {\n    return pdfVersion;\n  });\n\n  API.__private__.setPdfVersion = function(value) {\n    pdfVersion = value;\n  };\n\n  format = format || \"a4\";\n\n  var ApiMode = {\n    COMPAT: \"compat\",\n    ADVANCED: \"advanced\"\n  };\n  var apiMode = ApiMode.COMPAT;\n\n  /**\n   * @return {boolean} True iff the current API mode is \"advanced\". See {@link advancedAPI}.\n   * @memberof jsPDF#\n   * @name isAdvancedAPI\n   */\n  API.isAdvancedAPI = function() {\n    return apiMode === ApiMode.ADVANCED;\n  };\n\n  var roundToPrecision = (API.roundToPrecision = API.__private__.roundToPrecision = function(\n    number,\n    parmPrecision\n  ) {\n    var tmpPrecision = precision || parmPrecision;\n    if (isNaN(number) || isNaN(tmpPrecision)) {\n      throw new Error(\"Invalid argument passed to jsPDF.roundToPrecision\");\n    }\n    return number.toFixed(tmpPrecision).replace(/0+$/, \"\");\n  });\n\n  // high precision float\n  var hpf = (API.hpf = API.__private__.hpf = function(number) {\n    if (isNaN(number)) {\n      throw new Error(\"Invalid argument passed to jsPDF.hpf\");\n    }\n    return roundToPrecision(number, floatPrecision);\n  });\n\n  var scale = (API.scale = API.__private__.scale = function(number) {\n    if (isNaN(number)) {\n      throw new Error(\"Invalid argument passed to jsPDF.scale\");\n    }\n    if (apiMode === ApiMode.COMPAT) {\n      return number * scaleFactor;\n    } else if (apiMode === ApiMode.ADVANCED) {\n      return number;\n    }\n  });\n\n  var fileId = \"00000000000000000000000000000000\";\n\n  var getFileId = (API.__private__.getFileId = function() {\n    return fileId;\n  });\n\n  var setFileId = (API.__private__.setFileId = function(value) {\n    if (typeof value !== \"undefined\" && /^[a-fA-F0-9]{32}$/.test(value)) {\n      fileId = value.toUpperCase();\n    } else {\n      fileId = fileId\n        .split(\"\")\n        .map(function() {\n          return \"ABCDEF0123456789\".charAt(Math.floor(Math.random() * 16));\n        })\n        .join(\"\");\n    }\n    return fileId;\n  });\n\n  /**\n   * @name setFileId\n   * @memberof jsPDF#\n   * @function\n   * @instance\n   * @param {string} value GUID.\n   * @returns {jsPDF}\n   */\n  API.setFileId = function(value) {\n    setFileId(value);\n    return this;\n  };\n\n  /**\n   * @name getFileId\n   * @memberof jsPDF#\n   * @function\n   * @instance\n   *\n   * @returns {string} GUID.\n   */\n  API.getFileId = function() {\n    return getFileId();\n  };\n\n  var creationDate;\n\n  var convertDateToPDFDate = (API.__private__.convertDateToPDFDate = function(\n    parmDate\n  ) {\n    var result = \"\";\n    var tzoffset = parmDate.getTimezoneOffset(),\n      tzsign = tzoffset < 0 ? \"+\" : \"-\",\n      tzhour = Math.floor(Math.abs(tzoffset / 60)),\n      tzmin = Math.abs(tzoffset % 60),\n      timeZoneString = [tzsign, padd2(tzhour), \"'\", padd2(tzmin), \"'\"].join(\"\");\n\n    result = [\n      \"D:\",\n      parmDate.getFullYear(),\n      padd2(parmDate.getMonth() + 1),\n      padd2(parmDate.getDate()),\n      padd2(parmDate.getHours()),\n      padd2(parmDate.getMinutes()),\n      padd2(parmDate.getSeconds()),\n      timeZoneString\n    ].join(\"\");\n    return result;\n  });\n\n  var convertPDFDateToDate = (API.__private__.convertPDFDateToDate = function(\n    parmPDFDate\n  ) {\n    var year = parseInt(parmPDFDate.substr(2, 4), 10);\n    var month = parseInt(parmPDFDate.substr(6, 2), 10) - 1;\n    var date = parseInt(parmPDFDate.substr(8, 2), 10);\n    var hour = parseInt(parmPDFDate.substr(10, 2), 10);\n    var minutes = parseInt(parmPDFDate.substr(12, 2), 10);\n    var seconds = parseInt(parmPDFDate.substr(14, 2), 10);\n    // var timeZoneHour = parseInt(parmPDFDate.substr(16, 2), 10);\n    // var timeZoneMinutes = parseInt(parmPDFDate.substr(20, 2), 10);\n\n    var resultingDate = new Date(year, month, date, hour, minutes, seconds, 0);\n    return resultingDate;\n  });\n\n  var setCreationDate = (API.__private__.setCreationDate = function(date) {\n    var tmpCreationDateString;\n    var regexPDFCreationDate = /^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\\+0[0-9]|\\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/;\n    if (typeof date === \"undefined\") {\n      date = new Date();\n    }\n\n    if (date instanceof Date) {\n      tmpCreationDateString = convertDateToPDFDate(date);\n    } else if (regexPDFCreationDate.test(date)) {\n      tmpCreationDateString = date;\n    } else {\n      throw new Error(\"Invalid argument passed to jsPDF.setCreationDate\");\n    }\n    creationDate = tmpCreationDateString;\n    return creationDate;\n  });\n\n  var getCreationDate = (API.__private__.getCreationDate = function(type) {\n    var result = creationDate;\n    if (type === \"jsDate\") {\n      result = convertPDFDateToDate(creationDate);\n    }\n    return result;\n  });\n\n  /**\n   * @name setCreationDate\n   * @memberof jsPDF#\n   * @function\n   * @instance\n   * @param {Object} date\n   * @returns {jsPDF}\n   */\n  API.setCreationDate = function(date) {\n    setCreationDate(date);\n    return this;\n  };\n\n  /**\n   * @name getCreationDate\n   * @memberof jsPDF#\n   * @function\n   * @instance\n   * @param {Object} type\n   * @returns {Object}\n   */\n  API.getCreationDate = function(type) {\n    return getCreationDate(type);\n  };\n\n  var padd2 = (API.__private__.padd2 = function(number) {\n    return (\"0\" + parseInt(number)).slice(-2);\n  });\n\n  var objectNumber = 0; // 'n' Current object number\n  var offsets = []; // List of offsets. Activated and reset by buildDocument(). Pupulated by various calls buildDocument makes.\n  var content = [];\n  var contentLength = 0;\n  var additionalObjects = [];\n\n  var pages = [];\n  var currentPage;\n  var hasCustomDestination = false;\n  var outputDestination = content;\n\n  var resetDocument = function() {\n    //reset fields relevant for objectNumber generation and xref.\n    objectNumber = 0;\n    contentLength = 0;\n    content = [];\n    offsets = [];\n    additionalObjects = [];\n\n    rootDictionaryObjId = newObjectDeferred();\n    resourceDictionaryObjId = newObjectDeferred();\n  };\n\n  var setOutputDestination = function(destination) {\n    if (!hasCustomDestination) {\n      outputDestination = destination;\n    }\n  };\n\n  var out = (API.__private__.out = function(string) {\n    string = string.toString();\n    contentLength += string.length + 1;\n    outputDestination.push(string);\n\n    return outputDestination;\n  });\n\n  var write = (API.__private__.write = function(value) {\n    return out(\n      arguments.length === 1\n        ? value.toString()\n        : Array.prototype.join.call(arguments, \" \")\n    );\n  });\n\n  var getArrayBuffer = (API.__private__.getArrayBuffer = function(data) {\n    var len = data.length,\n      ab = new ArrayBuffer(len),\n      u8 = new Uint8Array(ab);\n\n    while (len--) u8[len] = data.charCodeAt(len);\n    return ab;\n  });\n\n  var pageMode; // default: 'UseOutlines';\n\n  API.__private__.getPageMode = function() {\n    return pageMode;\n  };\n\n  var layoutMode; // default: 'continuous';\n\n  API.__private__.getLayoutMode = function() {\n    return layoutMode;\n  };\n\n  var documentProperties = {\n    title: \"\",\n    subject: \"\",\n    author: \"\",\n    keywords: \"\",\n    creator: \"\"\n  };\n\n  var fonts = {}; // collection of font objects, where key is fontKey - a dynamically created label for a given font.\n  var activeFontKey; // will be string representing the KEY of the font as combination of fontName + fontStyle\n  var scaleFactor; // Scale factor\n  var page = 0;\n  var pagesContext = [];\n  var events = new PubSub(API);\n  var hotfixes = options.hotfixes || [];\n\n  var renderTargets = {};\n\n  /**\n   * Multiplies two matrices. (see {@link Matrix})\n   * @param {Matrix} m1\n   * @param {Matrix} m2\n   * @memberof jsPDF#\n   * @name matrixMult\n   */\n  var matrixMult = (API.matrixMult = function(m1, m2) {\n    return m2.multiply(m1);\n  });\n\n  var newObject = (API.__private__.newObject = function() {\n    var oid = newObjectDeferred();\n    newObjectDeferredBegin(oid, true);\n    return oid;\n  });\n\n  // Does not output the object.  The caller must call newObjectDeferredBegin(oid) before outputing any data\n  var newObjectDeferred = (API.__private__.newObjectDeferred = function() {\n    objectNumber++;\n    offsets[objectNumber] = function() {\n      return contentLength;\n    };\n    return objectNumber;\n  });\n\n  var newObjectDeferredBegin = function(oid, doOutput) {\n    doOutput = typeof doOutput === \"boolean\" ? doOutput : false;\n    offsets[oid] = contentLength;\n    if (doOutput) {\n      out(oid + \" 0 obj\");\n    }\n    return oid;\n  };\n  // Does not output the object until after the pages have been output.\n  // Returns an object containing the objectId and content.\n  // All pages have been added so the object ID can be estimated to start right after.\n  // This does not modify the current objectNumber;  It must be updated after the newObjects are output.\n  var newAdditionalObject = (API.__private__.newAdditionalObject = function() {\n    var objId = newObjectDeferred();\n    var obj = {\n      objId: objId,\n      content: \"\"\n    };\n    additionalObjects.push(obj);\n    return obj;\n  });\n\n  var rootDictionaryObjId = newObjectDeferred();\n  var resourceDictionaryObjId = newObjectDeferred();\n\n  var getFilters = (API.__private__.getFilters = function() {\n    return filters;\n  });\n\n  var putStream = (API.__private__.putStream = function(options) {\n    options = options || {};\n    var data = options.data || \"\";\n    var filters = options.filters || getFilters();\n    var alreadyAppliedFilters = options.alreadyAppliedFilters || [];\n    var addLength1 = options.addLength1 || false;\n    var valueOfLength1 = data.length;\n\n    var processedData = {};\n    if (filters === true) {\n      filters = [\"FlateEncode\"];\n    }\n    var keyValues = options.additionalKeyValues || [];\n    if (typeof jsPDF.API.processDataByFilters !== \"undefined\") {\n      processedData = jsPDF.API.processDataByFilters(data, filters);\n    } else {\n      processedData = { data: data, reverseChain: [] };\n    }\n    var filterAsString =\n      processedData.reverseChain +\n      (Array.isArray(alreadyAppliedFilters)\n        ? alreadyAppliedFilters.join(\" \")\n        : alreadyAppliedFilters.toString());\n\n    if (processedData.data.length !== 0) {\n      keyValues.push({\n        key: \"Length\",\n        value: processedData.data.length\n      });\n      if (addLength1 === true) {\n        keyValues.push({\n          key: \"Length1\",\n          value: valueOfLength1\n        });\n      }\n    }\n\n    if (filterAsString.length != 0) {\n      if (filterAsString.split(\"/\").length - 1 === 1) {\n        keyValues.push({\n          key: \"Filter\",\n          value: filterAsString\n        });\n      } else {\n        keyValues.push({\n          key: \"Filter\",\n          value: \"[\" + filterAsString + \"]\"\n        });\n\n        for (var j = 0; j < keyValues.length; j += 1) {\n          if (keyValues[j].key === \"DecodeParms\") {\n            var decodeParmsArray = [];\n\n            for (\n              var i = 0;\n              i < processedData.reverseChain.split(\"/\").length - 1;\n              i += 1\n            ) {\n              decodeParmsArray.push(\"null\");\n            }\n\n            decodeParmsArray.push(keyValues[j].value);\n            keyValues[j].value = \"[\" + decodeParmsArray.join(\" \") + \"]\";\n          }\n        }\n      }\n    }\n\n    out(\"<<\");\n    for (var k = 0; k < keyValues.length; k++) {\n      out(\"/\" + keyValues[k].key + \" \" + keyValues[k].value);\n    }\n    out(\">>\");\n    if (processedData.data.length !== 0) {\n      out(\"stream\");\n      out(processedData.data);\n      out(\"endstream\");\n    }\n  });\n\n  var putPage = (API.__private__.putPage = function(page) {\n    var pageNumber = page.number;\n    var data = page.data;\n    var pageObjectNumber = page.objId;\n    var pageContentsObjId = page.contentsObjId;\n\n    newObjectDeferredBegin(pageObjectNumber, true);\n    out(\"<</Type /Page\");\n    out(\"/Parent \" + page.rootDictionaryObjId + \" 0 R\");\n    out(\"/Resources \" + page.resourceDictionaryObjId + \" 0 R\");\n    out(\n      \"/MediaBox [\" +\n        parseFloat(hpf(page.mediaBox.bottomLeftX)) +\n        \" \" +\n        parseFloat(hpf(page.mediaBox.bottomLeftY)) +\n        \" \" +\n        hpf(page.mediaBox.topRightX) +\n        \" \" +\n        hpf(page.mediaBox.topRightY) +\n        \"]\"\n    );\n    if (page.cropBox !== null) {\n      out(\n        \"/CropBox [\" +\n          hpf(page.cropBox.bottomLeftX) +\n          \" \" +\n          hpf(page.cropBox.bottomLeftY) +\n          \" \" +\n          hpf(page.cropBox.topRightX) +\n          \" \" +\n          hpf(page.cropBox.topRightY) +\n          \"]\"\n      );\n    }\n\n    if (page.bleedBox !== null) {\n      out(\n        \"/BleedBox [\" +\n          hpf(page.bleedBox.bottomLeftX) +\n          \" \" +\n          hpf(page.bleedBox.bottomLeftY) +\n          \" \" +\n          hpf(page.bleedBox.topRightX) +\n          \" \" +\n          hpf(page.bleedBox.topRightY) +\n          \"]\"\n      );\n    }\n\n    if (page.trimBox !== null) {\n      out(\n        \"/TrimBox [\" +\n          hpf(page.trimBox.bottomLeftX) +\n          \" \" +\n          hpf(page.trimBox.bottomLeftY) +\n          \" \" +\n          hpf(page.trimBox.topRightX) +\n          \" \" +\n          hpf(page.trimBox.topRightY) +\n          \"]\"\n      );\n    }\n\n    if (page.artBox !== null) {\n      out(\n        \"/ArtBox [\" +\n          hpf(page.artBox.bottomLeftX) +\n          \" \" +\n          hpf(page.artBox.bottomLeftY) +\n          \" \" +\n          hpf(page.artBox.topRightX) +\n          \" \" +\n          hpf(page.artBox.topRightY) +\n          \"]\"\n      );\n    }\n\n    if (typeof page.userUnit === \"number\" && page.userUnit !== 1.0) {\n      out(\"/UserUnit \" + page.userUnit);\n    }\n\n    events.publish(\"putPage\", {\n      objId: pageObjectNumber,\n      pageContext: pagesContext[pageNumber],\n      pageNumber: pageNumber,\n      page: data\n    });\n    out(\"/Contents \" + pageContentsObjId + \" 0 R\");\n    out(\">>\");\n    out(\"endobj\");\n    // Page content\n    var pageContent = data.join(\"\\n\");\n\n    if (apiMode === ApiMode.ADVANCED) {\n      // if the user forgot to switch back to COMPAT mode, we must balance the graphics stack again\n      pageContent += \"\\nQ\";\n    }\n\n    newObjectDeferredBegin(pageContentsObjId, true);\n    putStream({\n      data: pageContent,\n      filters: getFilters(),\n      objectId: pageContentsObjId\n    });\n    out(\"endobj\");\n    return pageObjectNumber;\n  });\n\n  var putPages = (API.__private__.putPages = function() {\n    var n,\n      i,\n      pageObjectNumbers = [];\n\n    for (n = 1; n <= page; n++) {\n      pagesContext[n].objId = newObjectDeferred();\n      pagesContext[n].contentsObjId = newObjectDeferred();\n    }\n\n    for (n = 1; n <= page; n++) {\n      pageObjectNumbers.push(\n        putPage({\n          number: n,\n          data: pages[n],\n          objId: pagesContext[n].objId,\n          contentsObjId: pagesContext[n].contentsObjId,\n          mediaBox: pagesContext[n].mediaBox,\n          cropBox: pagesContext[n].cropBox,\n          bleedBox: pagesContext[n].bleedBox,\n          trimBox: pagesContext[n].trimBox,\n          artBox: pagesContext[n].artBox,\n          userUnit: pagesContext[n].userUnit,\n          rootDictionaryObjId: rootDictionaryObjId,\n          resourceDictionaryObjId: resourceDictionaryObjId\n        })\n      );\n    }\n    newObjectDeferredBegin(rootDictionaryObjId, true);\n    out(\"<</Type /Pages\");\n    var kids = \"/Kids [\";\n    for (i = 0; i < page; i++) {\n      kids += pageObjectNumbers[i] + \" 0 R \";\n    }\n    out(kids + \"]\");\n    out(\"/Count \" + page);\n    out(\">>\");\n    out(\"endobj\");\n    events.publish(\"postPutPages\");\n  });\n\n  var putXobjectDict = function() {\n    out(\"/XObject <<\");\n    for (var xObjectKey in renderTargets) {\n      if (\n        renderTargets.hasOwnProperty(xObjectKey) &&\n        renderTargets[xObjectKey].objectNumber >= 0\n      ) {\n        out(\n          \"/\" +\n            xObjectKey +\n            \" \" +\n            renderTargets[xObjectKey].objectNumber +\n            \" 0 R\"\n        );\n      }\n    }\n\n    // Loop through images, or other data objects\n    events.publish(\"putXobjectDict\");\n    out(\">>\");\n  };\n\n  var putResourceDictionary = function(objectIds) {\n    newObjectDeferredBegin(objectIds.resourcesOid, true);\n    out(\"<<\");\n    out(\"/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]\");\n    putXobjectDict();\n    out(\">>\");\n    out(\"endobj\");\n  };\n\n  var putResources = function() {\n    // FormObjects, Patterns etc. might use other FormObjects/Patterns/Images\n    // which means their resource dictionaries must contain the already resolved\n    // object ids. For this reason we defer the serialization of the resource\n    // dicts until all objects have been serialized and have object ids.\n    //\n    // In order to prevent cyclic dependencies (which Adobe Reader doesn't like),\n    // we only put all oids that are smaller than the oid of the object the\n    // resource dict belongs to. This is correct behavior, since the streams\n    // may only use other objects that have already been defined and thus appear\n    // earlier in their respective collection.\n    // Currently, this only affects tiling patterns, but a (more) correct\n    // implementation of FormObjects would also define their own resource dicts.\n    var deferredResourceDictionaryIds = [];\n    events.publish(\"putResources\");\n    deferredResourceDictionaryIds.forEach(putResourceDictionary);\n    putResourceDictionary({\n      resourcesOid: resourceDictionaryObjId,\n      objectOid: Number.MAX_SAFE_INTEGER // output all objects\n    });\n    events.publish(\"postPutResources\");\n  };\n\n  var SAFE = function __safeCall(fn) {\n    fn.foo = function __safeCallWrapper() {\n      try {\n        return fn.apply(this, arguments);\n      } catch (e) {\n        var stack = e.stack || \"\";\n        if (~stack.indexOf(\" at \")) stack = stack.split(\" at \")[1];\n        var m =\n          \"Error in function \" +\n          stack.split(\"\\n\")[0].split(\"<\")[0] +\n          \": \" +\n          e.message;\n        if (globalObject.console) {\n          globalObject.console.error(m, e);\n          if (globalObject.alert) alert(m);\n        } else {\n          throw new Error(m);\n        }\n      }\n    };\n    fn.foo.bar = fn;\n    return fn.foo;\n  };\n\n  var to8bitStream = function(text, flags) {\n    /**\n     * PDF 1.3 spec:\n     * \"For text strings encoded in Unicode, the first two bytes must be 254 followed by\n     * 255, representing the Unicode byte order marker, U+FEFF. (This sequence conflicts\n     * with the PDFDocEncoding character sequence thorn ydieresis, which is unlikely\n     * to be a meaningful beginning of a word or phrase.) The remainder of the\n     * string consists of Unicode character codes, according to the UTF-16 encoding\n     * specified in the Unicode standard, version 2.0. Commonly used Unicode values\n     * are represented as 2 bytes per character, with the high-order byte appearing first\n     * in the string.\"\n     *\n     * In other words, if there are chars in a string with char code above 255, we\n     * recode the string to UCS2 BE - string doubles in length and BOM is prepended.\n     *\n     * HOWEVER!\n     * Actual *content* (body) text (as opposed to strings used in document properties etc)\n     * does NOT expect BOM. There, it is treated as a literal GID (Glyph ID)\n     *\n     * Because of Adobe's focus on \"you subset your fonts!\" you are not supposed to have\n     * a font that maps directly Unicode (UCS2 / UTF16BE) code to font GID, but you could\n     * fudge it with \"Identity-H\" encoding and custom CIDtoGID map that mimics Unicode\n     * code page. There, however, all characters in the stream are treated as GIDs,\n     * including BOM, which is the reason we need to skip BOM in content text (i.e. that\n     * that is tied to a font).\n     *\n     * To signal this \"special\" PDFEscape / to8bitStream handling mode,\n     * API.text() function sets (unless you overwrite it with manual values\n     * given to API.text(.., flags) )\n     * flags.autoencode = true\n     * flags.noBOM = true\n     *\n     * ===================================================================================\n     * `flags` properties relied upon:\n     *   .sourceEncoding = string with encoding label.\n     *                     \"Unicode\" by default. = encoding of the incoming text.\n     *                     pass some non-existing encoding name\n     *                     (ex: 'Do not touch my strings! I know what I am doing.')\n     *                     to make encoding code skip the encoding step.\n     *   .outputEncoding = Either valid PDF encoding name\n     *                     (must be supported by jsPDF font metrics, otherwise no encoding)\n     *                     or a JS object, where key = sourceCharCode, value = outputCharCode\n     *                     missing keys will be treated as: sourceCharCode === outputCharCode\n     *   .noBOM\n     *       See comment higher above for explanation for why this is important\n     *   .autoencode\n     *       See comment higher above for explanation for why this is important\n     */\n\n    var i,\n      l,\n      sourceEncoding,\n      encodingBlock,\n      outputEncoding,\n      newtext,\n      isUnicode,\n      ch,\n      bch;\n\n    flags = flags || {};\n    sourceEncoding = flags.sourceEncoding || \"Unicode\";\n    outputEncoding = flags.outputEncoding;\n\n    // This 'encoding' section relies on font metrics format\n    // attached to font objects by, among others,\n    // \"Willow Systems' standard_font_metrics plugin\"\n    // see jspdf.plugin.standard_font_metrics.js for format\n    // of the font.metadata.encoding Object.\n    // It should be something like\n    //   .encoding = {'codePages':['WinANSI....'], 'WinANSI...':{code:code, ...}}\n    //   .widths = {0:width, code:width, ..., 'fof':divisor}\n    //   .kerning = {code:{previous_char_code:shift, ..., 'fof':-divisor},...}\n    if (\n      (flags.autoencode || outputEncoding) &&\n      fonts[activeFontKey].metadata &&\n      fonts[activeFontKey].metadata[sourceEncoding] &&\n      fonts[activeFontKey].metadata[sourceEncoding].encoding\n    ) {\n      encodingBlock = fonts[activeFontKey].metadata[sourceEncoding].encoding;\n\n      // each font has default encoding. Some have it clearly defined.\n      if (!outputEncoding && fonts[activeFontKey].encoding) {\n        outputEncoding = fonts[activeFontKey].encoding;\n      }\n\n      // Hmmm, the above did not work? Let's try again, in different place.\n      if (!outputEncoding && encodingBlock.codePages) {\n        outputEncoding = encodingBlock.codePages[0]; // let's say, first one is the default\n      }\n\n      if (typeof outputEncoding === \"string\") {\n        outputEncoding = encodingBlock[outputEncoding];\n      }\n      // we want output encoding to be a JS Object, where\n      // key = sourceEncoding's character code and\n      // value = outputEncoding's character code.\n      if (outputEncoding) {\n        isUnicode = false;\n        newtext = [];\n        for (i = 0, l = text.length; i < l; i++) {\n          ch = outputEncoding[text.charCodeAt(i)];\n          if (ch) {\n            newtext.push(String.fromCharCode(ch));\n          } else {\n            newtext.push(text[i]);\n          }\n\n          // since we are looping over chars anyway, might as well\n          // check for residual unicodeness\n          if (newtext[i].charCodeAt(0) >> 8) {\n            /* more than 255 */\n            isUnicode = true;\n          }\n        }\n        text = newtext.join(\"\");\n      }\n    }\n\n    i = text.length;\n    // isUnicode may be set to false above. Hence the triple-equal to undefined\n    while (isUnicode === undefined && i !== 0) {\n      if (text.charCodeAt(i - 1) >> 8) {\n        /* more than 255 */\n        isUnicode = true;\n      }\n      i--;\n    }\n    if (!isUnicode) {\n      return text;\n    }\n\n    newtext = flags.noBOM ? [] : [254, 255];\n    for (i = 0, l = text.length; i < l; i++) {\n      ch = text.charCodeAt(i);\n      bch = ch >> 8; // divide by 256\n      if (bch >> 8) {\n        /* something left after dividing by 256 second time */\n        throw new Error(\n          \"Character at position \" +\n            i +\n            \" of string '\" +\n            text +\n            \"' exceeds 16bits. Cannot be encoded into UCS-2 BE\"\n        );\n      }\n      newtext.push(bch);\n      newtext.push(ch - (bch << 8));\n    }\n    return String.fromCharCode.apply(undefined, newtext);\n  };\n\n  var pdfEscape = (API.__private__.pdfEscape = API.pdfEscape = function(\n    text,\n    flags\n  ) {\n    /**\n     * Replace '/', '(', and ')' with pdf-safe versions\n     *\n     * Doing to8bitStream does NOT make this PDF display unicode text. For that\n     * we also need to reference a unicode font and embed it - royal pain in the rear.\n     *\n     * There is still a benefit to to8bitStream - PDF simply cannot handle 16bit chars,\n     * which JavaScript Strings are happy to provide. So, while we still cannot display\n     * 2-byte characters property, at least CONDITIONALLY converting (entire string containing)\n     * 16bit chars to (USC-2-BE) 2-bytes per char + BOM streams we ensure that entire PDF\n     * is still parseable.\n     * This will allow immediate support for unicode in document properties strings.\n     */\n    return to8bitStream(text, flags)\n      .replace(/\\\\/g, \"\\\\\\\\\")\n      .replace(/\\(/g, \"\\\\(\")\n      .replace(/\\)/g, \"\\\\)\");\n  });\n\n  var beginPage = (API.__private__.beginPage = function(format) {\n    pages[++page] = [];\n    pagesContext[page] = {\n      objId: 0,\n      contentsObjId: 0,\n      userUnit: Number(userUnit),\n      artBox: null,\n      bleedBox: null,\n      cropBox: null,\n      trimBox: null,\n      mediaBox: {\n        bottomLeftX: 0,\n        bottomLeftY: 0,\n        topRightX: Number(format[0]),\n        topRightY: Number(format[1])\n      }\n    };\n    _setPage(page);\n    setOutputDestination(pages[currentPage]);\n  });\n\n  var _addPage = function(parmFormat) {\n    var width, height;\n\n    if (Array.isArray(parmFormat)) {\n      width = parmFormat[0] * scaleFactor;\n      height = parmFormat[1] * scaleFactor;\n    }\n\n    if (isNaN(width)) {\n      width = format[0];\n      height = format[1];\n    }\n\n    if (width > 14400 || height > 14400) {\n      console.warn(\n        \"A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400\"\n      );\n      width = Math.min(14400, width);\n      height = Math.min(14400, height);\n    }\n\n    format = [width, height];\n\n    switch (orientation.substr(0, 1)) {\n      case \"l\":\n        if (height > width) {\n          format = [height, width];\n        }\n        break;\n      case \"p\":\n        if (width > height) {\n          format = [height, width];\n        }\n        break;\n    }\n\n    beginPage(format);\n    events.publish(\"addPage\", {\n      pageNumber: page\n    });\n  };\n\n  var _setPage = function(n) {\n    if (n > 0 && n <= page) {\n      currentPage = n;\n    }\n  };\n\n  var getNumberOfPages = (API.__private__.getNumberOfPages = API.getNumberOfPages = function() {\n    return pages.length - 1;\n  });\n\n  var putInfo = (API.__private__.putInfo = function() {\n    out(\"<<\");\n    out(\"/Producer (\" + pdfEscape(\"jsPDF \" + jsPDF.version) + \")\");\n    for (var key in documentProperties) {\n      if (documentProperties.hasOwnProperty(key) && documentProperties[key]) {\n        out(\n          \"/\" +\n            key.substr(0, 1).toUpperCase() +\n            key.substr(1) +\n            \" (\" +\n            pdfEscape(documentProperties[key]) +\n            \")\"\n        );\n      }\n    }\n    out(\"/CreationDate (\" + pdfEscape(creationDate) + \")\");\n    out(\">>\");\n    out(\"endobj\");\n  });\n\n  var putCatalog = (API.__private__.putCatalog = function(options) {\n    options = options || {};\n    var tmpRootDictionaryObjId =\n      options.rootDictionaryObjId || rootDictionaryObjId;\n    newObject();\n    out(\"<<\");\n    out(\"/Type /Catalog\");\n    out(\"/Pages \" + tmpRootDictionaryObjId + \" 0 R\");\n    // PDF13ref Section 7.2.1\n    if (!layoutMode) layoutMode = \"continuous\";\n    switch (layoutMode) {\n      case \"continuous\":\n        out(\"/PageLayout /OneColumn\");\n        break;\n      case \"single\":\n        out(\"/PageLayout /SinglePage\");\n        break;\n      case \"two\":\n      case \"twoleft\":\n        out(\"/PageLayout /TwoColumnLeft\");\n        break;\n      case \"tworight\":\n        out(\"/PageLayout /TwoColumnRight\");\n        break;\n    }\n    if (pageMode) {\n      /**\n       * A name object specifying how the document should be displayed when opened:\n       * UseNone      : Neither document outline nor thumbnail images visible -- DEFAULT\n       * UseOutlines  : Document outline visible\n       * UseThumbs    : Thumbnail images visible\n       * FullScreen   : Full-screen mode, with no menu bar, window controls, or any other window visible\n       */\n      out(\"/PageMode /\" + pageMode);\n    }\n    events.publish(\"putCatalog\");\n    out(\">>\");\n    out(\"endobj\");\n  });\n\n  var putTrailer = (API.__private__.putTrailer = function() {\n    out(\"trailer\");\n    out(\"<<\");\n    out(\"/Size \" + (objectNumber + 1));\n    // Root and Info must be the last and second last objects written respectively\n    out(\"/Root \" + objectNumber + \" 0 R\");\n    out(\"/Info \" + (objectNumber - 1) + \" 0 R\");\n    out(\"/ID [ <\" + fileId + \"> <\" + fileId + \"> ]\");\n    out(\">>\");\n  });\n\n  var putHeader = (API.__private__.putHeader = function() {\n    out(\"%PDF-\" + pdfVersion);\n    out(\"%\\xBA\\xDF\\xAC\\xE0\");\n  });\n\n  var putXRef = (API.__private__.putXRef = function() {\n    var p = \"0000000000\";\n\n    out(\"xref\");\n    out(\"0 \" + (objectNumber + 1));\n    out(\"0000000000 65535 f \");\n    for (var i = 1; i <= objectNumber; i++) {\n      var offset = offsets[i];\n      if (typeof offset === \"function\") {\n        out((p + offsets[i]()).slice(-10) + \" 00000 n \");\n      } else {\n        if (typeof offsets[i] !== \"undefined\") {\n          out((p + offsets[i]).slice(-10) + \" 00000 n \");\n        } else {\n          out(\"0000000000 00000 n \");\n        }\n      }\n    }\n  });\n\n  var buildDocument = (API.__private__.buildDocument = function() {\n    resetDocument();\n    setOutputDestination(content);\n\n    events.publish(\"buildDocument\");\n\n    putHeader();\n    putPages();\n    putResources();\n    putInfo();\n    putCatalog();\n\n    var offsetOfXRef = contentLength;\n    putXRef();\n    putTrailer();\n    out(\"startxref\");\n    out(\"\" + offsetOfXRef);\n    out(\"%%EOF\");\n\n    setOutputDestination(pages[currentPage]);\n\n    return content.join(\"\\n\");\n  });\n\n  /**\n   * Generates the PDF document.\n   *\n   * If `type` argument is undefined, output is raw body of resulting PDF returned as a string.\n   *\n   * @param {string} type A string identifying one of the possible output types.<br/>\n   *                      Possible values are: <br/>\n   *                          'arraybuffer' -> (ArrayBuffer)<br/>\n   *                          'blob' -> (Blob)<br/>\n   *                          'bloburi'/'bloburl' -> (string)<br/>\n   *                          'datauristring'/'dataurlstring' -> (string)<br/>\n   *                          'datauri'/'dataurl' -> (undefined) -> change location to generated datauristring/dataurlstring<br/>\n   *                          'dataurlnewwindow' -> (window | null | undefined) throws error if global isn't a window object(node)<br/>\n   *                          'pdfobjectnewwindow' -> (window | null) throws error if global isn't a window object(node)<br/>\n   *                          'pdfjsnewwindow' -> (wind | null)\n   * @param {Object|string} options An object providing some additional signalling to PDF generator.<br/>\n   *                                Possible options are 'filename'.<br/>\n   *                                A string can be passed instead of {filename:string} and defaults to 'generated.pdf'\n   * @function\n   * @instance\n   * @returns {string|window|ArrayBuffer|Blob|jsPDF|null|undefined}\n   * @memberof jsPDF#\n   * @name output\n   */\n  var output = (API.output = API.__private__.output = SAFE(function output(\n    type,\n    options\n  ) {\n    options = options || {};\n\n    if (typeof options === \"string\") {\n      options = {\n        filename: options\n      };\n    } else {\n      options.filename = options.filename || \"generated.pdf\";\n    }\n\n    switch (type) {\n      case \"arraybuffer\":\n        return getArrayBuffer(buildDocument());\n      case \"datauristring\":\n      case \"dataurlstring\":\n        var dataURI = \"\";\n        var pdfDocument = buildDocument();\n        try {\n          dataURI = btoa(pdfDocument);\n        } catch (e) {\n          dataURI = btoa(unescape(encodeURIComponent(pdfDocument)));\n        }\n        return (\n          \"data:application/pdf;filename=\" +\n          options.filename +\n          \";base64,\" +\n          dataURI\n        );\n      default:\n        return null;\n    }\n  }));\n\n  /**\n   * Used to see if a supplied hotfix was requested when the pdf instance was created.\n   * @param {string} hotfixName - The name of the hotfix to check.\n   * @returns {boolean}\n   */\n  var hasHotfix = function(hotfixName) {\n    return (\n      Array.isArray(hotfixes) === true && hotfixes.indexOf(hotfixName) > -1\n    );\n  };\n\n  switch (unit) {\n    case \"pt\":\n      scaleFactor = 1;\n      break;\n    case \"mm\":\n      scaleFactor = 72 / 25.4;\n      break;\n    case \"cm\":\n      scaleFactor = 72 / 2.54;\n      break;\n    case \"in\":\n      scaleFactor = 72;\n      break;\n    case \"px\":\n      if (hasHotfix(\"px_scaling\") == true) {\n        scaleFactor = 72 / 96;\n      } else {\n        scaleFactor = 96 / 72;\n      }\n      break;\n    case \"pc\":\n      scaleFactor = 12;\n      break;\n    case \"em\":\n      scaleFactor = 12;\n      break;\n    case \"ex\":\n      scaleFactor = 6;\n      break;\n    default:\n      if (typeof unit === \"number\") {\n        scaleFactor = unit;\n      } else {\n        throw new Error(\"Invalid unit: \" + unit);\n      }\n  }\n\n  setCreationDate();\n  setFileId();\n\n  /**\n   * Adds (and transfers the focus to) new page to the PDF document.\n   * @param format {String/Array} The format of the new page. Can be: <ul><li>a0 - a10</li><li>b0 - b10</li><li>c0 - c10</li><li>dl</li><li>letter</li><li>government-letter</li><li>legal</li><li>junior-legal</li><li>ledger</li><li>tabloid</li><li>credit-card</li></ul><br />\n   * Default is \"a4\". If you want to use your own format just pass instead of one of the above predefined formats the size as an number-array, e.g. [595.28, 841.89]\n   * @param orientation {string} Orientation of the new page. Possible values are \"portrait\" or \"landscape\" (or shortcuts \"p\" (Default), \"l\").\n   * @function\n   * @instance\n   * @returns {jsPDF}\n   *\n   * @memberof jsPDF#\n   * @name addPage\n   */\n  API.addPage = function() {\n    _addPage.apply(this, arguments);\n    return this;\n  };\n\n  var isValidStyle = (API.__private__.isValidStyle = function(style) {\n    var validStyleVariants = [\n      undefined,\n      null,\n      \"S\",\n      \"D\",\n      \"F\",\n      \"DF\",\n      \"FD\",\n      \"f\",\n      \"f*\",\n      \"B\",\n      \"B*\",\n      \"n\"\n    ];\n    var result = false;\n    if (validStyleVariants.indexOf(style) !== -1) {\n      result = true;\n    }\n    return result;\n  });\n\n  /**\n   * Close the current path. The PDF \"h\" operator.\n   * @name close\n   * @function\n   * @instance\n   * @returns {jsPDF}\n   * @memberof jsPDF#\n   */\n  var close = (API.close = function() {\n    out(\"h\");\n    return this;\n  });\n\n  var getHorizontalCoordinate = (API.__private__.getHorizontalCoordinate = function(\n    value\n  ) {\n    return scale(value);\n  });\n\n  var getVerticalCoordinate = (API.__private__.getVerticalCoordinate = function(\n    value\n  ) {\n    if (apiMode === ApiMode.ADVANCED) {\n      return value;\n    } else {\n      var pageHeight =\n        pagesContext[currentPage].mediaBox.topRightY -\n        pagesContext[currentPage].mediaBox.bottomLeftY;\n      return pageHeight - scale(value);\n    }\n  });\n\n  var getHorizontalCoordinateString = (API.__private__.getHorizontalCoordinateString = API.getHorizontalCoordinateString = function(\n    value\n  ) {\n    return hpf(getHorizontalCoordinate(value));\n  });\n\n  var getVerticalCoordinateString = (API.__private__.getVerticalCoordinateString = API.getVerticalCoordinateString = function(\n    value\n  ) {\n    return hpf(getVerticalCoordinate(value));\n  });\n\n  // applying plugins (more methods) ON TOP of built-in API.\n  // this is intentional as we allow plugins to override\n  // built-ins\n  for (var plugin in jsPDF.API) {\n    if (jsPDF.API.hasOwnProperty(plugin)) {\n      if (plugin === \"events\" && jsPDF.API.events.length) {\n        (function(events, newEvents) {\n          // jsPDF.API.events is a JS Array of Arrays\n          // where each Array is a pair of event name, handler\n          // Events were added by plugins to the jsPDF instantiator.\n          // These are always added to the new instance and some ran\n          // during instantiation.\n          var eventname, handler_and_args, i;\n\n          for (i = newEvents.length - 1; i !== -1; i--) {\n            // subscribe takes 3 args: 'topic', function, runonce_flag\n            // if undefined, runonce is false.\n            // users can attach callback directly,\n            // or they can attach an array with [callback, runonce_flag]\n            // that's what the \"apply\" magic is for below.\n            eventname = newEvents[i][0];\n            handler_and_args = newEvents[i][1];\n            events.subscribe.apply(\n              events,\n              [eventname].concat(\n                typeof handler_and_args === \"function\"\n                  ? [handler_and_args]\n                  : handler_and_args\n              )\n            );\n          }\n        })(events, jsPDF.API.events);\n      } else {\n        API[plugin] = jsPDF.API[plugin];\n      }\n    }\n  }\n  /**\n   * Object exposing internal API to plugins\n   * @public\n   * @ignore\n   */\n  API.internal = {\n    pdfEscape: pdfEscape,\n    write: write,\n    getHorizontalCoordinate: getHorizontalCoordinate,\n    getVerticalCoordinate: getVerticalCoordinate,\n    getCoordinateString: getHorizontalCoordinateString,\n    getVerticalCoordinateString: getVerticalCoordinateString,\n    collections: {},\n    newObject: newObject,\n    newAdditionalObject: newAdditionalObject,\n    newObjectDeferred: newObjectDeferred,\n    newObjectDeferredBegin: newObjectDeferredBegin,\n    getFilters: getFilters,\n    putStream: putStream,\n    events: events,\n    scaleFactor: scaleFactor,\n    output: output,\n    getNumberOfPages: getNumberOfPages,\n    pages: pages,\n    out: out,\n    getPDFVersion: getPdfVersion,\n    hasHotfix: hasHotfix //Expose the hasHotfix check so plugins can also check them.\n  };\n\n  activeFontKey = \"F1\";\n  _addPage(format, orientation);\n\n  events.publish(\"initialized\");\n  return API;\n}\n\n/**\n * jsPDF.API is a STATIC property of jsPDF class.\n * jsPDF.API is an object you can add methods and properties to.\n * The methods / properties you add will show up in new jsPDF objects.\n *\n * One property is prepopulated. It is the 'events' Object. Plugin authors can add topics,\n * callbacks to this object. These will be reassigned to all new instances of jsPDF.\n *\n * @static\n * @public\n * @memberof jsPDF#\n * @name API\n *\n * @example\n * jsPDF.API.mymethod = function(){\n *   // 'this' will be ref to internal API object. see jsPDF source\n *   // , so you can refer to built-in methods like so:\n *   //     this.line(....)\n *   //     this.text(....)\n * }\n * var pdfdoc = new jsPDF()\n * pdfdoc.mymethod() // <- !!!!!!\n */\njsPDF.API = {\n  events: []\n};\n/**\n * The version of jsPDF.\n * @name version\n * @type {string}\n * @memberof jsPDF#\n */\njsPDF.version = \"0.0.0\";\n\nexport { jsPDF };\nexport default jsPDF;\n","/** @license\n * jsPDF addImage plugin\n * Copyright (c) 2012 Jason Siefken, https://github.com/siefkenj/\n *               2013 Chris Dowling, https://github.com/gingerchris\n *               2013 Trinh Ho, https://github.com/ineedfat\n *               2013 Edwin Alejandro Perez, https://github.com/eaparango\n *               2013 Norah Smith, https://github.com/burnburnrocket\n *               2014 Diego Casorran, https://github.com/diegocr\n *               2014 James Robb, https://github.com/jamesbrobb\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n/**\n * @name addImage\n * @module\n */\n\nimport { jsPDF } from \"../jspdf.js\";\nimport { atob, btoa } from \"../libs/AtobBtoa.js\";\n\n(function(jsPDFAPI) {\n  \"use strict\";\n\n  var namespace = \"addImage_\";\n  jsPDFAPI.__addimage__ = {};\n\n  // Heuristic selection of a good batch for large array .apply. Not limiting make the call overflow.\n  // With too small batch iteration will be slow as more calls are made,\n  // higher values cause larger and slower garbage collection.\n  var ARRAY_APPLY_BATCH = 8192;\n  // Image functionality ported from pdf.js\n  var putImage = function(image) {\n    var out = this.internal.write;\n    var putStream = this.internal.putStream;\n    var getFilters = this.internal.getFilters;\n\n    var filter = getFilters();\n    while (filter.indexOf(\"FlateEncode\") !== -1) {\n      filter.splice(filter.indexOf(\"FlateEncode\"), 1);\n    }\n\n    image.objectId = this.internal.newObject();\n\n    var additionalKeyValues = [];\n    additionalKeyValues.push({ key: \"Type\", value: \"/XObject\" });\n    additionalKeyValues.push({ key: \"Subtype\", value: \"/Image\" });\n    additionalKeyValues.push({ key: \"Width\", value: image.width });\n    additionalKeyValues.push({ key: \"Height\", value: image.height });\n\n    if (image.colorSpace === color_spaces.INDEXED) {\n      additionalKeyValues.push({\n        key: \"ColorSpace\",\n        value:\n          \"[/Indexed /DeviceRGB \" +\n          // if an indexed png defines more than one colour with transparency, we've created a sMask\n          (image.palette.length / 3 - 1) +\n          \" \" +\n          (\"sMask\" in image && typeof image.sMask !== \"undefined\"\n            ? image.objectId + 2\n            : image.objectId + 1) +\n          \" 0 R]\"\n      });\n    } else {\n      additionalKeyValues.push({\n        key: \"ColorSpace\",\n        value: \"/\" + image.colorSpace\n      });\n      if (image.colorSpace === color_spaces.DEVICE_CMYK) {\n        additionalKeyValues.push({ key: \"Decode\", value: \"[1 0 1 0 1 0 1 0]\" });\n      }\n    }\n    additionalKeyValues.push({\n      key: \"BitsPerComponent\",\n      value: image.bitsPerComponent\n    });\n    if (\n      \"decodeParameters\" in image &&\n      typeof image.decodeParameters !== \"undefined\"\n    ) {\n      additionalKeyValues.push({\n        key: \"DecodeParms\",\n        value: \"<<\" + image.decodeParameters + \">>\"\n      });\n    }\n    if (\"transparency\" in image && Array.isArray(image.transparency)) {\n      var transparency = \"\",\n        i = 0,\n        len = image.transparency.length;\n      for (; i < len; i++)\n        transparency +=\n          image.transparency[i] + \" \" + image.transparency[i] + \" \";\n\n      additionalKeyValues.push({\n        key: \"Mask\",\n        value: \"[\" + transparency + \"]\"\n      });\n    }\n    if (typeof image.sMask !== \"undefined\") {\n      additionalKeyValues.push({\n        key: \"SMask\",\n        value: image.objectId + 1 + \" 0 R\"\n      });\n    }\n\n    var alreadyAppliedFilters =\n      typeof image.filter !== \"undefined\" ? [\"/\" + image.filter] : undefined;\n\n    putStream({\n      data: image.data,\n      additionalKeyValues: additionalKeyValues,\n      alreadyAppliedFilters: alreadyAppliedFilters,\n      objectId: image.objectId\n    });\n\n    out(\"endobj\");\n\n    // Soft mask\n    if (\"sMask\" in image && typeof image.sMask !== \"undefined\") {\n      var decodeParameters =\n        \"/Predictor \" +\n        image.predictor +\n        \" /Colors 1 /BitsPerComponent \" +\n        image.bitsPerComponent +\n        \" /Columns \" +\n        image.width;\n      var sMask = {\n        width: image.width,\n        height: image.height,\n        colorSpace: \"DeviceGray\",\n        bitsPerComponent: image.bitsPerComponent,\n        decodeParameters: decodeParameters,\n        data: image.sMask\n      };\n      if (\"filter\" in image) {\n        sMask.filter = image.filter;\n      }\n      putImage.call(this, sMask);\n    }\n\n    //Palette\n    if (image.colorSpace === color_spaces.INDEXED) {\n      var objId = this.internal.newObject();\n      //out('<< /Filter / ' + img['f'] +' /Length ' + img['pal'].length + '>>');\n      //putStream(zlib.compress(img['pal']));\n      putStream({\n        data: arrayBufferToBinaryString(new Uint8Array(image.palette)),\n        objectId: objId\n      });\n      out(\"endobj\");\n    }\n  };\n  var putResourcesCallback = function() {\n    var images = this.internal.collections[namespace + \"images\"];\n    for (var i in images) {\n      putImage.call(this, images[i]);\n    }\n  };\n  var putXObjectsDictCallback = function() {\n    var images = this.internal.collections[namespace + \"images\"],\n      out = this.internal.write,\n      image;\n    for (var i in images) {\n      image = images[i];\n      out(\"/I\" + image.index, image.objectId, \"0\", \"R\");\n    }\n  };\n\n  var checkCompressValue = function(value) {\n    if (value && typeof value === \"string\") value = value.toUpperCase();\n    return value in jsPDFAPI.image_compression ? value : image_compression.NONE;\n  };\n\n  var initialize = function() {\n    if (!this.internal.collections[namespace + \"images\"]) {\n      this.internal.collections[namespace + \"images\"] = {};\n      this.internal.events.subscribe(\"putResources\", putResourcesCallback);\n      this.internal.events.subscribe(\"putXobjectDict\", putXObjectsDictCallback);\n    }\n  };\n\n  var getImages = function() {\n    var images = this.internal.collections[namespace + \"images\"];\n    initialize.call(this);\n    return images;\n  };\n  var getImageIndex = function() {\n    return Object.keys(this.internal.collections[namespace + \"images\"]).length;\n  };\n  var notDefined = function(value) {\n    return typeof value === \"undefined\" || value === null || value.length === 0;\n  };\n  var generateAliasFromImageData = function(imageData) {\n    if (typeof imageData === \"string\" || isArrayBufferView(imageData)) {\n      return sHashCode(imageData);\n    } else if (isArrayBufferView(imageData.data)) {\n      return sHashCode(imageData.data);\n    }\n\n    return null;\n  };\n\n  var isImageTypeSupported = function(type) {\n    return typeof jsPDFAPI[\"process\" + type.toUpperCase()] === \"function\";\n  };\n\n  var checkImagesForAlias = function(alias) {\n    var images = this.internal.collections[namespace + \"images\"];\n    if (images) {\n      for (var e in images) {\n        if (alias === images[e].alias) {\n          return images[e];\n        }\n      }\n    }\n  };\n\n  var determineWidthAndHeight = function(width, height, image) {\n    if (!width && !height) {\n      width = -96;\n      height = -96;\n    }\n    if (width < 0) {\n      width = (-1 * image.width * 72) / width / this.internal.scaleFactor;\n    }\n    if (height < 0) {\n      height = (-1 * image.height * 72) / height / this.internal.scaleFactor;\n    }\n    if (width === 0) {\n      width = (height * image.width) / image.height;\n    }\n    if (height === 0) {\n      height = (width * image.height) / image.width;\n    }\n\n    return [width, height];\n  };\n\n  var writeImageToPDF = function(x, y, width, height, image, rotation) {\n    var dims = determineWidthAndHeight.call(this, width, height, image),\n      coord = this.internal.getCoordinateString,\n      vcoord = this.internal.getVerticalCoordinateString;\n\n    var images = getImages.call(this);\n\n    width = dims[0];\n    height = dims[1];\n    images[image.index] = image;\n\n    if (rotation) {\n      rotation *= Math.PI / 180;\n      var c = Math.cos(rotation);\n      var s = Math.sin(rotation);\n      //like in pdf Reference do it 4 digits instead of 2\n      var f4 = function(number) {\n        return number.toFixed(4);\n      };\n      var rotationTransformationMatrix = [\n        f4(c),\n        f4(s),\n        f4(s * -1),\n        f4(c),\n        0,\n        0,\n        \"cm\"\n      ];\n    }\n    this.internal.write(\"q\"); //Save graphics state\n    if (rotation) {\n      this.internal.write(\n        [1, \"0\", \"0\", 1, coord(x), vcoord(y + height), \"cm\"].join(\" \")\n      ); //Translate\n      this.internal.write(rotationTransformationMatrix.join(\" \")); //Rotate\n      this.internal.write(\n        [coord(width), \"0\", \"0\", coord(height), \"0\", \"0\", \"cm\"].join(\" \")\n      ); //Scale\n    } else {\n      this.internal.write(\n        [\n          coord(width),\n          \"0\",\n          \"0\",\n          coord(height),\n          coord(x),\n          vcoord(y + height),\n          \"cm\"\n        ].join(\" \")\n      ); //Translate and Scale\n    }\n\n    if (this.isAdvancedAPI()) {\n      // draw image bottom up when in \"advanced\" API mode\n      this.internal.write([1, 0, 0, -1, 0, 0, \"cm\"].join(\" \"));\n    }\n\n    this.internal.write(\"/I\" + image.index + \" Do\"); //Paint Image\n    this.internal.write(\"Q\"); //Restore graphics state\n  };\n\n  /**\n   * COLOR SPACES\n   */\n  var color_spaces = (jsPDFAPI.color_spaces = {\n    DEVICE_RGB: \"DeviceRGB\",\n    DEVICE_GRAY: \"DeviceGray\",\n    DEVICE_CMYK: \"DeviceCMYK\",\n    CAL_GREY: \"CalGray\",\n    CAL_RGB: \"CalRGB\",\n    LAB: \"Lab\",\n    ICC_BASED: \"ICCBased\",\n    INDEXED: \"Indexed\",\n    PATTERN: \"Pattern\",\n    SEPARATION: \"Separation\",\n    DEVICE_N: \"DeviceN\"\n  });\n\n  /**\n   * DECODE METHODS\n   */\n  jsPDFAPI.decode = {\n    DCT_DECODE: \"DCTDecode\",\n    FLATE_DECODE: \"FlateDecode\",\n    LZW_DECODE: \"LZWDecode\",\n    JPX_DECODE: \"JPXDecode\",\n    JBIG2_DECODE: \"JBIG2Decode\",\n    ASCII85_DECODE: \"ASCII85Decode\",\n    ASCII_HEX_DECODE: \"ASCIIHexDecode\",\n    RUN_LENGTH_DECODE: \"RunLengthDecode\",\n    CCITT_FAX_DECODE: \"CCITTFaxDecode\"\n  };\n\n  /**\n   * IMAGE COMPRESSION TYPES\n   */\n  var image_compression = (jsPDFAPI.image_compression = {\n    NONE: \"NONE\",\n    FAST: \"FAST\",\n    MEDIUM: \"MEDIUM\",\n    SLOW: \"SLOW\"\n  });\n\n  /**\n   * @name sHashCode\n   * @function\n   * @param {string} data\n   * @returns {string}\n   */\n  var sHashCode = (jsPDFAPI.__addimage__.sHashCode = function(data) {\n    var hash = 0,\n      i,\n      len;\n\n    if (typeof data === \"string\") {\n      len = data.length;\n      for (i = 0; i < len; i++) {\n        hash = (hash << 5) - hash + data.charCodeAt(i);\n        hash |= 0; // Convert to 32bit integer\n      }\n    } else if (isArrayBufferView(data)) {\n      len = data.byteLength / 2;\n      for (i = 0; i < len; i++) {\n        hash = (hash << 5) - hash + data[i];\n        hash |= 0; // Convert to 32bit integer\n      }\n    }\n    return hash;\n  });\n\n  /**\n   * Validates if given String is a valid Base64-String\n   *\n   * @name validateStringAsBase64\n   * @public\n   * @function\n   * @param {String} possible Base64-String\n   *\n   * @returns {boolean}\n   */\n  var validateStringAsBase64 = (jsPDFAPI.__addimage__.validateStringAsBase64 = function(\n    possibleBase64String\n  ) {\n    possibleBase64String = possibleBase64String || \"\";\n    possibleBase64String.toString().trim();\n\n    var result = true;\n\n    if (possibleBase64String.length === 0) {\n      result = false;\n    }\n\n    if (possibleBase64String.length % 4 !== 0) {\n      result = false;\n    }\n\n    if (\n      /^[A-Za-z0-9+/]+$/.test(\n        possibleBase64String.substr(0, possibleBase64String.length - 2)\n      ) === false\n    ) {\n      result = false;\n    }\n\n    if (\n      /^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(\n        possibleBase64String.substr(-2)\n      ) === false\n    ) {\n      result = false;\n    }\n    return result;\n  });\n\n  /**\n   * Strips out and returns info from a valid base64 data URI\n   *\n   * @name extractImageFromDataUrl\n   * @function\n   * @param {string} dataUrl a valid data URI of format 'data:[<MIME-type>][;base64],<data>'\n   * @returns {Array}an Array containing the following\n   * [0] the complete data URI\n   * [1] <MIME-type>\n   * [2] format - the second part of the mime-type i.e 'png' in 'image/png'\n   * [4] <data>\n   */\n  var extractImageFromDataUrl = (jsPDFAPI.__addimage__.extractImageFromDataUrl = function(\n    dataUrl\n  ) {\n    dataUrl = dataUrl || \"\";\n    var dataUrlParts = dataUrl.split(\"base64,\");\n    var result = null;\n\n    if (dataUrlParts.length === 2) {\n      var extractedInfo = /^data:(\\w*\\/\\w*);*(charset=(?!charset=)[\\w=-]*)*;*$/.exec(\n        dataUrlParts[0]\n      );\n      if (Array.isArray(extractedInfo)) {\n        result = {\n          mimeType: extractedInfo[1],\n          charset: extractedInfo[2],\n          data: dataUrlParts[1]\n        };\n      }\n    }\n    return result;\n  });\n\n  /**\n   * Check to see if ArrayBuffer is supported\n   *\n   * @name supportsArrayBuffer\n   * @function\n   * @returns {boolean}\n   */\n  var supportsArrayBuffer = (jsPDFAPI.__addimage__.supportsArrayBuffer = function() {\n    return (\n      typeof ArrayBuffer !== \"undefined\" && typeof Uint8Array !== \"undefined\"\n    );\n  });\n\n  /**\n   * Tests supplied object to determine if ArrayBuffer\n   *\n   * @name isArrayBuffer\n   * @function\n   * @param {Object} object an Object\n   *\n   * @returns {boolean}\n   */\n  jsPDFAPI.__addimage__.isArrayBuffer = function(object) {\n    return supportsArrayBuffer() && object instanceof ArrayBuffer;\n  };\n\n  /**\n   * Tests supplied object to determine if it implements the ArrayBufferView (TypedArray) interface\n   *\n   * @name isArrayBufferView\n   * @function\n   * @param {Object} object an Object\n   * @returns {boolean}\n   */\n  var isArrayBufferView = (jsPDFAPI.__addimage__.isArrayBufferView = function(\n    object\n  ) {\n    return (\n      supportsArrayBuffer() &&\n      typeof Uint32Array !== \"undefined\" &&\n      (object instanceof Int8Array ||\n        object instanceof Uint8Array ||\n        (typeof Uint8ClampedArray !== \"undefined\" &&\n          object instanceof Uint8ClampedArray) ||\n        object instanceof Int16Array ||\n        object instanceof Uint16Array ||\n        object instanceof Int32Array ||\n        object instanceof Uint32Array ||\n        object instanceof Float32Array ||\n        object instanceof Float64Array)\n    );\n  });\n\n  /**\n   * Convert Binary String to ArrayBuffer\n   *\n   * @name binaryStringToUint8Array\n   * @public\n   * @function\n   * @param {string} BinaryString with ImageData\n   * @returns {Uint8Array}\n   */\n  var binaryStringToUint8Array = (jsPDFAPI.__addimage__.binaryStringToUint8Array = function(\n    binary_string\n  ) {\n    var len = binary_string.length;\n    var bytes = new Uint8Array(len);\n    for (var i = 0; i < len; i++) {\n      bytes[i] = binary_string.charCodeAt(i);\n    }\n    return bytes;\n  });\n\n  /**\n   * Convert the Buffer to a Binary String\n   *\n   * @name arrayBufferToBinaryString\n   * @public\n   * @function\n   * @param {ArrayBuffer|ArrayBufferView} ArrayBuffer buffer or bufferView with ImageData\n   *\n   * @returns {String}\n   */\n  var arrayBufferToBinaryString = (jsPDFAPI.__addimage__.arrayBufferToBinaryString = function(\n    buffer\n  ) {\n    var out = \"\";\n    // There are calls with both ArrayBuffer and already converted Uint8Array or other BufferView.\n    // Do not copy the array if input is already an array.\n    var buf = isArrayBufferView(buffer) ? buffer : new Uint8Array(buffer);\n    for (var i = 0; i < buf.length; i += ARRAY_APPLY_BATCH) {\n      // Limit the amount of characters being parsed to prevent overflow.\n      // Note that while TextDecoder would be faster, it does not have the same\n      // functionality as fromCharCode with any provided encodings as of 3/2021.\n      out += String.fromCharCode.apply(\n        null,\n        buf.subarray(i, i + ARRAY_APPLY_BATCH)\n      );\n    }\n    return out;\n  });\n\n  /**\n   * Possible parameter for addImage, an RGBA buffer with size.\n   *\n   * @typedef {Object} RGBAData\n   * @property {Uint8ClampedArray} data - Single dimensional array of RGBA values. For example from canvas getImageData.\n   * @property {number} width - Image width as the data does not carry this information in itself.\n   * @property {number} height - Image height as the data does not carry this information in itself.\n   */\n\n  /**\n   * Adds an Image to the PDF.\n   *\n   * @name addImage\n   * @public\n   * @function\n   * @param {string|HTMLImageElement|HTMLCanvasElement|Uint8Array|RGBAData} imageData imageData as base64 encoded DataUrl or Image-HTMLElement or Canvas-HTMLElement or object containing RGBA array (like output from canvas.getImageData).\n   * @param {string} format format of file if filetype-recognition fails or in case of a Canvas-Element needs to be specified (default for Canvas is JPEG), e.g. 'JPEG', 'PNG', 'WEBP'\n   * @param {number} x x Coordinate (in units declared at inception of PDF document) against left edge of the page\n   * @param {number} y y Coordinate (in units declared at inception of PDF document) against upper edge of the page\n   * @param {number} width width of the image (in units declared at inception of PDF document)\n   * @param {number} height height of the Image (in units declared at inception of PDF document)\n   * @param {string} alias alias of the image (if used multiple times)\n   * @param {string} compression compression of the generated JPEG, can have the values 'NONE', 'FAST', 'MEDIUM' and 'SLOW'\n   * @param {number} rotation rotation of the image in degrees (0-359)\n   *\n   * @returns jsPDF\n   */\n  jsPDFAPI.addImage = function() {\n    var imageData, format, x, y, w, h, alias, compression, rotation;\n\n    imageData = arguments[0];\n    format = arguments[1];\n    x = arguments[2];\n    y = arguments[3];\n    w = arguments[4];\n    h = arguments[5];\n    alias = arguments[6];\n    compression = arguments[7];\n    rotation = arguments[8];\n\n    //If compression is not explicitly set, determine if we should use compression\n    var filter = this.internal.getFilters();\n    if (compression === undefined && filter.indexOf(\"FlateEncode\") !== -1) {\n      compression = \"SLOW\";\n    }\n\n    if (isNaN(x) || isNaN(y)) {\n      throw new Error(\"Invalid coordinates passed to jsPDF.addImage\");\n    }\n\n    initialize.call(this);\n\n    var image = processImageData.call(\n      this,\n      imageData,\n      format,\n      alias,\n      compression\n    );\n\n    writeImageToPDF.call(this, x, y, w, h, image, rotation);\n\n    return this;\n  };\n\n  var processImageData = function(imageData, format, alias, compression) {\n    var result, dataAsBinaryString;\n    imageData = unescape(imageData);\n    var tmpImageData = convertBase64ToBinaryString(imageData, false);\n    imageData = tmpImageData;\n\n    format = \"PNG\";\n    if (!isImageTypeSupported(format)) {\n      throw new Error(\n        \"addImage does not support files of type '\" +\n          format +\n          \"', please ensure that a plugin for '\" +\n          format +\n          \"' support is added.\"\n      );\n    }\n\n    // now do the heavy lifting\n\n    if (notDefined(alias)) {\n      alias = generateAliasFromImageData(imageData);\n    }\n    result = checkImagesForAlias.call(this, alias);\n\n    if (!result) {\n      if (supportsArrayBuffer()) {\n        // no need to convert if imageData is already uint8array\n        if (!(imageData instanceof Uint8Array) && format !== \"RGBA\") {\n          dataAsBinaryString = imageData;\n          imageData = binaryStringToUint8Array(imageData);\n        }\n      }\n\n      result = this[\"process\" + format.toUpperCase()](\n        imageData,\n        getImageIndex.call(this),\n        alias,\n        checkCompressValue(compression),\n        dataAsBinaryString\n      );\n    }\n\n    if (!result) {\n      throw new Error(\"An unknown error occurred whilst processing the image.\");\n    }\n    return result;\n  };\n\n  /**\n   * @name convertBase64ToBinaryString\n   * @function\n   * @param {string} stringData\n   * @returns {string} binary string\n   */\n  var convertBase64ToBinaryString = (jsPDFAPI.__addimage__.convertBase64ToBinaryString = function(\n    stringData,\n    throwError\n  ) {\n    throwError = typeof throwError === \"boolean\" ? throwError : true;\n    var base64Info;\n    var imageData = \"\";\n    var rawData;\n\n    if (typeof stringData === \"string\") {\n      base64Info = extractImageFromDataUrl(stringData);\n      rawData = base64Info !== null ? base64Info.data : stringData;\n\n      try {\n        imageData = atob(rawData);\n      } catch (e) {\n        if (throwError) {\n          if (!validateStringAsBase64(rawData)) {\n            throw new Error(\n              \"Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString \"\n            );\n          } else {\n            throw new Error(\n              \"atob-Error in jsPDF.convertBase64ToBinaryString \" + e.message\n            );\n          }\n        }\n      }\n    }\n    return imageData;\n  });\n\n  /**\n   * @name getImageProperties\n   * @function\n   * @param {Object} imageData\n   * @returns {Object}\n   */\n  jsPDFAPI.getImageProperties = function(imageData) {\n    var image;\n    var tmpImageData = \"\";\n    var format = \"PNG\";\n\n    tmpImageData = convertBase64ToBinaryString(imageData, false);\n    imageData = tmpImageData;\n\n    if (!isImageTypeSupported(format)) {\n      throw new Error(\n        \"addImage does not support files of type '\" +\n          format +\n          \"', please ensure that a plugin for '\" +\n          format +\n          \"' support is added.\"\n      );\n    }\n\n    if (supportsArrayBuffer() && !(imageData instanceof Uint8Array)) {\n      imageData = binaryStringToUint8Array(imageData);\n    }\n\n    image = this[\"process\" + format.toUpperCase()](imageData);\n\n    if (!image) {\n      throw new Error(\"An unknown error occurred whilst processing the image\");\n    }\n\n    image.fileType = format;\n\n    return image;\n  };\n})(jsPDF.API);\n","// Generated by CoffeeScript 1.4.0\n\n/**\n * @license\n * PNG.js\n * Copyright (c) 2011 Devon Govett\n * MIT LICENSE\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this\n * software and associated documentation files (the \"Software\"), to deal in the Software\n * without restriction, including without limitation the rights to use, copy, modify, merge,\n * publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons\n * to whom the Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all copies or\n * substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING\n * BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\nimport { unzlibSync } from \"./fflate.js\";\nimport { globalObject } from \"./globalObject.js\";\n\nvar PNG = (function() {\n  var APNG_BLEND_OP_OVER,\n    APNG_BLEND_OP_SOURCE,\n    APNG_DISPOSE_OP_BACKGROUND,\n    APNG_DISPOSE_OP_NONE,\n    APNG_DISPOSE_OP_PREVIOUS,\n    makeImage,\n    scratchCanvas,\n    scratchCtx;\n\n  APNG_DISPOSE_OP_NONE = 0;\n\n  APNG_DISPOSE_OP_BACKGROUND = 1;\n\n  APNG_DISPOSE_OP_PREVIOUS = 2;\n\n  APNG_BLEND_OP_SOURCE = 0;\n\n  APNG_BLEND_OP_OVER = 1;\n\n  function PNG(data) {\n    var chunkSize,\n      colors,\n      palLen,\n      delayDen,\n      delayNum,\n      frame,\n      i,\n      index,\n      key,\n      section,\n      palShort,\n      text,\n      _i,\n      _j,\n      _ref;\n    this.data = data;\n    this.pos = 8;\n    this.palette = [];\n    this.imgData = [];\n    this.transparency = {};\n    this.animation = null;\n    this.text = {};\n    frame = null;\n    while (true) {\n      chunkSize = this.readUInt32();\n      section = function() {\n        var _i, _results;\n        _results = [];\n        for (i = _i = 0; _i < 4; i = ++_i) {\n          _results.push(String.fromCharCode(this.data[this.pos++]));\n        }\n        return _results;\n      }\n        .call(this)\n        .join(\"\");\n      switch (section) {\n        case \"IHDR\":\n          this.width = this.readUInt32();\n          this.height = this.readUInt32();\n          this.bits = this.data[this.pos++];\n          this.colorType = this.data[this.pos++];\n          this.compressionMethod = this.data[this.pos++];\n          this.filterMethod = this.data[this.pos++];\n          this.interlaceMethod = this.data[this.pos++];\n          break;\n        case \"acTL\":\n          this.animation = {\n            numFrames: this.readUInt32(),\n            numPlays: this.readUInt32() || Infinity,\n            frames: []\n          };\n          break;\n        case \"PLTE\":\n          this.palette = this.read(chunkSize);\n          break;\n        case \"fcTL\":\n          if (frame) {\n            this.animation.frames.push(frame);\n          }\n          this.pos += 4;\n          frame = {\n            width: this.readUInt32(),\n            height: this.readUInt32(),\n            xOffset: this.readUInt32(),\n            yOffset: this.readUInt32()\n          };\n          delayNum = this.readUInt16();\n          delayDen = this.readUInt16() || 100;\n          frame.delay = (1000 * delayNum) / delayDen;\n          frame.disposeOp = this.data[this.pos++];\n          frame.blendOp = this.data[this.pos++];\n          frame.data = [];\n          break;\n        case \"IDAT\":\n        case \"fdAT\":\n          if (section === \"fdAT\") {\n            this.pos += 4;\n            chunkSize -= 4;\n          }\n          data = (frame != null ? frame.data : void 0) || this.imgData;\n          for (\n            i = _i = 0;\n            0 <= chunkSize ? _i < chunkSize : _i > chunkSize;\n            i = 0 <= chunkSize ? ++_i : --_i\n          ) {\n            data.push(this.data[this.pos++]);\n          }\n          break;\n        case \"tRNS\":\n          this.transparency = {};\n          switch (this.colorType) {\n            case 3:\n              palLen = this.palette.length / 3;\n              this.transparency.indexed = this.read(chunkSize);\n              if (this.transparency.indexed.length > palLen)\n                throw new Error(\"More transparent colors than palette size\");\n              /*\n               * According to the PNG spec trns should be increased to the same size as palette if shorter\n               */\n              //palShort = 255 - this.transparency.indexed.length;\n              palShort = palLen - this.transparency.indexed.length;\n              if (palShort > 0) {\n                for (\n                  i = _j = 0;\n                  0 <= palShort ? _j < palShort : _j > palShort;\n                  i = 0 <= palShort ? ++_j : --_j\n                ) {\n                  this.transparency.indexed.push(255);\n                }\n              }\n              break;\n            case 0:\n              this.transparency.grayscale = this.read(chunkSize)[0];\n              break;\n            case 2:\n              this.transparency.rgb = this.read(chunkSize);\n          }\n          break;\n        case \"tEXt\":\n          text = this.read(chunkSize);\n          index = text.indexOf(0);\n          key = String.fromCharCode.apply(String, text.slice(0, index));\n          this.text[key] = String.fromCharCode.apply(\n            String,\n            text.slice(index + 1)\n          );\n          break;\n        case \"IEND\":\n          if (frame) {\n            this.animation.frames.push(frame);\n          }\n          this.colors = function() {\n            switch (this.colorType) {\n              case 0:\n              case 3:\n              case 4:\n                return 1;\n              case 2:\n              case 6:\n                return 3;\n            }\n          }.call(this);\n          this.hasAlphaChannel = (_ref = this.colorType) === 4 || _ref === 6;\n          colors = this.colors + (this.hasAlphaChannel ? 1 : 0);\n          this.pixelBitlength = this.bits * colors;\n          this.colorSpace = function() {\n            switch (this.colors) {\n              case 1:\n                return \"DeviceGray\";\n              case 3:\n                return \"DeviceRGB\";\n            }\n          }.call(this);\n          this.imgData = new Uint8Array(this.imgData);\n          return;\n        default:\n          this.pos += chunkSize;\n      }\n      this.pos += 4;\n      if (this.pos > this.data.length) {\n        throw new Error(\"Incomplete or corrupt PNG file\");\n      }\n    }\n  }\n\n  PNG.prototype.read = function(bytes) {\n    var i, _i, _results;\n    _results = [];\n    for (\n      i = _i = 0;\n      0 <= bytes ? _i < bytes : _i > bytes;\n      i = 0 <= bytes ? ++_i : --_i\n    ) {\n      _results.push(this.data[this.pos++]);\n    }\n    return _results;\n  };\n\n  PNG.prototype.readUInt32 = function() {\n    var b1, b2, b3, b4;\n    b1 = this.data[this.pos++] << 24;\n    b2 = this.data[this.pos++] << 16;\n    b3 = this.data[this.pos++] << 8;\n    b4 = this.data[this.pos++];\n    return b1 | b2 | b3 | b4;\n  };\n\n  PNG.prototype.readUInt16 = function() {\n    var b1, b2;\n    b1 = this.data[this.pos++] << 8;\n    b2 = this.data[this.pos++];\n    return b1 | b2;\n  };\n\n  PNG.prototype.decodePixels = function(data) {\n    var pixelBytes = this.pixelBitlength / 8;\n    var fullPixels = new Uint8Array(this.width * this.height * pixelBytes);\n    var pos = 0;\n    var _this = this;\n\n    if (data == null) {\n      data = this.imgData;\n    }\n    if (data.length === 0) {\n      return new Uint8Array(0);\n    }\n\n    data = unzlibSync(data);\n    function pass(x0, y0, dx, dy) {\n      var abyte,\n        c,\n        col,\n        i,\n        left,\n        length,\n        p,\n        pa,\n        paeth,\n        pb,\n        pc,\n        pixels,\n        row,\n        scanlineLength,\n        upper,\n        upperLeft,\n        _i,\n        _j,\n        _k,\n        _l,\n        _m;\n      var w = Math.ceil((_this.width - x0) / dx),\n        h = Math.ceil((_this.height - y0) / dy);\n      var isFull = _this.width == w && _this.height == h;\n      scanlineLength = pixelBytes * w;\n      pixels = isFull ? fullPixels : new Uint8Array(scanlineLength * h);\n      length = data.length;\n      row = 0;\n      c = 0;\n      while (row < h && pos < length) {\n        switch (data[pos++]) {\n          case 0:\n            for (i = _i = 0; _i < scanlineLength; i = _i += 1) {\n              pixels[c++] = data[pos++];\n            }\n            break;\n          case 1:\n            for (i = _j = 0; _j < scanlineLength; i = _j += 1) {\n              abyte = data[pos++];\n              left = i < pixelBytes ? 0 : pixels[c - pixelBytes];\n              pixels[c++] = (abyte + left) % 256;\n            }\n            break;\n          case 2:\n            for (i = _k = 0; _k < scanlineLength; i = _k += 1) {\n              abyte = data[pos++];\n              col = (i - (i % pixelBytes)) / pixelBytes;\n              upper =\n                row &&\n                pixels[\n                  (row - 1) * scanlineLength +\n                    col * pixelBytes +\n                    (i % pixelBytes)\n                ];\n              pixels[c++] = (upper + abyte) % 256;\n            }\n            break;\n          case 3:\n            for (i = _l = 0; _l < scanlineLength; i = _l += 1) {\n              abyte = data[pos++];\n              col = (i - (i % pixelBytes)) / pixelBytes;\n              left = i < pixelBytes ? 0 : pixels[c - pixelBytes];\n              upper =\n                row &&\n                pixels[\n                  (row - 1) * scanlineLength +\n                    col * pixelBytes +\n                    (i % pixelBytes)\n                ];\n              pixels[c++] = (abyte + Math.floor((left + upper) / 2)) % 256;\n            }\n            break;\n          case 4:\n            for (i = _m = 0; _m < scanlineLength; i = _m += 1) {\n              abyte = data[pos++];\n              col = (i - (i % pixelBytes)) / pixelBytes;\n              left = i < pixelBytes ? 0 : pixels[c - pixelBytes];\n              if (row === 0) {\n                upper = upperLeft = 0;\n              } else {\n                upper =\n                  pixels[\n                    (row - 1) * scanlineLength +\n                      col * pixelBytes +\n                      (i % pixelBytes)\n                  ];\n                upperLeft =\n                  col &&\n                  pixels[\n                    (row - 1) * scanlineLength +\n                      (col - 1) * pixelBytes +\n                      (i % pixelBytes)\n                  ];\n              }\n              p = left + upper - upperLeft;\n              pa = Math.abs(p - left);\n              pb = Math.abs(p - upper);\n              pc = Math.abs(p - upperLeft);\n              if (pa <= pb && pa <= pc) {\n                paeth = left;\n              } else if (pb <= pc) {\n                paeth = upper;\n              } else {\n                paeth = upperLeft;\n              }\n              pixels[c++] = (abyte + paeth) % 256;\n            }\n            break;\n          default:\n            throw new Error(\"Invalid filter algorithm: \" + data[pos - 1]);\n        }\n        if (!isFull) {\n          var fullPos = ((y0 + row * dy) * _this.width + x0) * pixelBytes;\n          var partPos = row * scanlineLength;\n          for (i = 0; i < w; i += 1) {\n            for (var j = 0; j < pixelBytes; j += 1)\n              fullPixels[fullPos++] = pixels[partPos++];\n            fullPos += (dx - 1) * pixelBytes;\n          }\n        }\n        row++;\n      }\n    }\n    if (_this.interlaceMethod == 1) {\n      /*\n          1 6 4 6 2 6 4 6\n          7 7 7 7 7 7 7 7\n          5 6 5 6 5 6 5 6\n          7 7 7 7 7 7 7 7\n          3 6 4 6 3 6 4 6\n          7 7 7 7 7 7 7 7\n          5 6 5 6 5 6 5 6\n          7 7 7 7 7 7 7 7\n        */\n      pass(0, 0, 8, 8); // 1\n      /* NOTE these seem to follow the pattern:\n       * pass(x, 0, 2*x, 2*x);\n       * pass(0, x,   x, 2*x);\n       * with x being 4, 2, 1.\n       */\n      pass(4, 0, 8, 8); // 2\n      pass(0, 4, 4, 8); // 3\n\n      pass(2, 0, 4, 4); // 4\n      pass(0, 2, 2, 4); // 5\n\n      pass(1, 0, 2, 2); // 6\n      pass(0, 1, 1, 2); // 7\n    } else {\n      pass(0, 0, 1, 1);\n    }\n    return fullPixels;\n  };\n\n  PNG.prototype.decodePalette = function() {\n    var c, i, length, palette, pos, ret, transparency, _i, _ref, _ref1;\n    palette = this.palette;\n    transparency = this.transparency.indexed || [];\n    ret = new Uint8Array((transparency.length || 0) + palette.length);\n    pos = 0;\n    length = palette.length;\n    c = 0;\n    for (i = _i = 0, _ref = length; _i < _ref; i = _i += 3) {\n      ret[pos++] = palette[i];\n      ret[pos++] = palette[i + 1];\n      ret[pos++] = palette[i + 2];\n      ret[pos++] = (_ref1 = transparency[c++]) != null ? _ref1 : 255;\n    }\n    return ret;\n  };\n\n  PNG.prototype.copyToImageData = function(imageData, pixels) {\n    var alpha, colors, data, i, input, j, k, length, palette, v, _ref;\n    colors = this.colors;\n    palette = null;\n    alpha = this.hasAlphaChannel;\n    if (this.palette.length) {\n      palette =\n        (_ref = this._decodedPalette) != null\n          ? _ref\n          : (this._decodedPalette = this.decodePalette());\n      colors = 4;\n      alpha = true;\n    }\n    data = imageData.data || imageData;\n    length = data.length;\n    input = palette || pixels;\n    i = j = 0;\n    if (colors === 1) {\n      while (i < length) {\n        k = palette ? pixels[i / 4] * 4 : j;\n        v = input[k++];\n        data[i++] = v;\n        data[i++] = v;\n        data[i++] = v;\n        data[i++] = alpha ? input[k++] : 255;\n        j = k;\n      }\n    } else {\n      while (i < length) {\n        k = palette ? pixels[i / 4] * 4 : j;\n        data[i++] = input[k++];\n        data[i++] = input[k++];\n        data[i++] = input[k++];\n        data[i++] = alpha ? input[k++] : 255;\n        j = k;\n      }\n    }\n  };\n\n  PNG.prototype.decode = function() {\n    var ret;\n    ret = new Uint8Array(this.width * this.height * 4);\n    this.copyToImageData(ret, this.decodePixels());\n    return ret;\n  };\n\n  var hasBrowserCanvas = function() {\n    if (Object.prototype.toString.call(globalObject) === \"[object Window]\") {\n      try {\n        scratchCanvas = globalObject.document.createElement(\"canvas\");\n        scratchCtx = scratchCanvas.getContext(\"2d\");\n      } catch (e) {\n        return false;\n      }\n      return true;\n    }\n    return false;\n  };\n\n  hasBrowserCanvas();\n\n  makeImage = function(imageData) {\n    if (hasBrowserCanvas() === true) {\n      var img;\n      scratchCtx.width = imageData.width;\n      scratchCtx.height = imageData.height;\n      scratchCtx.clearRect(0, 0, imageData.width, imageData.height);\n      scratchCtx.putImageData(imageData, 0, 0);\n      img = new Image();\n      img.src = scratchCanvas.toDataURL();\n      return img;\n    }\n    throw new Error(\"This method requires a Browser with Canvas-capability.\");\n  };\n\n  PNG.prototype.decodeFrames = function(ctx) {\n    var frame, i, imageData, pixels, _i, _len, _ref, _results;\n    if (!this.animation) {\n      return;\n    }\n    _ref = this.animation.frames;\n    _results = [];\n    for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n      frame = _ref[i];\n      imageData = ctx.createImageData(frame.width, frame.height);\n      pixels = this.decodePixels(new Uint8Array(frame.data));\n      this.copyToImageData(imageData, pixels);\n      frame.imageData = imageData;\n      _results.push((frame.image = makeImage(imageData)));\n    }\n    return _results;\n  };\n\n  PNG.prototype.renderFrame = function(ctx, number) {\n    var frame, frames, prev;\n    frames = this.animation.frames;\n    frame = frames[number];\n    prev = frames[number - 1];\n    if (number === 0) {\n      ctx.clearRect(0, 0, this.width, this.height);\n    }\n    if (\n      (prev != null ? prev.disposeOp : void 0) === APNG_DISPOSE_OP_BACKGROUND\n    ) {\n      ctx.clearRect(prev.xOffset, prev.yOffset, prev.width, prev.height);\n    } else if (\n      (prev != null ? prev.disposeOp : void 0) === APNG_DISPOSE_OP_PREVIOUS\n    ) {\n      ctx.putImageData(prev.imageData, prev.xOffset, prev.yOffset);\n    }\n    if (frame.blendOp === APNG_BLEND_OP_SOURCE) {\n      ctx.clearRect(frame.xOffset, frame.yOffset, frame.width, frame.height);\n    }\n    return ctx.drawImage(frame.image, frame.xOffset, frame.yOffset);\n  };\n\n  PNG.prototype.animate = function(ctx) {\n    var doFrame,\n      frameNumber,\n      frames,\n      numFrames,\n      numPlays,\n      _ref,\n      _this = this;\n    frameNumber = 0;\n    (_ref = this.animation),\n      (numFrames = _ref.numFrames),\n      (frames = _ref.frames),\n      (numPlays = _ref.numPlays);\n    return (doFrame = function() {\n      var f, frame;\n      f = frameNumber++ % numFrames;\n      frame = frames[f];\n      _this.renderFrame(ctx, f);\n      if (numFrames > 1 && frameNumber / numFrames < numPlays) {\n        return (_this.animation._timeout = setTimeout(doFrame, frame.delay));\n      }\n    })();\n  };\n\n  PNG.prototype.stopAnimation = function() {\n    var _ref;\n    return clearTimeout(\n      (_ref = this.animation) != null ? _ref._timeout : void 0\n    );\n  };\n\n  PNG.prototype.render = function(canvas) {\n    var ctx, data;\n    if (canvas._png) {\n      canvas._png.stopAnimation();\n    }\n    canvas._png = this;\n    canvas.width = this.width;\n    canvas.height = this.height;\n    ctx = canvas.getContext(\"2d\");\n    if (this.animation) {\n      this.decodeFrames(ctx);\n      return this.animate(ctx);\n    } else {\n      data = ctx.createImageData(this.width, this.height);\n      this.copyToImageData(data, this.decodePixels());\n      return ctx.putImageData(data, 0, 0);\n    }\n  };\n\n  return PNG;\n})();\n\nexport { PNG };\n","/**\n * @license\n *\n * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * ====================================================================\n */\n\nimport { jsPDF } from \"../jspdf.js\";\nimport { PNG } from \"../libs/png.js\";\n\n/**\n * jsPDF PNG PlugIn\n * @name png_support\n * @module\n */\n(function(jsPDFAPI) {\n  \"use strict\";\n\n  /*\n   * @see http://www.w3.org/TR/PNG-Chunks.html\n   *\n   Color    Allowed      Interpretation\n   Type     Bit Depths\n\n     0       1,2,4,8,16  Each pixel is a grayscale sample.\n\n     2       8,16        Each pixel is an R,G,B triple.\n\n     3       1,2,4,8     Each pixel is a palette index;\n                         a PLTE chunk must appear.\n\n     4       8,16        Each pixel is a grayscale sample,\n                         followed by an alpha sample.\n\n     6       8,16        Each pixel is an R,G,B triple,\n                         followed by an alpha sample.\n  */\n\n  /*\n   * PNG filter method types\n   *\n   * @see http://www.w3.org/TR/PNG-Filters.html\n   * @see http://www.libpng.org/pub/png/book/chapter09.html\n   *\n   * This is what the value 'Predictor' in decode params relates to\n   *\n   * 15 is \"optimal prediction\", which means the prediction algorithm can change from line to line.\n   * In that case, you actually have to read the first byte off each line for the prediction algorthim (which should be 0-4, corresponding to PDF 10-14) and select the appropriate unprediction algorithm based on that byte.\n   *\n     0       None\n     1       Sub\n     2       Up\n     3       Average\n     4       Paeth\n   */\n\n  var canCompress = function(value) {\n    return value !== jsPDFAPI.image_compression.NONE && hasCompressionJS();\n  };\n\n  var hasCompressionJS = function() {\n    return typeof zlibSync === \"function\";\n  };\n  var compressBytes = function(bytes, lineLength, colorsPerPixel, compression) {\n    var level = 4;\n    var filter_method = filterUp;\n\n    switch (compression) {\n      case jsPDFAPI.image_compression.FAST:\n        level = 1;\n        filter_method = filterSub;\n        break;\n\n      case jsPDFAPI.image_compression.MEDIUM:\n        level = 6;\n        filter_method = filterAverage;\n        break;\n\n      case jsPDFAPI.image_compression.SLOW:\n        level = 9;\n        filter_method = filterPaeth;\n        break;\n    }\n\n    bytes = applyPngFilterMethod(\n      bytes,\n      lineLength,\n      colorsPerPixel,\n      filter_method\n    );\n    var dat = zlibSync(bytes, { level: level });\n    return jsPDFAPI.__addimage__.arrayBufferToBinaryString(dat);\n  };\n\n  var applyPngFilterMethod = function(\n    bytes,\n    lineLength,\n    colorsPerPixel,\n    filter_method\n  ) {\n    var lines = bytes.length / lineLength,\n      result = new Uint8Array(bytes.length + lines),\n      filter_methods = getFilterMethods(),\n      line,\n      prevLine,\n      offset;\n\n    for (var i = 0; i < lines; i += 1) {\n      offset = i * lineLength;\n      line = bytes.subarray(offset, offset + lineLength);\n\n      if (filter_method) {\n        result.set(filter_method(line, colorsPerPixel, prevLine), offset + i);\n      } else {\n        var len = filter_methods.length,\n          results = [];\n\n        for (var j; j < len; j += 1) {\n          results[j] = filter_methods[j](line, colorsPerPixel, prevLine);\n        }\n\n        var ind = getIndexOfSmallestSum(results.concat());\n\n        result.set(results[ind], offset + i);\n      }\n\n      prevLine = line;\n    }\n\n    return result;\n  };\n\n  var filterNone = function(line) {\n    /*var result = new Uint8Array(line.length + 1);\n    result[0] = 0;\n    result.set(line, 1);*/\n\n    var result = Array.apply([], line);\n    result.unshift(0);\n\n    return result;\n  };\n\n  var filterSub = function(line, colorsPerPixel) {\n    var result = [],\n      len = line.length,\n      left;\n\n    result[0] = 1;\n\n    for (var i = 0; i < len; i += 1) {\n      left = line[i - colorsPerPixel] || 0;\n      result[i + 1] = (line[i] - left + 0x0100) & 0xff;\n    }\n\n    return result;\n  };\n\n  var filterUp = function(line, colorsPerPixel, prevLine) {\n    var result = [],\n      len = line.length,\n      up;\n\n    result[0] = 2;\n\n    for (var i = 0; i < len; i += 1) {\n      up = (prevLine && prevLine[i]) || 0;\n      result[i + 1] = (line[i] - up + 0x0100) & 0xff;\n    }\n\n    return result;\n  };\n\n  var filterAverage = function(line, colorsPerPixel, prevLine) {\n    var result = [],\n      len = line.length,\n      left,\n      up;\n\n    result[0] = 3;\n\n    for (var i = 0; i < len; i += 1) {\n      left = line[i - colorsPerPixel] || 0;\n      up = (prevLine && prevLine[i]) || 0;\n      result[i + 1] = (line[i] + 0x0100 - ((left + up) >>> 1)) & 0xff;\n    }\n\n    return result;\n  };\n\n  var filterPaeth = function(line, colorsPerPixel, prevLine) {\n    var result = [],\n      len = line.length,\n      left,\n      up,\n      upLeft,\n      paeth;\n\n    result[0] = 4;\n\n    for (var i = 0; i < len; i += 1) {\n      left = line[i - colorsPerPixel] || 0;\n      up = (prevLine && prevLine[i]) || 0;\n      upLeft = (prevLine && prevLine[i - colorsPerPixel]) || 0;\n      paeth = paethPredictor(left, up, upLeft);\n      result[i + 1] = (line[i] - paeth + 0x0100) & 0xff;\n    }\n\n    return result;\n  };\n\n  var paethPredictor = function(left, up, upLeft) {\n    if (left === up && up === upLeft) {\n      return left;\n    }\n    var pLeft = Math.abs(up - upLeft),\n      pUp = Math.abs(left - upLeft),\n      pUpLeft = Math.abs(left + up - upLeft - upLeft);\n    return pLeft <= pUp && pLeft <= pUpLeft\n      ? left\n      : pUp <= pUpLeft\n      ? up\n      : upLeft;\n  };\n\n  var getFilterMethods = function() {\n    return [filterNone, filterSub, filterUp, filterAverage, filterPaeth];\n  };\n\n  var getIndexOfSmallestSum = function(arrays) {\n    var sum = arrays.map(function(value) {\n      return value.reduce(function(pv, cv) {\n        return pv + Math.abs(cv);\n      }, 0);\n    });\n    return sum.indexOf(Math.min.apply(null, sum));\n  };\n\n  var getPredictorFromCompression = function(compression) {\n    var predictor;\n    switch (compression) {\n      case jsPDFAPI.image_compression.FAST:\n        predictor = 11;\n        break;\n\n      case jsPDFAPI.image_compression.MEDIUM:\n        predictor = 13;\n        break;\n\n      case jsPDFAPI.image_compression.SLOW:\n        predictor = 14;\n        break;\n\n      default:\n        predictor = 12;\n        break;\n    }\n    return predictor;\n  };\n\n  /**\n   * @name processPNG\n   * @function\n   * @ignore\n   */\n  jsPDFAPI.processPNG = function(imageData, index, alias, compression) {\n    \"use strict\";\n\n    var colorSpace,\n      filter = this.decode.FLATE_DECODE,\n      bitsPerComponent,\n      image,\n      decodeParameters = \"\",\n      trns,\n      colors,\n      pal,\n      smask,\n      pixels,\n      len,\n      alphaData,\n      imgData,\n      hasColors,\n      pixel,\n      i,\n      n;\n\n    if (this.__addimage__.isArrayBuffer(imageData))\n      imageData = new Uint8Array(imageData);\n\n    if (this.__addimage__.isArrayBufferView(imageData)) {\n      image = new PNG(imageData);\n      imageData = image.imgData;\n      bitsPerComponent = image.bits;\n      colorSpace = image.colorSpace;\n      colors = image.colors;\n\n      /*\n       * colorType 6 - Each pixel is an R,G,B triple, followed by an alpha sample.\n       *\n       * colorType 4 - Each pixel is a grayscale sample, followed by an alpha sample.\n       *\n       * Extract alpha to create two separate images, using the alpha as a sMask\n       */\n      if ([4, 6].indexOf(image.colorType) !== -1) {\n        /*\n         * processes 8 bit RGBA and grayscale + alpha images\n         */\n        if (image.bits === 8) {\n          pixels =\n            image.pixelBitlength == 32\n              ? new Uint32Array(image.decodePixels().buffer)\n              : image.pixelBitlength == 16\n              ? new Uint16Array(image.decodePixels().buffer)\n              : new Uint8Array(image.decodePixels().buffer);\n          len = pixels.length;\n          imgData = new Uint8Array(len * image.colors);\n          alphaData = new Uint8Array(len);\n          var pDiff = image.pixelBitlength - image.bits;\n          i = 0;\n          n = 0;\n          var pbl;\n\n          for (; i < len; i++) {\n            pixel = pixels[i];\n            pbl = 0;\n\n            while (pbl < pDiff) {\n              imgData[n++] = (pixel >>> pbl) & 0xff;\n              pbl = pbl + image.bits;\n            }\n\n            alphaData[i] = (pixel >>> pbl) & 0xff;\n          }\n        }\n\n        /*\n         * processes 16 bit RGBA and grayscale + alpha images\n         */\n        if (image.bits === 16) {\n          pixels = new Uint32Array(image.decodePixels().buffer);\n          len = pixels.length;\n          imgData = new Uint8Array(\n            len * (32 / image.pixelBitlength) * image.colors\n          );\n          alphaData = new Uint8Array(len * (32 / image.pixelBitlength));\n          hasColors = image.colors > 1;\n          i = 0;\n          n = 0;\n          var a = 0;\n\n          while (i < len) {\n            pixel = pixels[i++];\n\n            imgData[n++] = (pixel >>> 0) & 0xff;\n\n            if (hasColors) {\n              imgData[n++] = (pixel >>> 16) & 0xff;\n\n              pixel = pixels[i++];\n              imgData[n++] = (pixel >>> 0) & 0xff;\n            }\n\n            alphaData[a++] = (pixel >>> 16) & 0xff;\n          }\n          bitsPerComponent = 8;\n        }\n\n        if (canCompress(compression)) {\n          imageData = compressBytes(\n            imgData,\n            image.width * image.colors,\n            image.colors,\n            compression\n          );\n          smask = compressBytes(alphaData, image.width, 1, compression);\n        } else {\n          imageData = imgData;\n          smask = alphaData;\n          filter = undefined;\n        }\n      }\n\n      /*\n       * Indexed png. Each pixel is a palette index.\n       */\n      if (image.colorType === 3) {\n        colorSpace = this.color_spaces.INDEXED;\n        pal = image.palette;\n\n        if (image.transparency.indexed) {\n          var trans = image.transparency.indexed;\n          var total = 0;\n          i = 0;\n          len = trans.length;\n\n          for (; i < len; ++i) {\n            total += trans[i];\n          }\n\n          total = total / 255;\n\n          /*\n           * a single color is specified as 100% transparent (0),\n           * so we set trns to use a /Mask with that index\n           */\n          if (total === len - 1 && trans.indexOf(0) !== -1) {\n            trns = [trans.indexOf(0)];\n\n            /*\n             * there's more than one colour within the palette that specifies\n             * a transparency value less than 255, so we unroll the pixels to create an image sMask\n             */\n          } else if (total !== len) {\n            pixels = image.decodePixels();\n            alphaData = new Uint8Array(pixels.length);\n            i = 0;\n            len = pixels.length;\n\n            for (; i < len; i++) {\n              alphaData[i] = trans[pixels[i]];\n            }\n\n            smask = compressBytes(alphaData, image.width, 1);\n          }\n        }\n      }\n\n      var predictor = getPredictorFromCompression(compression);\n\n      if (filter === this.decode.FLATE_DECODE) {\n        decodeParameters = \"/Predictor \" + predictor + \" \";\n      }\n      decodeParameters +=\n        \"/Colors \" +\n        colors +\n        \" /BitsPerComponent \" +\n        bitsPerComponent +\n        \" /Columns \" +\n        image.width;\n\n      if (\n        this.__addimage__.isArrayBuffer(imageData) ||\n        this.__addimage__.isArrayBufferView(imageData)\n      ) {\n        imageData = this.__addimage__.arrayBufferToBinaryString(imageData);\n      }\n\n      if (\n        (smask && this.__addimage__.isArrayBuffer(smask)) ||\n        this.__addimage__.isArrayBufferView(smask)\n      ) {\n        smask = this.__addimage__.arrayBufferToBinaryString(smask);\n      }\n\n      return {\n        alias: alias,\n        data: imageData,\n        index: index,\n        filter: filter,\n        decodeParameters: decodeParameters,\n        transparency: trns,\n        palette: pal,\n        sMask: smask,\n        predictor: predictor,\n        width: image.width,\n        height: image.height,\n        bitsPerComponent: bitsPerComponent,\n        colorSpace: colorSpace\n      };\n    }\n  };\n})(jsPDF.API);\n","import { jsPDF } from \"./jspdf.js\";\nimport \"./modules/addimage.js\";\nimport \"./modules/png_support.js\";\n\nexport function png2pdf(config) {\n    var doc = new jsPDF({ format: [config.pageWidth, config.pageHeight] });\n    for (var i = 0, iLen = config.pages.length; i < iLen; i++ ) {\n        var images = config.pages[i];\n        for (var p = 0, pLen = images.length; p < pLen; p++ ) {\n            var image = images[p];\n            doc.addImage(image.dataUrl, \"PNG\", image.x, image.y, image.w, image.h);\n        }\n        if (i < iLen - 1) {\n            doc.addPage();\n        }\n    }\n    return doc.output(\"arraybuffer\");\n}\n"],"names":["atob","btoa","globalObject","window","global","self","this","consoleLog","console","log","apply","arguments","require","warn","str","call","error","PubSub","context","Error","topics","subscribe","topic","callback","once","hasOwnProperty","token","Math","random","toString","unsubscribe","Object","keys","length","publish","args","Array","prototype","slice","tokens","sub","ex","message","push","forEach","getTopics","jsPDF","options","precision","orientation","unit","format","compressPdf","filters","userUnit","floatPrecision","compress","abs","toLowerCase","API","internal","__private__","pdfVersion","getPdfVersion","setPdfVersion","value","ApiMode","COMPAT","ADVANCED","apiMode","isAdvancedAPI","creationDate","roundToPrecision","number","parmPrecision","tmpPrecision","isNaN","toFixed","replace","hpf","scale","scaleFactor","fileId","getFileId","setFileId","test","toUpperCase","split","map","charAt","floor","join","convertDateToPDFDate","parmDate","tzoffset","getTimezoneOffset","tzsign","tzhour","tzmin","timeZoneString","padd2","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","convertPDFDateToDate","parmPDFDate","year","parseInt","substr","month","date","hour","minutes","seconds","Date","setCreationDate","tmpCreationDateString","getCreationDate","type","result","currentPage","pageMode","layoutMode","objectNumber","offsets","content","contentLength","additionalObjects","pages","outputDestination","resetDocument","rootDictionaryObjId","newObjectDeferred","resourceDictionaryObjId","setOutputDestination","destination","out","string","write","getArrayBuffer","data","len","ab","ArrayBuffer","u8","Uint8Array","charCodeAt","getPageMode","getLayoutMode","activeFontKey","documentProperties","title","subject","author","keywords","creator","fonts","page","pagesContext","events","hotfixes","renderTargets","newObject","matrixMult","m1","m2","multiply","oid","newObjectDeferredBegin","doOutput","newAdditionalObject","obj","objId","getFilters","putStream","alreadyAppliedFilters","addLength1","valueOfLength1","processedData","keyValues","additionalKeyValues","filterAsString","processDataByFilters","reverseChain","isArray","key","j","decodeParmsArray","i","k","putPage","pageNumber","pageObjectNumber","pageContentsObjId","contentsObjId","parseFloat","mediaBox","bottomLeftX","bottomLeftY","topRightX","topRightY","cropBox","bleedBox","trimBox","artBox","pageContext","pageContent","objectId","putPages","n","pageObjectNumbers","kids","putXobjectDict","xObjectKey","putResourceDictionary","objectIds","resourcesOid","putResources","objectOid","Number","MAX_SAFE_INTEGER","SAFE","fn","foo","e","stack","indexOf","m","alert","bar","to8bitStream","text","flags","l","sourceEncoding","encodingBlock","outputEncoding","newtext","isUnicode","ch","bch","autoencode","metadata","encoding","codePages","String","fromCharCode","undefined","noBOM","pdfEscape","beginPage","_setPage","_addPage","parmFormat","width","height","min","getNumberOfPages","putInfo","version","putCatalog","tmpRootDictionaryObjId","putTrailer","putHeader","putXRef","p","buildDocument","offsetOfXRef","output","filename","dataURI","pdfDocument","unescape","encodeURIComponent","hasHotfix","hotfixName","addPage","isValidStyle","style","close","getHorizontalCoordinate","getVerticalCoordinate","getHorizontalCoordinateString","getVerticalCoordinateString","plugin","newEvents","eventname","handler_and_args","concat","getCoordinateString","collections","getPDFVersion","jsPDFAPI","__addimage__","putImage","image","filter","splice","colorSpace","color_spaces","INDEXED","palette","sMask","DEVICE_CMYK","bitsPerComponent","decodeParameters","transparency","predictor","arrayBufferToBinaryString","putResourcesCallback","images","putXObjectsDictCallback","index","initialize","getImages","getImageIndex","isImageTypeSupported","checkImagesForAlias","alias","determineWidthAndHeight","writeImageToPDF","x","y","rotation","dims","coord","vcoord","PI","c","cos","s","sin","f4","rotationTransformationMatrix","DEVICE_RGB","DEVICE_GRAY","CAL_GREY","CAL_RGB","LAB","ICC_BASED","PATTERN","SEPARATION","DEVICE_N","decode","DCT_DECODE","FLATE_DECODE","LZW_DECODE","JPX_DECODE","JBIG2_DECODE","ASCII85_DECODE","ASCII_HEX_DECODE","RUN_LENGTH_DECODE","CCITT_FAX_DECODE","image_compression","NONE","FAST","MEDIUM","SLOW","sHashCode","hash","isArrayBufferView","byteLength","validateStringAsBase64","possibleBase64String","trim","extractImageFromDataUrl","dataUrl","dataUrlParts","extractedInfo","exec","mimeType","charset","supportsArrayBuffer","isArrayBuffer","object","Uint32Array","Int8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Float32Array","Float64Array","binaryStringToUint8Array","binary_string","bytes","buffer","buf","subarray","addImage","imageData","w","h","compression","processImageData","dataAsBinaryString","convertBase64ToBinaryString","generateAliasFromImageData","checkCompressValue","stringData","throwError","base64Info","rawData","getImageProperties","fileType","hasCompressionJS","compressBytes","applyPngFilterMethod","filterNone","filterSub","filterUp","filterAverage","filterPaeth","paethPredictor","getFilterMethods","getIndexOfSmallestSum","PNG","makeImage","scratchCanvas","scratchCtx","chunkSize","colors","palLen","delayDen","delayNum","frame","section","palShort","_i","_j","_ref","pos","imgData","animation","readUInt32","_results","bits","colorType","compressionMethod","filterMethod","interlaceMethod","numFrames","numPlays","Infinity","frames","read","xOffset","yOffset","readUInt16","delay","disposeOp","blendOp","indexed","grayscale","rgb","hasAlphaChannel","pixelBitlength","decodePixels","pixelBytes","fullPixels","_this","pass","x0","y0","dx","dy","abyte","col","left","pa","paeth","pb","pc","pixels","row","scanlineLength","upper","upperLeft","_k","_l","_m","ceil","isFull","fullPos","partPos","unzlibSync","decodePalette","ret","_ref1","copyToImageData","alpha","input","v","_decodedPalette","hasBrowserCanvas","document","createElement","getContext","img","clearRect","putImageData","Image","src","toDataURL","decodeFrames","ctx","_len","createImageData","renderFrame","prev","drawImage","animate","doFrame","frameNumber","f","_timeout","setTimeout","stopAnimation","clearTimeout","render","canvas","_png","zlibSync","lineLength","colorsPerPixel","level","filter_method","dat","line","prevLine","offset","lines","filter_methods","set","results","ind","unshift","up","upLeft","pLeft","pUp","pUpLeft","arrays","sum","reduce","pv","cv","processPNG","trns","pal","smask","alphaData","hasColors","pixel","pbl","pDiff","a","trans","total","getPredictorFromCompression","config","doc","pageWidth","pageHeight","iLen","pLen"],"mappings":"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"}