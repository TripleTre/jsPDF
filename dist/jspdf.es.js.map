{"version":3,"file":"jspdf.es.js","sources":["../src/libs/globalObject.js","../src/libs/AtobBtoa.js","../src/libs/console.js","../src/jspdf.js","../src/modules/addimage.js","../src/libs/png.js","../src/modules/png_support.js"],"sourcesContent":["export var globalObject = (function() {\n  return \"undefined\" !== typeof window\n    ? window\n    : \"undefined\" !== typeof global\n    ? global\n    : \"undefined\" !== typeof self\n    ? self\n    : this;\n})();\n","import { globalObject } from \"./globalObject.js\";\n\nvar atob, btoa;\n\n(function() {\n  atob = globalObject.atob.bind(globalObject);\n  btoa = globalObject.btoa.bind(globalObject);\n  return;\n\n})();\n\nexport { atob, btoa };\n","import { globalObject } from \"./globalObject.js\";\n\nfunction consoleLog() {\n  if (globalObject.console && typeof globalObject.console.log === \"function\") {\n    globalObject.console.log.apply(globalObject.console, arguments);\n  }\n}\n\nfunction consoleWarn(str) {\n  if (globalObject.console) {\n    if (typeof globalObject.console.warn === \"function\") {\n      globalObject.console.warn.apply(globalObject.console, arguments);\n    } else {\n      consoleLog.call(null, arguments);\n    }\n  }\n}\n\nfunction consoleError(str) {\n  if (globalObject.console) {\n    if (typeof globalObject.console.error === \"function\") {\n      globalObject.console.error.apply(globalObject.console, arguments);\n    } else {\n      consoleLog(str);\n    }\n  }\n}\nexport var console = {\n  log: consoleLog,\n  warn: consoleWarn,\n  error: consoleError\n};\n","/* eslint-disable no-console */\n\nimport { globalObject } from \"./libs/globalObject.js\";\nimport { btoa } from \"./libs/AtobBtoa.js\";\nimport { console } from \"./libs/console.js\";\n/**\n * jsPDF's Internal PubSub Implementation.\n * Backward compatible rewritten on 2014 by\n * Diego Casorran, https://github.com/diegocr\n *\n * @class\n * @name PubSub\n * @ignore\n */\nfunction PubSub(context) {\n  if (typeof context !== \"object\") {\n    throw new Error(\n      \"Invalid Context passed to initialize PubSub (jsPDF-module)\"\n    );\n  }\n  var topics = {};\n\n  this.subscribe = function(topic, callback, once) {\n    once = once || false;\n    if (\n      typeof topic !== \"string\" ||\n      typeof callback !== \"function\" ||\n      typeof once !== \"boolean\"\n    ) {\n      throw new Error(\n        \"Invalid arguments passed to PubSub.subscribe (jsPDF-module)\"\n      );\n    }\n\n    if (!topics.hasOwnProperty(topic)) {\n      topics[topic] = {};\n    }\n\n    var token = Math.random().toString(35);\n    topics[topic][token] = [callback, !!once];\n\n    return token;\n  };\n\n  this.unsubscribe = function(token) {\n    for (var topic in topics) {\n      if (topics[topic][token]) {\n        delete topics[topic][token];\n        if (Object.keys(topics[topic]).length === 0) {\n          delete topics[topic];\n        }\n        return true;\n      }\n    }\n    return false;\n  };\n\n  this.publish = function(topic) {\n    if (topics.hasOwnProperty(topic)) {\n      var args = Array.prototype.slice.call(arguments, 1),\n        tokens = [];\n\n      for (var token in topics[topic]) {\n        var sub = topics[topic][token];\n        try {\n          sub[0].apply(context, args);\n        } catch (ex) {\n          if (globalObject.console) {\n            console.error(\"jsPDF PubSub Error\", ex.message, ex);\n          }\n        }\n        if (sub[1]) tokens.push(token);\n      }\n      if (tokens.length) tokens.forEach(this.unsubscribe);\n    }\n  };\n\n  this.getTopics = function() {\n    return topics;\n  };\n}\n\n/**\n * Creates new jsPDF document object instance.\n * @name jsPDF\n * @class\n * @param {Object} [options] - Collection of settings initializing the jsPDF-instance\n * @param {string} [options.orientation=portrait] - Orientation of the first page. Possible values are \"portrait\" or \"landscape\" (or shortcuts \"p\" or \"l\").<br />\n * @param {string} [options.unit=mm] Measurement unit (base unit) to be used when coordinates are specified.<br />\n * Possible values are \"pt\" (points), \"mm\", \"cm\", \"in\", \"px\", \"pc\", \"em\" or \"ex\". Note that in order to get the correct scaling for \"px\"\n * units, you need to enable the hotfix \"px_scaling\" by setting options.hotfixes = [\"px_scaling\"].\n * @param {string/Array} [options.format=a4] The format of the first page. Can be:<ul><li>a0 - a10</li><li>b0 - b10</li><li>c0 - c10</li><li>dl</li><li>letter</li><li>government-letter</li><li>legal</li><li>junior-legal</li><li>ledger</li><li>tabloid</li><li>credit-card</li></ul><br />\n * Default is \"a4\". If you want to use your own format just pass instead of one of the above predefined formats the size as an number-array, e.g. [595.28, 841.89]\n * @param {boolean} [options.putOnlyUsedFonts=false] Only put fonts into the PDF, which were used.\n * @param {boolean} [options.compress=false] Compress the generated PDF.\n * @param {number} [options.precision=16] Precision of the element-positions.\n * @param {number} [options.userUnit=1.0] Not to be confused with the base unit. Please inform yourself before you use it.\n * @param {string[]} [options.hotfixes] An array of strings to enable hotfixes such as correct pixel scaling.\n * @param {Object} [options.encryption]\n * @param {string} [options.encryption.userPassword] Password for the user bound by the given permissions list.\n * @param {string} [options.encryption.ownerPassword] Both userPassword and ownerPassword should be set for proper authentication.\n * @param {string[]} [options.encryption.userPermissions] Array of permissions \"print\", \"modify\", \"copy\", \"annot-forms\", accessible by the user.\n * @param {number|\"smart\"} [options.floatPrecision=16]\n * @returns {jsPDF} jsPDF-instance\n * @description\n * ```\n * {\n *  orientation: 'p',\n *  unit: 'mm',\n *  format: 'a4',\n *  putOnlyUsedFonts:true,\n *  floatPrecision: 16 // or \"smart\", default is 16\n * }\n * ```\n *\n * @constructor\n */\nfunction jsPDF(options) {\n  var orientation = typeof arguments[0] === \"string\" ? arguments[0] : \"p\";\n  var unit = arguments[1];\n  var format = arguments[2];\n  var compressPdf = arguments[3];\n  var filters = [];\n  var userUnit = 1.0;\n  var precision;\n  var floatPrecision = 16;\n\n  options = options || {};\n\n  if (typeof options === \"object\") {\n    orientation = options.orientation;\n    unit = options.unit || unit;\n    format = options.format || format;\n    compressPdf = options.compress || options.compressPdf || compressPdf;\n    userUnit =\n      typeof options.userUnit === \"number\" ? Math.abs(options.userUnit) : 1.0;\n    if (typeof options.precision !== \"undefined\") {\n      precision = options.precision;\n    }\n    if (typeof options.floatPrecision !== \"undefined\") {\n      floatPrecision = options.floatPrecision;\n    }\n  }\n\n  filters =\n    options.filters || (compressPdf === true ? [\"FlateEncode\"] : filters);\n\n  unit = unit || \"mm\";\n  orientation = (\"\" + (orientation || \"P\")).toLowerCase();\n\n  var API = {\n    internal: {},\n    __private__: {}\n  };\n\n  API.__private__.PubSub = PubSub;\n\n  var pdfVersion = \"1.3\";\n  var getPdfVersion = (API.__private__.getPdfVersion = function() {\n    return pdfVersion;\n  });\n\n  API.__private__.setPdfVersion = function(value) {\n    pdfVersion = value;\n  };\n\n  format = format || \"a4\";\n\n  var ApiMode = {\n    COMPAT: \"compat\",\n    ADVANCED: \"advanced\"\n  };\n  var apiMode = ApiMode.COMPAT;\n\n  /**\n   * @return {boolean} True iff the current API mode is \"advanced\". See {@link advancedAPI}.\n   * @memberof jsPDF#\n   * @name isAdvancedAPI\n   */\n  API.isAdvancedAPI = function() {\n    return apiMode === ApiMode.ADVANCED;\n  };\n\n  var roundToPrecision = (API.roundToPrecision = API.__private__.roundToPrecision = function(\n    number,\n    parmPrecision\n  ) {\n    var tmpPrecision = precision || parmPrecision;\n    if (isNaN(number) || isNaN(tmpPrecision)) {\n      throw new Error(\"Invalid argument passed to jsPDF.roundToPrecision\");\n    }\n    return number.toFixed(tmpPrecision).replace(/0+$/, \"\");\n  });\n\n  // high precision float\n  var hpf = (API.hpf = API.__private__.hpf = function(number) {\n    if (isNaN(number)) {\n      throw new Error(\"Invalid argument passed to jsPDF.hpf\");\n    }\n    return roundToPrecision(number, floatPrecision);\n  });\n\n  var scale = (API.scale = API.__private__.scale = function(number) {\n    if (isNaN(number)) {\n      throw new Error(\"Invalid argument passed to jsPDF.scale\");\n    }\n    if (apiMode === ApiMode.COMPAT) {\n      return number * scaleFactor;\n    } else if (apiMode === ApiMode.ADVANCED) {\n      return number;\n    }\n  });\n\n  var fileId = \"00000000000000000000000000000000\";\n\n  var getFileId = (API.__private__.getFileId = function() {\n    return fileId;\n  });\n\n  var setFileId = (API.__private__.setFileId = function(value) {\n    if (typeof value !== \"undefined\" && /^[a-fA-F0-9]{32}$/.test(value)) {\n      fileId = value.toUpperCase();\n    } else {\n      fileId = fileId\n        .split(\"\")\n        .map(function() {\n          return \"ABCDEF0123456789\".charAt(Math.floor(Math.random() * 16));\n        })\n        .join(\"\");\n    }\n    return fileId;\n  });\n\n  /**\n   * @name setFileId\n   * @memberof jsPDF#\n   * @function\n   * @instance\n   * @param {string} value GUID.\n   * @returns {jsPDF}\n   */\n  API.setFileId = function(value) {\n    setFileId(value);\n    return this;\n  };\n\n  /**\n   * @name getFileId\n   * @memberof jsPDF#\n   * @function\n   * @instance\n   *\n   * @returns {string} GUID.\n   */\n  API.getFileId = function() {\n    return getFileId();\n  };\n\n  var creationDate;\n\n  var convertDateToPDFDate = (API.__private__.convertDateToPDFDate = function(\n    parmDate\n  ) {\n    var result = \"\";\n    var tzoffset = parmDate.getTimezoneOffset(),\n      tzsign = tzoffset < 0 ? \"+\" : \"-\",\n      tzhour = Math.floor(Math.abs(tzoffset / 60)),\n      tzmin = Math.abs(tzoffset % 60),\n      timeZoneString = [tzsign, padd2(tzhour), \"'\", padd2(tzmin), \"'\"].join(\"\");\n\n    result = [\n      \"D:\",\n      parmDate.getFullYear(),\n      padd2(parmDate.getMonth() + 1),\n      padd2(parmDate.getDate()),\n      padd2(parmDate.getHours()),\n      padd2(parmDate.getMinutes()),\n      padd2(parmDate.getSeconds()),\n      timeZoneString\n    ].join(\"\");\n    return result;\n  });\n\n  var convertPDFDateToDate = (API.__private__.convertPDFDateToDate = function(\n    parmPDFDate\n  ) {\n    var year = parseInt(parmPDFDate.substr(2, 4), 10);\n    var month = parseInt(parmPDFDate.substr(6, 2), 10) - 1;\n    var date = parseInt(parmPDFDate.substr(8, 2), 10);\n    var hour = parseInt(parmPDFDate.substr(10, 2), 10);\n    var minutes = parseInt(parmPDFDate.substr(12, 2), 10);\n    var seconds = parseInt(parmPDFDate.substr(14, 2), 10);\n    // var timeZoneHour = parseInt(parmPDFDate.substr(16, 2), 10);\n    // var timeZoneMinutes = parseInt(parmPDFDate.substr(20, 2), 10);\n\n    var resultingDate = new Date(year, month, date, hour, minutes, seconds, 0);\n    return resultingDate;\n  });\n\n  var setCreationDate = (API.__private__.setCreationDate = function(date) {\n    var tmpCreationDateString;\n    var regexPDFCreationDate = /^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\\+0[0-9]|\\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/;\n    if (typeof date === \"undefined\") {\n      date = new Date();\n    }\n\n    if (date instanceof Date) {\n      tmpCreationDateString = convertDateToPDFDate(date);\n    } else if (regexPDFCreationDate.test(date)) {\n      tmpCreationDateString = date;\n    } else {\n      throw new Error(\"Invalid argument passed to jsPDF.setCreationDate\");\n    }\n    creationDate = tmpCreationDateString;\n    return creationDate;\n  });\n\n  var getCreationDate = (API.__private__.getCreationDate = function(type) {\n    var result = creationDate;\n    if (type === \"jsDate\") {\n      result = convertPDFDateToDate(creationDate);\n    }\n    return result;\n  });\n\n  /**\n   * @name setCreationDate\n   * @memberof jsPDF#\n   * @function\n   * @instance\n   * @param {Object} date\n   * @returns {jsPDF}\n   */\n  API.setCreationDate = function(date) {\n    setCreationDate(date);\n    return this;\n  };\n\n  /**\n   * @name getCreationDate\n   * @memberof jsPDF#\n   * @function\n   * @instance\n   * @param {Object} type\n   * @returns {Object}\n   */\n  API.getCreationDate = function(type) {\n    return getCreationDate(type);\n  };\n\n  var padd2 = (API.__private__.padd2 = function(number) {\n    return (\"0\" + parseInt(number)).slice(-2);\n  });\n\n  var objectNumber = 0; // 'n' Current object number\n  var offsets = []; // List of offsets. Activated and reset by buildDocument(). Pupulated by various calls buildDocument makes.\n  var content = [];\n  var contentLength = 0;\n  var additionalObjects = [];\n\n  var pages = [];\n  var currentPage;\n  var hasCustomDestination = false;\n  var outputDestination = content;\n\n  var resetDocument = function() {\n    //reset fields relevant for objectNumber generation and xref.\n    objectNumber = 0;\n    contentLength = 0;\n    content = [];\n    offsets = [];\n    additionalObjects = [];\n\n    rootDictionaryObjId = newObjectDeferred();\n    resourceDictionaryObjId = newObjectDeferred();\n  };\n\n  var setOutputDestination = function(destination) {\n    if (!hasCustomDestination) {\n      outputDestination = destination;\n    }\n  };\n\n  var out = (API.__private__.out = function(string) {\n    string = string.toString();\n    contentLength += string.length + 1;\n    outputDestination.push(string);\n\n    return outputDestination;\n  });\n\n  var write = (API.__private__.write = function(value) {\n    return out(\n      arguments.length === 1\n        ? value.toString()\n        : Array.prototype.join.call(arguments, \" \")\n    );\n  });\n\n  var getArrayBuffer = (API.__private__.getArrayBuffer = function(data) {\n    var len = data.length,\n      ab = new ArrayBuffer(len),\n      u8 = new Uint8Array(ab);\n\n    while (len--) u8[len] = data.charCodeAt(len);\n    return ab;\n  });\n\n  var pageMode; // default: 'UseOutlines';\n\n  API.__private__.getPageMode = function() {\n    return pageMode;\n  };\n\n  var layoutMode; // default: 'continuous';\n\n  API.__private__.getLayoutMode = function() {\n    return layoutMode;\n  };\n\n  var documentProperties = {\n    title: \"\",\n    subject: \"\",\n    author: \"\",\n    keywords: \"\",\n    creator: \"\"\n  };\n\n  var fonts = {}; // collection of font objects, where key is fontKey - a dynamically created label for a given font.\n  var activeFontKey; // will be string representing the KEY of the font as combination of fontName + fontStyle\n  var scaleFactor; // Scale factor\n  var page = 0;\n  var pagesContext = [];\n  var events = new PubSub(API);\n  var hotfixes = options.hotfixes || [];\n\n  var renderTargets = {};\n\n  /**\n   * Multiplies two matrices. (see {@link Matrix})\n   * @param {Matrix} m1\n   * @param {Matrix} m2\n   * @memberof jsPDF#\n   * @name matrixMult\n   */\n  var matrixMult = (API.matrixMult = function(m1, m2) {\n    return m2.multiply(m1);\n  });\n\n  var newObject = (API.__private__.newObject = function() {\n    var oid = newObjectDeferred();\n    newObjectDeferredBegin(oid, true);\n    return oid;\n  });\n\n  // Does not output the object.  The caller must call newObjectDeferredBegin(oid) before outputing any data\n  var newObjectDeferred = (API.__private__.newObjectDeferred = function() {\n    objectNumber++;\n    offsets[objectNumber] = function() {\n      return contentLength;\n    };\n    return objectNumber;\n  });\n\n  var newObjectDeferredBegin = function(oid, doOutput) {\n    doOutput = typeof doOutput === \"boolean\" ? doOutput : false;\n    offsets[oid] = contentLength;\n    if (doOutput) {\n      out(oid + \" 0 obj\");\n    }\n    return oid;\n  };\n  // Does not output the object until after the pages have been output.\n  // Returns an object containing the objectId and content.\n  // All pages have been added so the object ID can be estimated to start right after.\n  // This does not modify the current objectNumber;  It must be updated after the newObjects are output.\n  var newAdditionalObject = (API.__private__.newAdditionalObject = function() {\n    var objId = newObjectDeferred();\n    var obj = {\n      objId: objId,\n      content: \"\"\n    };\n    additionalObjects.push(obj);\n    return obj;\n  });\n\n  var rootDictionaryObjId = newObjectDeferred();\n  var resourceDictionaryObjId = newObjectDeferred();\n\n  var getFilters = (API.__private__.getFilters = function() {\n    return filters;\n  });\n\n  var putStream = (API.__private__.putStream = function(options) {\n    options = options || {};\n    var data = options.data || \"\";\n    var filters = options.filters || getFilters();\n    var alreadyAppliedFilters = options.alreadyAppliedFilters || [];\n    var addLength1 = options.addLength1 || false;\n    var valueOfLength1 = data.length;\n\n    var processedData = {};\n    if (filters === true) {\n      filters = [\"FlateEncode\"];\n    }\n    var keyValues = options.additionalKeyValues || [];\n    if (typeof jsPDF.API.processDataByFilters !== \"undefined\") {\n      processedData = jsPDF.API.processDataByFilters(data, filters);\n    } else {\n      processedData = { data: data, reverseChain: [] };\n    }\n    var filterAsString =\n      processedData.reverseChain +\n      (Array.isArray(alreadyAppliedFilters)\n        ? alreadyAppliedFilters.join(\" \")\n        : alreadyAppliedFilters.toString());\n\n    if (processedData.data.length !== 0) {\n      keyValues.push({\n        key: \"Length\",\n        value: processedData.data.length\n      });\n      if (addLength1 === true) {\n        keyValues.push({\n          key: \"Length1\",\n          value: valueOfLength1\n        });\n      }\n    }\n\n    if (filterAsString.length != 0) {\n      if (filterAsString.split(\"/\").length - 1 === 1) {\n        keyValues.push({\n          key: \"Filter\",\n          value: filterAsString\n        });\n      } else {\n        keyValues.push({\n          key: \"Filter\",\n          value: \"[\" + filterAsString + \"]\"\n        });\n\n        for (var j = 0; j < keyValues.length; j += 1) {\n          if (keyValues[j].key === \"DecodeParms\") {\n            var decodeParmsArray = [];\n\n            for (\n              var i = 0;\n              i < processedData.reverseChain.split(\"/\").length - 1;\n              i += 1\n            ) {\n              decodeParmsArray.push(\"null\");\n            }\n\n            decodeParmsArray.push(keyValues[j].value);\n            keyValues[j].value = \"[\" + decodeParmsArray.join(\" \") + \"]\";\n          }\n        }\n      }\n    }\n\n    out(\"<<\");\n    for (var k = 0; k < keyValues.length; k++) {\n      out(\"/\" + keyValues[k].key + \" \" + keyValues[k].value);\n    }\n    out(\">>\");\n    if (processedData.data.length !== 0) {\n      out(\"stream\");\n      out(processedData.data);\n      out(\"endstream\");\n    }\n  });\n\n  var putPage = (API.__private__.putPage = function(page) {\n    var pageNumber = page.number;\n    var data = page.data;\n    var pageObjectNumber = page.objId;\n    var pageContentsObjId = page.contentsObjId;\n\n    newObjectDeferredBegin(pageObjectNumber, true);\n    out(\"<</Type /Page\");\n    out(\"/Parent \" + page.rootDictionaryObjId + \" 0 R\");\n    out(\"/Resources \" + page.resourceDictionaryObjId + \" 0 R\");\n    out(\n      \"/MediaBox [\" +\n        parseFloat(hpf(page.mediaBox.bottomLeftX)) +\n        \" \" +\n        parseFloat(hpf(page.mediaBox.bottomLeftY)) +\n        \" \" +\n        hpf(page.mediaBox.topRightX) +\n        \" \" +\n        hpf(page.mediaBox.topRightY) +\n        \"]\"\n    );\n    if (page.cropBox !== null) {\n      out(\n        \"/CropBox [\" +\n          hpf(page.cropBox.bottomLeftX) +\n          \" \" +\n          hpf(page.cropBox.bottomLeftY) +\n          \" \" +\n          hpf(page.cropBox.topRightX) +\n          \" \" +\n          hpf(page.cropBox.topRightY) +\n          \"]\"\n      );\n    }\n\n    if (page.bleedBox !== null) {\n      out(\n        \"/BleedBox [\" +\n          hpf(page.bleedBox.bottomLeftX) +\n          \" \" +\n          hpf(page.bleedBox.bottomLeftY) +\n          \" \" +\n          hpf(page.bleedBox.topRightX) +\n          \" \" +\n          hpf(page.bleedBox.topRightY) +\n          \"]\"\n      );\n    }\n\n    if (page.trimBox !== null) {\n      out(\n        \"/TrimBox [\" +\n          hpf(page.trimBox.bottomLeftX) +\n          \" \" +\n          hpf(page.trimBox.bottomLeftY) +\n          \" \" +\n          hpf(page.trimBox.topRightX) +\n          \" \" +\n          hpf(page.trimBox.topRightY) +\n          \"]\"\n      );\n    }\n\n    if (page.artBox !== null) {\n      out(\n        \"/ArtBox [\" +\n          hpf(page.artBox.bottomLeftX) +\n          \" \" +\n          hpf(page.artBox.bottomLeftY) +\n          \" \" +\n          hpf(page.artBox.topRightX) +\n          \" \" +\n          hpf(page.artBox.topRightY) +\n          \"]\"\n      );\n    }\n\n    if (typeof page.userUnit === \"number\" && page.userUnit !== 1.0) {\n      out(\"/UserUnit \" + page.userUnit);\n    }\n\n    events.publish(\"putPage\", {\n      objId: pageObjectNumber,\n      pageContext: pagesContext[pageNumber],\n      pageNumber: pageNumber,\n      page: data\n    });\n    out(\"/Contents \" + pageContentsObjId + \" 0 R\");\n    out(\">>\");\n    out(\"endobj\");\n    // Page content\n    var pageContent = data.join(\"\\n\");\n\n    if (apiMode === ApiMode.ADVANCED) {\n      // if the user forgot to switch back to COMPAT mode, we must balance the graphics stack again\n      pageContent += \"\\nQ\";\n    }\n\n    newObjectDeferredBegin(pageContentsObjId, true);\n    putStream({\n      data: pageContent,\n      filters: getFilters(),\n      objectId: pageContentsObjId\n    });\n    out(\"endobj\");\n    return pageObjectNumber;\n  });\n\n  var putPages = (API.__private__.putPages = function() {\n    var n,\n      i,\n      pageObjectNumbers = [];\n\n    for (n = 1; n <= page; n++) {\n      pagesContext[n].objId = newObjectDeferred();\n      pagesContext[n].contentsObjId = newObjectDeferred();\n    }\n\n    for (n = 1; n <= page; n++) {\n      pageObjectNumbers.push(\n        putPage({\n          number: n,\n          data: pages[n],\n          objId: pagesContext[n].objId,\n          contentsObjId: pagesContext[n].contentsObjId,\n          mediaBox: pagesContext[n].mediaBox,\n          cropBox: pagesContext[n].cropBox,\n          bleedBox: pagesContext[n].bleedBox,\n          trimBox: pagesContext[n].trimBox,\n          artBox: pagesContext[n].artBox,\n          userUnit: pagesContext[n].userUnit,\n          rootDictionaryObjId: rootDictionaryObjId,\n          resourceDictionaryObjId: resourceDictionaryObjId\n        })\n      );\n    }\n    newObjectDeferredBegin(rootDictionaryObjId, true);\n    out(\"<</Type /Pages\");\n    var kids = \"/Kids [\";\n    for (i = 0; i < page; i++) {\n      kids += pageObjectNumbers[i] + \" 0 R \";\n    }\n    out(kids + \"]\");\n    out(\"/Count \" + page);\n    out(\">>\");\n    out(\"endobj\");\n    events.publish(\"postPutPages\");\n  });\n\n  var putXobjectDict = function() {\n    out(\"/XObject <<\");\n    for (var xObjectKey in renderTargets) {\n      if (\n        renderTargets.hasOwnProperty(xObjectKey) &&\n        renderTargets[xObjectKey].objectNumber >= 0\n      ) {\n        out(\n          \"/\" +\n            xObjectKey +\n            \" \" +\n            renderTargets[xObjectKey].objectNumber +\n            \" 0 R\"\n        );\n      }\n    }\n\n    // Loop through images, or other data objects\n    events.publish(\"putXobjectDict\");\n    out(\">>\");\n  };\n\n  var putResourceDictionary = function(objectIds) {\n    newObjectDeferredBegin(objectIds.resourcesOid, true);\n    out(\"<<\");\n    out(\"/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]\");\n    putXobjectDict();\n    out(\">>\");\n    out(\"endobj\");\n  };\n\n  var putResources = function() {\n    // FormObjects, Patterns etc. might use other FormObjects/Patterns/Images\n    // which means their resource dictionaries must contain the already resolved\n    // object ids. For this reason we defer the serialization of the resource\n    // dicts until all objects have been serialized and have object ids.\n    //\n    // In order to prevent cyclic dependencies (which Adobe Reader doesn't like),\n    // we only put all oids that are smaller than the oid of the object the\n    // resource dict belongs to. This is correct behavior, since the streams\n    // may only use other objects that have already been defined and thus appear\n    // earlier in their respective collection.\n    // Currently, this only affects tiling patterns, but a (more) correct\n    // implementation of FormObjects would also define their own resource dicts.\n    var deferredResourceDictionaryIds = [];\n    events.publish(\"putResources\");\n    deferredResourceDictionaryIds.forEach(putResourceDictionary);\n    putResourceDictionary({\n      resourcesOid: resourceDictionaryObjId,\n      objectOid: Number.MAX_SAFE_INTEGER // output all objects\n    });\n    events.publish(\"postPutResources\");\n  };\n\n  var SAFE = function __safeCall(fn) {\n    fn.foo = function __safeCallWrapper() {\n      try {\n        return fn.apply(this, arguments);\n      } catch (e) {\n        var stack = e.stack || \"\";\n        if (~stack.indexOf(\" at \")) stack = stack.split(\" at \")[1];\n        var m =\n          \"Error in function \" +\n          stack.split(\"\\n\")[0].split(\"<\")[0] +\n          \": \" +\n          e.message;\n        if (globalObject.console) {\n          globalObject.console.error(m, e);\n          if (globalObject.alert) alert(m);\n        } else {\n          throw new Error(m);\n        }\n      }\n    };\n    fn.foo.bar = fn;\n    return fn.foo;\n  };\n\n  var to8bitStream = function(text, flags) {\n    /**\n     * PDF 1.3 spec:\n     * \"For text strings encoded in Unicode, the first two bytes must be 254 followed by\n     * 255, representing the Unicode byte order marker, U+FEFF. (This sequence conflicts\n     * with the PDFDocEncoding character sequence thorn ydieresis, which is unlikely\n     * to be a meaningful beginning of a word or phrase.) The remainder of the\n     * string consists of Unicode character codes, according to the UTF-16 encoding\n     * specified in the Unicode standard, version 2.0. Commonly used Unicode values\n     * are represented as 2 bytes per character, with the high-order byte appearing first\n     * in the string.\"\n     *\n     * In other words, if there are chars in a string with char code above 255, we\n     * recode the string to UCS2 BE - string doubles in length and BOM is prepended.\n     *\n     * HOWEVER!\n     * Actual *content* (body) text (as opposed to strings used in document properties etc)\n     * does NOT expect BOM. There, it is treated as a literal GID (Glyph ID)\n     *\n     * Because of Adobe's focus on \"you subset your fonts!\" you are not supposed to have\n     * a font that maps directly Unicode (UCS2 / UTF16BE) code to font GID, but you could\n     * fudge it with \"Identity-H\" encoding and custom CIDtoGID map that mimics Unicode\n     * code page. There, however, all characters in the stream are treated as GIDs,\n     * including BOM, which is the reason we need to skip BOM in content text (i.e. that\n     * that is tied to a font).\n     *\n     * To signal this \"special\" PDFEscape / to8bitStream handling mode,\n     * API.text() function sets (unless you overwrite it with manual values\n     * given to API.text(.., flags) )\n     * flags.autoencode = true\n     * flags.noBOM = true\n     *\n     * ===================================================================================\n     * `flags` properties relied upon:\n     *   .sourceEncoding = string with encoding label.\n     *                     \"Unicode\" by default. = encoding of the incoming text.\n     *                     pass some non-existing encoding name\n     *                     (ex: 'Do not touch my strings! I know what I am doing.')\n     *                     to make encoding code skip the encoding step.\n     *   .outputEncoding = Either valid PDF encoding name\n     *                     (must be supported by jsPDF font metrics, otherwise no encoding)\n     *                     or a JS object, where key = sourceCharCode, value = outputCharCode\n     *                     missing keys will be treated as: sourceCharCode === outputCharCode\n     *   .noBOM\n     *       See comment higher above for explanation for why this is important\n     *   .autoencode\n     *       See comment higher above for explanation for why this is important\n     */\n\n    var i,\n      l,\n      sourceEncoding,\n      encodingBlock,\n      outputEncoding,\n      newtext,\n      isUnicode,\n      ch,\n      bch;\n\n    flags = flags || {};\n    sourceEncoding = flags.sourceEncoding || \"Unicode\";\n    outputEncoding = flags.outputEncoding;\n\n    // This 'encoding' section relies on font metrics format\n    // attached to font objects by, among others,\n    // \"Willow Systems' standard_font_metrics plugin\"\n    // see jspdf.plugin.standard_font_metrics.js for format\n    // of the font.metadata.encoding Object.\n    // It should be something like\n    //   .encoding = {'codePages':['WinANSI....'], 'WinANSI...':{code:code, ...}}\n    //   .widths = {0:width, code:width, ..., 'fof':divisor}\n    //   .kerning = {code:{previous_char_code:shift, ..., 'fof':-divisor},...}\n    if (\n      (flags.autoencode || outputEncoding) &&\n      fonts[activeFontKey].metadata &&\n      fonts[activeFontKey].metadata[sourceEncoding] &&\n      fonts[activeFontKey].metadata[sourceEncoding].encoding\n    ) {\n      encodingBlock = fonts[activeFontKey].metadata[sourceEncoding].encoding;\n\n      // each font has default encoding. Some have it clearly defined.\n      if (!outputEncoding && fonts[activeFontKey].encoding) {\n        outputEncoding = fonts[activeFontKey].encoding;\n      }\n\n      // Hmmm, the above did not work? Let's try again, in different place.\n      if (!outputEncoding && encodingBlock.codePages) {\n        outputEncoding = encodingBlock.codePages[0]; // let's say, first one is the default\n      }\n\n      if (typeof outputEncoding === \"string\") {\n        outputEncoding = encodingBlock[outputEncoding];\n      }\n      // we want output encoding to be a JS Object, where\n      // key = sourceEncoding's character code and\n      // value = outputEncoding's character code.\n      if (outputEncoding) {\n        isUnicode = false;\n        newtext = [];\n        for (i = 0, l = text.length; i < l; i++) {\n          ch = outputEncoding[text.charCodeAt(i)];\n          if (ch) {\n            newtext.push(String.fromCharCode(ch));\n          } else {\n            newtext.push(text[i]);\n          }\n\n          // since we are looping over chars anyway, might as well\n          // check for residual unicodeness\n          if (newtext[i].charCodeAt(0) >> 8) {\n            /* more than 255 */\n            isUnicode = true;\n          }\n        }\n        text = newtext.join(\"\");\n      }\n    }\n\n    i = text.length;\n    // isUnicode may be set to false above. Hence the triple-equal to undefined\n    while (isUnicode === undefined && i !== 0) {\n      if (text.charCodeAt(i - 1) >> 8) {\n        /* more than 255 */\n        isUnicode = true;\n      }\n      i--;\n    }\n    if (!isUnicode) {\n      return text;\n    }\n\n    newtext = flags.noBOM ? [] : [254, 255];\n    for (i = 0, l = text.length; i < l; i++) {\n      ch = text.charCodeAt(i);\n      bch = ch >> 8; // divide by 256\n      if (bch >> 8) {\n        /* something left after dividing by 256 second time */\n        throw new Error(\n          \"Character at position \" +\n            i +\n            \" of string '\" +\n            text +\n            \"' exceeds 16bits. Cannot be encoded into UCS-2 BE\"\n        );\n      }\n      newtext.push(bch);\n      newtext.push(ch - (bch << 8));\n    }\n    return String.fromCharCode.apply(undefined, newtext);\n  };\n\n  var pdfEscape = (API.__private__.pdfEscape = API.pdfEscape = function(\n    text,\n    flags\n  ) {\n    /**\n     * Replace '/', '(', and ')' with pdf-safe versions\n     *\n     * Doing to8bitStream does NOT make this PDF display unicode text. For that\n     * we also need to reference a unicode font and embed it - royal pain in the rear.\n     *\n     * There is still a benefit to to8bitStream - PDF simply cannot handle 16bit chars,\n     * which JavaScript Strings are happy to provide. So, while we still cannot display\n     * 2-byte characters property, at least CONDITIONALLY converting (entire string containing)\n     * 16bit chars to (USC-2-BE) 2-bytes per char + BOM streams we ensure that entire PDF\n     * is still parseable.\n     * This will allow immediate support for unicode in document properties strings.\n     */\n    return to8bitStream(text, flags)\n      .replace(/\\\\/g, \"\\\\\\\\\")\n      .replace(/\\(/g, \"\\\\(\")\n      .replace(/\\)/g, \"\\\\)\");\n  });\n\n  var beginPage = (API.__private__.beginPage = function(format) {\n    pages[++page] = [];\n    pagesContext[page] = {\n      objId: 0,\n      contentsObjId: 0,\n      userUnit: Number(userUnit),\n      artBox: null,\n      bleedBox: null,\n      cropBox: null,\n      trimBox: null,\n      mediaBox: {\n        bottomLeftX: 0,\n        bottomLeftY: 0,\n        topRightX: Number(format[0]),\n        topRightY: Number(format[1])\n      }\n    };\n    _setPage(page);\n    setOutputDestination(pages[currentPage]);\n  });\n\n  var _addPage = function(parmFormat) {\n    var width, height;\n\n    if (Array.isArray(parmFormat)) {\n      width = parmFormat[0] * scaleFactor;\n      height = parmFormat[1] * scaleFactor;\n    }\n\n    if (isNaN(width)) {\n      width = format[0];\n      height = format[1];\n    }\n\n    if (width > 14400 || height > 14400) {\n      console.warn(\n        \"A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400\"\n      );\n      width = Math.min(14400, width);\n      height = Math.min(14400, height);\n    }\n\n    format = [width, height];\n\n    switch (orientation.substr(0, 1)) {\n      case \"l\":\n        if (height > width) {\n          format = [height, width];\n        }\n        break;\n      case \"p\":\n        if (width > height) {\n          format = [height, width];\n        }\n        break;\n    }\n\n    beginPage(format);\n    events.publish(\"addPage\", {\n      pageNumber: page\n    });\n  };\n\n  var _setPage = function(n) {\n    if (n > 0 && n <= page) {\n      currentPage = n;\n    }\n  };\n\n  var getNumberOfPages = (API.__private__.getNumberOfPages = API.getNumberOfPages = function() {\n    return pages.length - 1;\n  });\n\n  var putInfo = (API.__private__.putInfo = function() {\n    out(\"<<\");\n    out(\"/Producer (\" + pdfEscape(\"jsPDF \" + jsPDF.version) + \")\");\n    for (var key in documentProperties) {\n      if (documentProperties.hasOwnProperty(key) && documentProperties[key]) {\n        out(\n          \"/\" +\n            key.substr(0, 1).toUpperCase() +\n            key.substr(1) +\n            \" (\" +\n            pdfEscape(documentProperties[key]) +\n            \")\"\n        );\n      }\n    }\n    out(\"/CreationDate (\" + pdfEscape(creationDate) + \")\");\n    out(\">>\");\n    out(\"endobj\");\n  });\n\n  var putCatalog = (API.__private__.putCatalog = function(options) {\n    options = options || {};\n    var tmpRootDictionaryObjId =\n      options.rootDictionaryObjId || rootDictionaryObjId;\n    newObject();\n    out(\"<<\");\n    out(\"/Type /Catalog\");\n    out(\"/Pages \" + tmpRootDictionaryObjId + \" 0 R\");\n    // PDF13ref Section 7.2.1\n    if (!layoutMode) layoutMode = \"continuous\";\n    switch (layoutMode) {\n      case \"continuous\":\n        out(\"/PageLayout /OneColumn\");\n        break;\n      case \"single\":\n        out(\"/PageLayout /SinglePage\");\n        break;\n      case \"two\":\n      case \"twoleft\":\n        out(\"/PageLayout /TwoColumnLeft\");\n        break;\n      case \"tworight\":\n        out(\"/PageLayout /TwoColumnRight\");\n        break;\n    }\n    if (pageMode) {\n      /**\n       * A name object specifying how the document should be displayed when opened:\n       * UseNone      : Neither document outline nor thumbnail images visible -- DEFAULT\n       * UseOutlines  : Document outline visible\n       * UseThumbs    : Thumbnail images visible\n       * FullScreen   : Full-screen mode, with no menu bar, window controls, or any other window visible\n       */\n      out(\"/PageMode /\" + pageMode);\n    }\n    events.publish(\"putCatalog\");\n    out(\">>\");\n    out(\"endobj\");\n  });\n\n  var putTrailer = (API.__private__.putTrailer = function() {\n    out(\"trailer\");\n    out(\"<<\");\n    out(\"/Size \" + (objectNumber + 1));\n    // Root and Info must be the last and second last objects written respectively\n    out(\"/Root \" + objectNumber + \" 0 R\");\n    out(\"/Info \" + (objectNumber - 1) + \" 0 R\");\n    out(\"/ID [ <\" + fileId + \"> <\" + fileId + \"> ]\");\n    out(\">>\");\n  });\n\n  var putHeader = (API.__private__.putHeader = function() {\n    out(\"%PDF-\" + pdfVersion);\n    out(\"%\\xBA\\xDF\\xAC\\xE0\");\n  });\n\n  var putXRef = (API.__private__.putXRef = function() {\n    var p = \"0000000000\";\n\n    out(\"xref\");\n    out(\"0 \" + (objectNumber + 1));\n    out(\"0000000000 65535 f \");\n    for (var i = 1; i <= objectNumber; i++) {\n      var offset = offsets[i];\n      if (typeof offset === \"function\") {\n        out((p + offsets[i]()).slice(-10) + \" 00000 n \");\n      } else {\n        if (typeof offsets[i] !== \"undefined\") {\n          out((p + offsets[i]).slice(-10) + \" 00000 n \");\n        } else {\n          out(\"0000000000 00000 n \");\n        }\n      }\n    }\n  });\n\n  var buildDocument = (API.__private__.buildDocument = function() {\n    resetDocument();\n    setOutputDestination(content);\n\n    events.publish(\"buildDocument\");\n\n    putHeader();\n    putPages();\n    putResources();\n    putInfo();\n    putCatalog();\n\n    var offsetOfXRef = contentLength;\n    putXRef();\n    putTrailer();\n    out(\"startxref\");\n    out(\"\" + offsetOfXRef);\n    out(\"%%EOF\");\n\n    setOutputDestination(pages[currentPage]);\n\n    return content.join(\"\\n\");\n  });\n\n  /**\n   * Generates the PDF document.\n   *\n   * If `type` argument is undefined, output is raw body of resulting PDF returned as a string.\n   *\n   * @param {string} type A string identifying one of the possible output types.<br/>\n   *                      Possible values are: <br/>\n   *                          'arraybuffer' -> (ArrayBuffer)<br/>\n   *                          'blob' -> (Blob)<br/>\n   *                          'bloburi'/'bloburl' -> (string)<br/>\n   *                          'datauristring'/'dataurlstring' -> (string)<br/>\n   *                          'datauri'/'dataurl' -> (undefined) -> change location to generated datauristring/dataurlstring<br/>\n   *                          'dataurlnewwindow' -> (window | null | undefined) throws error if global isn't a window object(node)<br/>\n   *                          'pdfobjectnewwindow' -> (window | null) throws error if global isn't a window object(node)<br/>\n   *                          'pdfjsnewwindow' -> (wind | null)\n   * @param {Object|string} options An object providing some additional signalling to PDF generator.<br/>\n   *                                Possible options are 'filename'.<br/>\n   *                                A string can be passed instead of {filename:string} and defaults to 'generated.pdf'\n   * @function\n   * @instance\n   * @returns {string|window|ArrayBuffer|Blob|jsPDF|null|undefined}\n   * @memberof jsPDF#\n   * @name output\n   */\n  var output = (API.output = API.__private__.output = SAFE(function output(\n    type,\n    options\n  ) {\n    options = options || {};\n\n    if (typeof options === \"string\") {\n      options = {\n        filename: options\n      };\n    } else {\n      options.filename = options.filename || \"generated.pdf\";\n    }\n\n    switch (type) {\n      case \"arraybuffer\":\n        return getArrayBuffer(buildDocument());\n      case \"datauristring\":\n      case \"dataurlstring\":\n        var dataURI = \"\";\n        var pdfDocument = buildDocument();\n        try {\n          dataURI = btoa(pdfDocument);\n        } catch (e) {\n          dataURI = btoa(unescape(encodeURIComponent(pdfDocument)));\n        }\n        return (\n          \"data:application/pdf;filename=\" +\n          options.filename +\n          \";base64,\" +\n          dataURI\n        );\n      default:\n        return null;\n    }\n  }));\n\n  /**\n   * Used to see if a supplied hotfix was requested when the pdf instance was created.\n   * @param {string} hotfixName - The name of the hotfix to check.\n   * @returns {boolean}\n   */\n  var hasHotfix = function(hotfixName) {\n    return (\n      Array.isArray(hotfixes) === true && hotfixes.indexOf(hotfixName) > -1\n    );\n  };\n\n  switch (unit) {\n    case \"pt\":\n      scaleFactor = 1;\n      break;\n    case \"mm\":\n      scaleFactor = 72 / 25.4;\n      break;\n    case \"cm\":\n      scaleFactor = 72 / 2.54;\n      break;\n    case \"in\":\n      scaleFactor = 72;\n      break;\n    case \"px\":\n      if (hasHotfix(\"px_scaling\") == true) {\n        scaleFactor = 72 / 96;\n      } else {\n        scaleFactor = 96 / 72;\n      }\n      break;\n    case \"pc\":\n      scaleFactor = 12;\n      break;\n    case \"em\":\n      scaleFactor = 12;\n      break;\n    case \"ex\":\n      scaleFactor = 6;\n      break;\n    default:\n      if (typeof unit === \"number\") {\n        scaleFactor = unit;\n      } else {\n        throw new Error(\"Invalid unit: \" + unit);\n      }\n  }\n\n  setCreationDate();\n  setFileId();\n\n  /**\n   * Adds (and transfers the focus to) new page to the PDF document.\n   * @param format {String/Array} The format of the new page. Can be: <ul><li>a0 - a10</li><li>b0 - b10</li><li>c0 - c10</li><li>dl</li><li>letter</li><li>government-letter</li><li>legal</li><li>junior-legal</li><li>ledger</li><li>tabloid</li><li>credit-card</li></ul><br />\n   * Default is \"a4\". If you want to use your own format just pass instead of one of the above predefined formats the size as an number-array, e.g. [595.28, 841.89]\n   * @param orientation {string} Orientation of the new page. Possible values are \"portrait\" or \"landscape\" (or shortcuts \"p\" (Default), \"l\").\n   * @function\n   * @instance\n   * @returns {jsPDF}\n   *\n   * @memberof jsPDF#\n   * @name addPage\n   */\n  API.addPage = function() {\n    _addPage.apply(this, arguments);\n    return this;\n  };\n\n  var isValidStyle = (API.__private__.isValidStyle = function(style) {\n    var validStyleVariants = [\n      undefined,\n      null,\n      \"S\",\n      \"D\",\n      \"F\",\n      \"DF\",\n      \"FD\",\n      \"f\",\n      \"f*\",\n      \"B\",\n      \"B*\",\n      \"n\"\n    ];\n    var result = false;\n    if (validStyleVariants.indexOf(style) !== -1) {\n      result = true;\n    }\n    return result;\n  });\n\n  /**\n   * Close the current path. The PDF \"h\" operator.\n   * @name close\n   * @function\n   * @instance\n   * @returns {jsPDF}\n   * @memberof jsPDF#\n   */\n  var close = (API.close = function() {\n    out(\"h\");\n    return this;\n  });\n\n  var getHorizontalCoordinate = (API.__private__.getHorizontalCoordinate = function(\n    value\n  ) {\n    return scale(value);\n  });\n\n  var getVerticalCoordinate = (API.__private__.getVerticalCoordinate = function(\n    value\n  ) {\n    if (apiMode === ApiMode.ADVANCED) {\n      return value;\n    } else {\n      var pageHeight =\n        pagesContext[currentPage].mediaBox.topRightY -\n        pagesContext[currentPage].mediaBox.bottomLeftY;\n      return pageHeight - scale(value);\n    }\n  });\n\n  var getHorizontalCoordinateString = (API.__private__.getHorizontalCoordinateString = API.getHorizontalCoordinateString = function(\n    value\n  ) {\n    return hpf(getHorizontalCoordinate(value));\n  });\n\n  var getVerticalCoordinateString = (API.__private__.getVerticalCoordinateString = API.getVerticalCoordinateString = function(\n    value\n  ) {\n    return hpf(getVerticalCoordinate(value));\n  });\n\n  // applying plugins (more methods) ON TOP of built-in API.\n  // this is intentional as we allow plugins to override\n  // built-ins\n  for (var plugin in jsPDF.API) {\n    if (jsPDF.API.hasOwnProperty(plugin)) {\n      if (plugin === \"events\" && jsPDF.API.events.length) {\n        (function(events, newEvents) {\n          // jsPDF.API.events is a JS Array of Arrays\n          // where each Array is a pair of event name, handler\n          // Events were added by plugins to the jsPDF instantiator.\n          // These are always added to the new instance and some ran\n          // during instantiation.\n          var eventname, handler_and_args, i;\n\n          for (i = newEvents.length - 1; i !== -1; i--) {\n            // subscribe takes 3 args: 'topic', function, runonce_flag\n            // if undefined, runonce is false.\n            // users can attach callback directly,\n            // or they can attach an array with [callback, runonce_flag]\n            // that's what the \"apply\" magic is for below.\n            eventname = newEvents[i][0];\n            handler_and_args = newEvents[i][1];\n            events.subscribe.apply(\n              events,\n              [eventname].concat(\n                typeof handler_and_args === \"function\"\n                  ? [handler_and_args]\n                  : handler_and_args\n              )\n            );\n          }\n        })(events, jsPDF.API.events);\n      } else {\n        API[plugin] = jsPDF.API[plugin];\n      }\n    }\n  }\n  /**\n   * Object exposing internal API to plugins\n   * @public\n   * @ignore\n   */\n  API.internal = {\n    pdfEscape: pdfEscape,\n    write: write,\n    getHorizontalCoordinate: getHorizontalCoordinate,\n    getVerticalCoordinate: getVerticalCoordinate,\n    getCoordinateString: getHorizontalCoordinateString,\n    getVerticalCoordinateString: getVerticalCoordinateString,\n    collections: {},\n    newObject: newObject,\n    newAdditionalObject: newAdditionalObject,\n    newObjectDeferred: newObjectDeferred,\n    newObjectDeferredBegin: newObjectDeferredBegin,\n    getFilters: getFilters,\n    putStream: putStream,\n    events: events,\n    scaleFactor: scaleFactor,\n    output: output,\n    getNumberOfPages: getNumberOfPages,\n    pages: pages,\n    out: out,\n    getPDFVersion: getPdfVersion,\n    hasHotfix: hasHotfix //Expose the hasHotfix check so plugins can also check them.\n  };\n\n  activeFontKey = \"F1\";\n  _addPage(format, orientation);\n\n  events.publish(\"initialized\");\n  return API;\n}\n\n/**\n * jsPDF.API is a STATIC property of jsPDF class.\n * jsPDF.API is an object you can add methods and properties to.\n * The methods / properties you add will show up in new jsPDF objects.\n *\n * One property is prepopulated. It is the 'events' Object. Plugin authors can add topics,\n * callbacks to this object. These will be reassigned to all new instances of jsPDF.\n *\n * @static\n * @public\n * @memberof jsPDF#\n * @name API\n *\n * @example\n * jsPDF.API.mymethod = function(){\n *   // 'this' will be ref to internal API object. see jsPDF source\n *   // , so you can refer to built-in methods like so:\n *   //     this.line(....)\n *   //     this.text(....)\n * }\n * var pdfdoc = new jsPDF()\n * pdfdoc.mymethod() // <- !!!!!!\n */\njsPDF.API = {\n  events: []\n};\n/**\n * The version of jsPDF.\n * @name version\n * @type {string}\n * @memberof jsPDF#\n */\njsPDF.version = \"0.0.0\";\n\nexport { jsPDF };\nexport default jsPDF;\n","/** @license\n * jsPDF addImage plugin\n * Copyright (c) 2012 Jason Siefken, https://github.com/siefkenj/\n *               2013 Chris Dowling, https://github.com/gingerchris\n *               2013 Trinh Ho, https://github.com/ineedfat\n *               2013 Edwin Alejandro Perez, https://github.com/eaparango\n *               2013 Norah Smith, https://github.com/burnburnrocket\n *               2014 Diego Casorran, https://github.com/diegocr\n *               2014 James Robb, https://github.com/jamesbrobb\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n/**\n * @name addImage\n * @module\n */\n\nimport { jsPDF } from \"../jspdf.js\";\nimport { atob, btoa } from \"../libs/AtobBtoa.js\";\n\n(function(jsPDFAPI) {\n  \"use strict\";\n\n  var namespace = \"addImage_\";\n  jsPDFAPI.__addimage__ = {};\n\n  // Heuristic selection of a good batch for large array .apply. Not limiting make the call overflow.\n  // With too small batch iteration will be slow as more calls are made,\n  // higher values cause larger and slower garbage collection.\n  var ARRAY_APPLY_BATCH = 8192;\n  // Image functionality ported from pdf.js\n  var putImage = function(image) {\n    var out = this.internal.write;\n    var putStream = this.internal.putStream;\n    var getFilters = this.internal.getFilters;\n\n    var filter = getFilters();\n    while (filter.indexOf(\"FlateEncode\") !== -1) {\n      filter.splice(filter.indexOf(\"FlateEncode\"), 1);\n    }\n\n    image.objectId = this.internal.newObject();\n\n    var additionalKeyValues = [];\n    additionalKeyValues.push({ key: \"Type\", value: \"/XObject\" });\n    additionalKeyValues.push({ key: \"Subtype\", value: \"/Image\" });\n    additionalKeyValues.push({ key: \"Width\", value: image.width });\n    additionalKeyValues.push({ key: \"Height\", value: image.height });\n\n    if (image.colorSpace === color_spaces.INDEXED) {\n      additionalKeyValues.push({\n        key: \"ColorSpace\",\n        value:\n          \"[/Indexed /DeviceRGB \" +\n          // if an indexed png defines more than one colour with transparency, we've created a sMask\n          (image.palette.length / 3 - 1) +\n          \" \" +\n          (\"sMask\" in image && typeof image.sMask !== \"undefined\"\n            ? image.objectId + 2\n            : image.objectId + 1) +\n          \" 0 R]\"\n      });\n    } else {\n      additionalKeyValues.push({\n        key: \"ColorSpace\",\n        value: \"/\" + image.colorSpace\n      });\n      if (image.colorSpace === color_spaces.DEVICE_CMYK) {\n        additionalKeyValues.push({ key: \"Decode\", value: \"[1 0 1 0 1 0 1 0]\" });\n      }\n    }\n    additionalKeyValues.push({\n      key: \"BitsPerComponent\",\n      value: image.bitsPerComponent\n    });\n    if (\n      \"decodeParameters\" in image &&\n      typeof image.decodeParameters !== \"undefined\"\n    ) {\n      additionalKeyValues.push({\n        key: \"DecodeParms\",\n        value: \"<<\" + image.decodeParameters + \">>\"\n      });\n    }\n    if (\"transparency\" in image && Array.isArray(image.transparency)) {\n      var transparency = \"\",\n        i = 0,\n        len = image.transparency.length;\n      for (; i < len; i++)\n        transparency +=\n          image.transparency[i] + \" \" + image.transparency[i] + \" \";\n\n      additionalKeyValues.push({\n        key: \"Mask\",\n        value: \"[\" + transparency + \"]\"\n      });\n    }\n    if (typeof image.sMask !== \"undefined\") {\n      additionalKeyValues.push({\n        key: \"SMask\",\n        value: image.objectId + 1 + \" 0 R\"\n      });\n    }\n\n    var alreadyAppliedFilters =\n      typeof image.filter !== \"undefined\" ? [\"/\" + image.filter] : undefined;\n\n    putStream({\n      data: image.data,\n      additionalKeyValues: additionalKeyValues,\n      alreadyAppliedFilters: alreadyAppliedFilters,\n      objectId: image.objectId\n    });\n\n    out(\"endobj\");\n\n    // Soft mask\n    if (\"sMask\" in image && typeof image.sMask !== \"undefined\") {\n      var decodeParameters =\n        \"/Predictor \" +\n        image.predictor +\n        \" /Colors 1 /BitsPerComponent \" +\n        image.bitsPerComponent +\n        \" /Columns \" +\n        image.width;\n      var sMask = {\n        width: image.width,\n        height: image.height,\n        colorSpace: \"DeviceGray\",\n        bitsPerComponent: image.bitsPerComponent,\n        decodeParameters: decodeParameters,\n        data: image.sMask\n      };\n      if (\"filter\" in image) {\n        sMask.filter = image.filter;\n      }\n      putImage.call(this, sMask);\n    }\n\n    //Palette\n    if (image.colorSpace === color_spaces.INDEXED) {\n      var objId = this.internal.newObject();\n      //out('<< /Filter / ' + img['f'] +' /Length ' + img['pal'].length + '>>');\n      //putStream(zlib.compress(img['pal']));\n      putStream({\n        data: arrayBufferToBinaryString(new Uint8Array(image.palette)),\n        objectId: objId\n      });\n      out(\"endobj\");\n    }\n  };\n  var putResourcesCallback = function() {\n    var images = this.internal.collections[namespace + \"images\"];\n    for (var i in images) {\n      putImage.call(this, images[i]);\n    }\n  };\n  var putXObjectsDictCallback = function() {\n    var images = this.internal.collections[namespace + \"images\"],\n      out = this.internal.write,\n      image;\n    for (var i in images) {\n      image = images[i];\n      out(\"/I\" + image.index, image.objectId, \"0\", \"R\");\n    }\n  };\n\n  var checkCompressValue = function(value) {\n    if (value && typeof value === \"string\") value = value.toUpperCase();\n    return value in jsPDFAPI.image_compression ? value : image_compression.NONE;\n  };\n\n  var initialize = function() {\n    if (!this.internal.collections[namespace + \"images\"]) {\n      this.internal.collections[namespace + \"images\"] = {};\n      this.internal.events.subscribe(\"putResources\", putResourcesCallback);\n      this.internal.events.subscribe(\"putXobjectDict\", putXObjectsDictCallback);\n    }\n  };\n\n  var getImages = function() {\n    var images = this.internal.collections[namespace + \"images\"];\n    initialize.call(this);\n    return images;\n  };\n  var getImageIndex = function() {\n    return Object.keys(this.internal.collections[namespace + \"images\"]).length;\n  };\n  var notDefined = function(value) {\n    return typeof value === \"undefined\" || value === null || value.length === 0;\n  };\n  var generateAliasFromImageData = function(imageData) {\n    if (typeof imageData === \"string\" || isArrayBufferView(imageData)) {\n      return sHashCode(imageData);\n    } else if (isArrayBufferView(imageData.data)) {\n      return sHashCode(imageData.data);\n    }\n\n    return null;\n  };\n\n  var isImageTypeSupported = function(type) {\n    return typeof jsPDFAPI[\"process\" + type.toUpperCase()] === \"function\";\n  };\n\n  var checkImagesForAlias = function(alias) {\n    var images = this.internal.collections[namespace + \"images\"];\n    if (images) {\n      for (var e in images) {\n        if (alias === images[e].alias) {\n          return images[e];\n        }\n      }\n    }\n  };\n\n  var determineWidthAndHeight = function(width, height, image) {\n    if (!width && !height) {\n      width = -96;\n      height = -96;\n    }\n    if (width < 0) {\n      width = (-1 * image.width * 72) / width / this.internal.scaleFactor;\n    }\n    if (height < 0) {\n      height = (-1 * image.height * 72) / height / this.internal.scaleFactor;\n    }\n    if (width === 0) {\n      width = (height * image.width) / image.height;\n    }\n    if (height === 0) {\n      height = (width * image.height) / image.width;\n    }\n\n    return [width, height];\n  };\n\n  var writeImageToPDF = function(x, y, width, height, image, rotation) {\n    var dims = determineWidthAndHeight.call(this, width, height, image),\n      coord = this.internal.getCoordinateString,\n      vcoord = this.internal.getVerticalCoordinateString;\n\n    var images = getImages.call(this);\n\n    width = dims[0];\n    height = dims[1];\n    images[image.index] = image;\n\n    if (rotation) {\n      rotation *= Math.PI / 180;\n      var c = Math.cos(rotation);\n      var s = Math.sin(rotation);\n      //like in pdf Reference do it 4 digits instead of 2\n      var f4 = function(number) {\n        return number.toFixed(4);\n      };\n      var rotationTransformationMatrix = [\n        f4(c),\n        f4(s),\n        f4(s * -1),\n        f4(c),\n        0,\n        0,\n        \"cm\"\n      ];\n    }\n    this.internal.write(\"q\"); //Save graphics state\n    if (rotation) {\n      this.internal.write(\n        [1, \"0\", \"0\", 1, coord(x), vcoord(y + height), \"cm\"].join(\" \")\n      ); //Translate\n      this.internal.write(rotationTransformationMatrix.join(\" \")); //Rotate\n      this.internal.write(\n        [coord(width), \"0\", \"0\", coord(height), \"0\", \"0\", \"cm\"].join(\" \")\n      ); //Scale\n    } else {\n      this.internal.write(\n        [\n          coord(width),\n          \"0\",\n          \"0\",\n          coord(height),\n          coord(x),\n          vcoord(y + height),\n          \"cm\"\n        ].join(\" \")\n      ); //Translate and Scale\n    }\n\n    if (this.isAdvancedAPI()) {\n      // draw image bottom up when in \"advanced\" API mode\n      this.internal.write([1, 0, 0, -1, 0, 0, \"cm\"].join(\" \"));\n    }\n\n    this.internal.write(\"/I\" + image.index + \" Do\"); //Paint Image\n    this.internal.write(\"Q\"); //Restore graphics state\n  };\n\n  /**\n   * COLOR SPACES\n   */\n  var color_spaces = (jsPDFAPI.color_spaces = {\n    DEVICE_RGB: \"DeviceRGB\",\n    DEVICE_GRAY: \"DeviceGray\",\n    DEVICE_CMYK: \"DeviceCMYK\",\n    CAL_GREY: \"CalGray\",\n    CAL_RGB: \"CalRGB\",\n    LAB: \"Lab\",\n    ICC_BASED: \"ICCBased\",\n    INDEXED: \"Indexed\",\n    PATTERN: \"Pattern\",\n    SEPARATION: \"Separation\",\n    DEVICE_N: \"DeviceN\"\n  });\n\n  /**\n   * DECODE METHODS\n   */\n  jsPDFAPI.decode = {\n    DCT_DECODE: \"DCTDecode\",\n    FLATE_DECODE: \"FlateDecode\",\n    LZW_DECODE: \"LZWDecode\",\n    JPX_DECODE: \"JPXDecode\",\n    JBIG2_DECODE: \"JBIG2Decode\",\n    ASCII85_DECODE: \"ASCII85Decode\",\n    ASCII_HEX_DECODE: \"ASCIIHexDecode\",\n    RUN_LENGTH_DECODE: \"RunLengthDecode\",\n    CCITT_FAX_DECODE: \"CCITTFaxDecode\"\n  };\n\n  /**\n   * IMAGE COMPRESSION TYPES\n   */\n  var image_compression = (jsPDFAPI.image_compression = {\n    NONE: \"NONE\",\n    FAST: \"FAST\",\n    MEDIUM: \"MEDIUM\",\n    SLOW: \"SLOW\"\n  });\n\n  /**\n   * @name sHashCode\n   * @function\n   * @param {string} data\n   * @returns {string}\n   */\n  var sHashCode = (jsPDFAPI.__addimage__.sHashCode = function(data) {\n    var hash = 0,\n      i,\n      len;\n\n    if (typeof data === \"string\") {\n      len = data.length;\n      for (i = 0; i < len; i++) {\n        hash = (hash << 5) - hash + data.charCodeAt(i);\n        hash |= 0; // Convert to 32bit integer\n      }\n    } else if (isArrayBufferView(data)) {\n      len = data.byteLength / 2;\n      for (i = 0; i < len; i++) {\n        hash = (hash << 5) - hash + data[i];\n        hash |= 0; // Convert to 32bit integer\n      }\n    }\n    return hash;\n  });\n\n  /**\n   * Validates if given String is a valid Base64-String\n   *\n   * @name validateStringAsBase64\n   * @public\n   * @function\n   * @param {String} possible Base64-String\n   *\n   * @returns {boolean}\n   */\n  var validateStringAsBase64 = (jsPDFAPI.__addimage__.validateStringAsBase64 = function(\n    possibleBase64String\n  ) {\n    possibleBase64String = possibleBase64String || \"\";\n    possibleBase64String.toString().trim();\n\n    var result = true;\n\n    if (possibleBase64String.length === 0) {\n      result = false;\n    }\n\n    if (possibleBase64String.length % 4 !== 0) {\n      result = false;\n    }\n\n    if (\n      /^[A-Za-z0-9+/]+$/.test(\n        possibleBase64String.substr(0, possibleBase64String.length - 2)\n      ) === false\n    ) {\n      result = false;\n    }\n\n    if (\n      /^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(\n        possibleBase64String.substr(-2)\n      ) === false\n    ) {\n      result = false;\n    }\n    return result;\n  });\n\n  /**\n   * Strips out and returns info from a valid base64 data URI\n   *\n   * @name extractImageFromDataUrl\n   * @function\n   * @param {string} dataUrl a valid data URI of format 'data:[<MIME-type>][;base64],<data>'\n   * @returns {Array}an Array containing the following\n   * [0] the complete data URI\n   * [1] <MIME-type>\n   * [2] format - the second part of the mime-type i.e 'png' in 'image/png'\n   * [4] <data>\n   */\n  var extractImageFromDataUrl = (jsPDFAPI.__addimage__.extractImageFromDataUrl = function(\n    dataUrl\n  ) {\n    dataUrl = dataUrl || \"\";\n    var dataUrlParts = dataUrl.split(\"base64,\");\n    var result = null;\n\n    if (dataUrlParts.length === 2) {\n      var extractedInfo = /^data:(\\w*\\/\\w*);*(charset=(?!charset=)[\\w=-]*)*;*$/.exec(\n        dataUrlParts[0]\n      );\n      if (Array.isArray(extractedInfo)) {\n        result = {\n          mimeType: extractedInfo[1],\n          charset: extractedInfo[2],\n          data: dataUrlParts[1]\n        };\n      }\n    }\n    return result;\n  });\n\n  /**\n   * Check to see if ArrayBuffer is supported\n   *\n   * @name supportsArrayBuffer\n   * @function\n   * @returns {boolean}\n   */\n  var supportsArrayBuffer = (jsPDFAPI.__addimage__.supportsArrayBuffer = function() {\n    return (\n      typeof ArrayBuffer !== \"undefined\" && typeof Uint8Array !== \"undefined\"\n    );\n  });\n\n  /**\n   * Tests supplied object to determine if ArrayBuffer\n   *\n   * @name isArrayBuffer\n   * @function\n   * @param {Object} object an Object\n   *\n   * @returns {boolean}\n   */\n  jsPDFAPI.__addimage__.isArrayBuffer = function(object) {\n    return supportsArrayBuffer() && object instanceof ArrayBuffer;\n  };\n\n  /**\n   * Tests supplied object to determine if it implements the ArrayBufferView (TypedArray) interface\n   *\n   * @name isArrayBufferView\n   * @function\n   * @param {Object} object an Object\n   * @returns {boolean}\n   */\n  var isArrayBufferView = (jsPDFAPI.__addimage__.isArrayBufferView = function(\n    object\n  ) {\n    return (\n      supportsArrayBuffer() &&\n      typeof Uint32Array !== \"undefined\" &&\n      (object instanceof Int8Array ||\n        object instanceof Uint8Array ||\n        (typeof Uint8ClampedArray !== \"undefined\" &&\n          object instanceof Uint8ClampedArray) ||\n        object instanceof Int16Array ||\n        object instanceof Uint16Array ||\n        object instanceof Int32Array ||\n        object instanceof Uint32Array ||\n        object instanceof Float32Array ||\n        object instanceof Float64Array)\n    );\n  });\n\n  /**\n   * Convert Binary String to ArrayBuffer\n   *\n   * @name binaryStringToUint8Array\n   * @public\n   * @function\n   * @param {string} BinaryString with ImageData\n   * @returns {Uint8Array}\n   */\n  var binaryStringToUint8Array = (jsPDFAPI.__addimage__.binaryStringToUint8Array = function(\n    binary_string\n  ) {\n    var len = binary_string.length;\n    var bytes = new Uint8Array(len);\n    for (var i = 0; i < len; i++) {\n      bytes[i] = binary_string.charCodeAt(i);\n    }\n    return bytes;\n  });\n\n  /**\n   * Convert the Buffer to a Binary String\n   *\n   * @name arrayBufferToBinaryString\n   * @public\n   * @function\n   * @param {ArrayBuffer|ArrayBufferView} ArrayBuffer buffer or bufferView with ImageData\n   *\n   * @returns {String}\n   */\n  var arrayBufferToBinaryString = (jsPDFAPI.__addimage__.arrayBufferToBinaryString = function(\n    buffer\n  ) {\n    var out = \"\";\n    // There are calls with both ArrayBuffer and already converted Uint8Array or other BufferView.\n    // Do not copy the array if input is already an array.\n    var buf = isArrayBufferView(buffer) ? buffer : new Uint8Array(buffer);\n    for (var i = 0; i < buf.length; i += ARRAY_APPLY_BATCH) {\n      // Limit the amount of characters being parsed to prevent overflow.\n      // Note that while TextDecoder would be faster, it does not have the same\n      // functionality as fromCharCode with any provided encodings as of 3/2021.\n      out += String.fromCharCode.apply(\n        null,\n        buf.subarray(i, i + ARRAY_APPLY_BATCH)\n      );\n    }\n    return out;\n  });\n\n  /**\n   * Possible parameter for addImage, an RGBA buffer with size.\n   *\n   * @typedef {Object} RGBAData\n   * @property {Uint8ClampedArray} data - Single dimensional array of RGBA values. For example from canvas getImageData.\n   * @property {number} width - Image width as the data does not carry this information in itself.\n   * @property {number} height - Image height as the data does not carry this information in itself.\n   */\n\n  /**\n   * Adds an Image to the PDF.\n   *\n   * @name addImage\n   * @public\n   * @function\n   * @param {string|HTMLImageElement|HTMLCanvasElement|Uint8Array|RGBAData} imageData imageData as base64 encoded DataUrl or Image-HTMLElement or Canvas-HTMLElement or object containing RGBA array (like output from canvas.getImageData).\n   * @param {string} format format of file if filetype-recognition fails or in case of a Canvas-Element needs to be specified (default for Canvas is JPEG), e.g. 'JPEG', 'PNG', 'WEBP'\n   * @param {number} x x Coordinate (in units declared at inception of PDF document) against left edge of the page\n   * @param {number} y y Coordinate (in units declared at inception of PDF document) against upper edge of the page\n   * @param {number} width width of the image (in units declared at inception of PDF document)\n   * @param {number} height height of the Image (in units declared at inception of PDF document)\n   * @param {string} alias alias of the image (if used multiple times)\n   * @param {string} compression compression of the generated JPEG, can have the values 'NONE', 'FAST', 'MEDIUM' and 'SLOW'\n   * @param {number} rotation rotation of the image in degrees (0-359)\n   *\n   * @returns jsPDF\n   */\n  jsPDFAPI.addImage = function() {\n    var imageData, format, x, y, w, h, alias, compression, rotation;\n\n    imageData = arguments[0];\n    format = arguments[1];\n    x = arguments[2];\n    y = arguments[3];\n    w = arguments[4];\n    h = arguments[5];\n    alias = arguments[6];\n    compression = arguments[7];\n    rotation = arguments[8];\n\n    //If compression is not explicitly set, determine if we should use compression\n    var filter = this.internal.getFilters();\n    if (compression === undefined && filter.indexOf(\"FlateEncode\") !== -1) {\n      compression = \"SLOW\";\n    }\n\n    if (isNaN(x) || isNaN(y)) {\n      throw new Error(\"Invalid coordinates passed to jsPDF.addImage\");\n    }\n\n    initialize.call(this);\n\n    var image = processImageData.call(\n      this,\n      imageData,\n      format,\n      alias,\n      compression\n    );\n\n    writeImageToPDF.call(this, x, y, w, h, image, rotation);\n\n    return this;\n  };\n\n  var processImageData = function(imageData, format, alias, compression) {\n    var result, dataAsBinaryString;\n    imageData = unescape(imageData);\n    var tmpImageData = convertBase64ToBinaryString(imageData, false);\n    imageData = tmpImageData;\n\n    format = \"PNG\";\n    if (!isImageTypeSupported(format)) {\n      throw new Error(\n        \"addImage does not support files of type '\" +\n          format +\n          \"', please ensure that a plugin for '\" +\n          format +\n          \"' support is added.\"\n      );\n    }\n\n    // now do the heavy lifting\n\n    if (notDefined(alias)) {\n      alias = generateAliasFromImageData(imageData);\n    }\n    result = checkImagesForAlias.call(this, alias);\n\n    if (!result) {\n      if (supportsArrayBuffer()) {\n        // no need to convert if imageData is already uint8array\n        if (!(imageData instanceof Uint8Array) && format !== \"RGBA\") {\n          dataAsBinaryString = imageData;\n          imageData = binaryStringToUint8Array(imageData);\n        }\n      }\n\n      result = this[\"process\" + format.toUpperCase()](\n        imageData,\n        getImageIndex.call(this),\n        alias,\n        checkCompressValue(compression),\n        dataAsBinaryString\n      );\n    }\n\n    if (!result) {\n      throw new Error(\"An unknown error occurred whilst processing the image.\");\n    }\n    return result;\n  };\n\n  /**\n   * @name convertBase64ToBinaryString\n   * @function\n   * @param {string} stringData\n   * @returns {string} binary string\n   */\n  var convertBase64ToBinaryString = (jsPDFAPI.__addimage__.convertBase64ToBinaryString = function(\n    stringData,\n    throwError\n  ) {\n    throwError = typeof throwError === \"boolean\" ? throwError : true;\n    var base64Info;\n    var imageData = \"\";\n    var rawData;\n\n    if (typeof stringData === \"string\") {\n      base64Info = extractImageFromDataUrl(stringData);\n      rawData = base64Info !== null ? base64Info.data : stringData;\n\n      try {\n        imageData = atob(rawData);\n      } catch (e) {\n        if (throwError) {\n          if (!validateStringAsBase64(rawData)) {\n            throw new Error(\n              \"Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString \"\n            );\n          } else {\n            throw new Error(\n              \"atob-Error in jsPDF.convertBase64ToBinaryString \" + e.message\n            );\n          }\n        }\n      }\n    }\n    return imageData;\n  });\n\n  /**\n   * @name getImageProperties\n   * @function\n   * @param {Object} imageData\n   * @returns {Object}\n   */\n  jsPDFAPI.getImageProperties = function(imageData) {\n    var image;\n    var tmpImageData = \"\";\n    var format = \"PNG\";\n\n    tmpImageData = convertBase64ToBinaryString(imageData, false);\n    imageData = tmpImageData;\n\n    if (!isImageTypeSupported(format)) {\n      throw new Error(\n        \"addImage does not support files of type '\" +\n          format +\n          \"', please ensure that a plugin for '\" +\n          format +\n          \"' support is added.\"\n      );\n    }\n\n    if (supportsArrayBuffer() && !(imageData instanceof Uint8Array)) {\n      imageData = binaryStringToUint8Array(imageData);\n    }\n\n    image = this[\"process\" + format.toUpperCase()](imageData);\n\n    if (!image) {\n      throw new Error(\"An unknown error occurred whilst processing the image\");\n    }\n\n    image.fileType = format;\n\n    return image;\n  };\n})(jsPDF.API);\n","// Generated by CoffeeScript 1.4.0\n\n/**\n * @license\n * PNG.js\n * Copyright (c) 2011 Devon Govett\n * MIT LICENSE\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this\n * software and associated documentation files (the \"Software\"), to deal in the Software\n * without restriction, including without limitation the rights to use, copy, modify, merge,\n * publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons\n * to whom the Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all copies or\n * substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING\n * BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\nimport { unzlibSync } from \"./fflate.js\";\nimport { globalObject } from \"./globalObject.js\";\n\nvar PNG = (function() {\n  var APNG_BLEND_OP_OVER,\n    APNG_BLEND_OP_SOURCE,\n    APNG_DISPOSE_OP_BACKGROUND,\n    APNG_DISPOSE_OP_NONE,\n    APNG_DISPOSE_OP_PREVIOUS,\n    makeImage,\n    scratchCanvas,\n    scratchCtx;\n\n  APNG_DISPOSE_OP_NONE = 0;\n\n  APNG_DISPOSE_OP_BACKGROUND = 1;\n\n  APNG_DISPOSE_OP_PREVIOUS = 2;\n\n  APNG_BLEND_OP_SOURCE = 0;\n\n  APNG_BLEND_OP_OVER = 1;\n\n  function PNG(data) {\n    var chunkSize,\n      colors,\n      palLen,\n      delayDen,\n      delayNum,\n      frame,\n      i,\n      index,\n      key,\n      section,\n      palShort,\n      text,\n      _i,\n      _j,\n      _ref;\n    this.data = data;\n    this.pos = 8;\n    this.palette = [];\n    this.imgData = [];\n    this.transparency = {};\n    this.animation = null;\n    this.text = {};\n    frame = null;\n    while (true) {\n      chunkSize = this.readUInt32();\n      section = function() {\n        var _i, _results;\n        _results = [];\n        for (i = _i = 0; _i < 4; i = ++_i) {\n          _results.push(String.fromCharCode(this.data[this.pos++]));\n        }\n        return _results;\n      }\n        .call(this)\n        .join(\"\");\n      switch (section) {\n        case \"IHDR\":\n          this.width = this.readUInt32();\n          this.height = this.readUInt32();\n          this.bits = this.data[this.pos++];\n          this.colorType = this.data[this.pos++];\n          this.compressionMethod = this.data[this.pos++];\n          this.filterMethod = this.data[this.pos++];\n          this.interlaceMethod = this.data[this.pos++];\n          break;\n        case \"acTL\":\n          this.animation = {\n            numFrames: this.readUInt32(),\n            numPlays: this.readUInt32() || Infinity,\n            frames: []\n          };\n          break;\n        case \"PLTE\":\n          this.palette = this.read(chunkSize);\n          break;\n        case \"fcTL\":\n          if (frame) {\n            this.animation.frames.push(frame);\n          }\n          this.pos += 4;\n          frame = {\n            width: this.readUInt32(),\n            height: this.readUInt32(),\n            xOffset: this.readUInt32(),\n            yOffset: this.readUInt32()\n          };\n          delayNum = this.readUInt16();\n          delayDen = this.readUInt16() || 100;\n          frame.delay = (1000 * delayNum) / delayDen;\n          frame.disposeOp = this.data[this.pos++];\n          frame.blendOp = this.data[this.pos++];\n          frame.data = [];\n          break;\n        case \"IDAT\":\n        case \"fdAT\":\n          if (section === \"fdAT\") {\n            this.pos += 4;\n            chunkSize -= 4;\n          }\n          data = (frame != null ? frame.data : void 0) || this.imgData;\n          for (\n            i = _i = 0;\n            0 <= chunkSize ? _i < chunkSize : _i > chunkSize;\n            i = 0 <= chunkSize ? ++_i : --_i\n          ) {\n            data.push(this.data[this.pos++]);\n          }\n          break;\n        case \"tRNS\":\n          this.transparency = {};\n          switch (this.colorType) {\n            case 3:\n              palLen = this.palette.length / 3;\n              this.transparency.indexed = this.read(chunkSize);\n              if (this.transparency.indexed.length > palLen)\n                throw new Error(\"More transparent colors than palette size\");\n              /*\n               * According to the PNG spec trns should be increased to the same size as palette if shorter\n               */\n              //palShort = 255 - this.transparency.indexed.length;\n              palShort = palLen - this.transparency.indexed.length;\n              if (palShort > 0) {\n                for (\n                  i = _j = 0;\n                  0 <= palShort ? _j < palShort : _j > palShort;\n                  i = 0 <= palShort ? ++_j : --_j\n                ) {\n                  this.transparency.indexed.push(255);\n                }\n              }\n              break;\n            case 0:\n              this.transparency.grayscale = this.read(chunkSize)[0];\n              break;\n            case 2:\n              this.transparency.rgb = this.read(chunkSize);\n          }\n          break;\n        case \"tEXt\":\n          text = this.read(chunkSize);\n          index = text.indexOf(0);\n          key = String.fromCharCode.apply(String, text.slice(0, index));\n          this.text[key] = String.fromCharCode.apply(\n            String,\n            text.slice(index + 1)\n          );\n          break;\n        case \"IEND\":\n          if (frame) {\n            this.animation.frames.push(frame);\n          }\n          this.colors = function() {\n            switch (this.colorType) {\n              case 0:\n              case 3:\n              case 4:\n                return 1;\n              case 2:\n              case 6:\n                return 3;\n            }\n          }.call(this);\n          this.hasAlphaChannel = (_ref = this.colorType) === 4 || _ref === 6;\n          colors = this.colors + (this.hasAlphaChannel ? 1 : 0);\n          this.pixelBitlength = this.bits * colors;\n          this.colorSpace = function() {\n            switch (this.colors) {\n              case 1:\n                return \"DeviceGray\";\n              case 3:\n                return \"DeviceRGB\";\n            }\n          }.call(this);\n          this.imgData = new Uint8Array(this.imgData);\n          return;\n        default:\n          this.pos += chunkSize;\n      }\n      this.pos += 4;\n      if (this.pos > this.data.length) {\n        throw new Error(\"Incomplete or corrupt PNG file\");\n      }\n    }\n  }\n\n  PNG.prototype.read = function(bytes) {\n    var i, _i, _results;\n    _results = [];\n    for (\n      i = _i = 0;\n      0 <= bytes ? _i < bytes : _i > bytes;\n      i = 0 <= bytes ? ++_i : --_i\n    ) {\n      _results.push(this.data[this.pos++]);\n    }\n    return _results;\n  };\n\n  PNG.prototype.readUInt32 = function() {\n    var b1, b2, b3, b4;\n    b1 = this.data[this.pos++] << 24;\n    b2 = this.data[this.pos++] << 16;\n    b3 = this.data[this.pos++] << 8;\n    b4 = this.data[this.pos++];\n    return b1 | b2 | b3 | b4;\n  };\n\n  PNG.prototype.readUInt16 = function() {\n    var b1, b2;\n    b1 = this.data[this.pos++] << 8;\n    b2 = this.data[this.pos++];\n    return b1 | b2;\n  };\n\n  PNG.prototype.decodePixels = function(data) {\n    var pixelBytes = this.pixelBitlength / 8;\n    var fullPixels = new Uint8Array(this.width * this.height * pixelBytes);\n    var pos = 0;\n    var _this = this;\n\n    if (data == null) {\n      data = this.imgData;\n    }\n    if (data.length === 0) {\n      return new Uint8Array(0);\n    }\n\n    data = unzlibSync(data);\n    function pass(x0, y0, dx, dy) {\n      var abyte,\n        c,\n        col,\n        i,\n        left,\n        length,\n        p,\n        pa,\n        paeth,\n        pb,\n        pc,\n        pixels,\n        row,\n        scanlineLength,\n        upper,\n        upperLeft,\n        _i,\n        _j,\n        _k,\n        _l,\n        _m;\n      var w = Math.ceil((_this.width - x0) / dx),\n        h = Math.ceil((_this.height - y0) / dy);\n      var isFull = _this.width == w && _this.height == h;\n      scanlineLength = pixelBytes * w;\n      pixels = isFull ? fullPixels : new Uint8Array(scanlineLength * h);\n      length = data.length;\n      row = 0;\n      c = 0;\n      while (row < h && pos < length) {\n        switch (data[pos++]) {\n          case 0:\n            for (i = _i = 0; _i < scanlineLength; i = _i += 1) {\n              pixels[c++] = data[pos++];\n            }\n            break;\n          case 1:\n            for (i = _j = 0; _j < scanlineLength; i = _j += 1) {\n              abyte = data[pos++];\n              left = i < pixelBytes ? 0 : pixels[c - pixelBytes];\n              pixels[c++] = (abyte + left) % 256;\n            }\n            break;\n          case 2:\n            for (i = _k = 0; _k < scanlineLength; i = _k += 1) {\n              abyte = data[pos++];\n              col = (i - (i % pixelBytes)) / pixelBytes;\n              upper =\n                row &&\n                pixels[\n                  (row - 1) * scanlineLength +\n                    col * pixelBytes +\n                    (i % pixelBytes)\n                ];\n              pixels[c++] = (upper + abyte) % 256;\n            }\n            break;\n          case 3:\n            for (i = _l = 0; _l < scanlineLength; i = _l += 1) {\n              abyte = data[pos++];\n              col = (i - (i % pixelBytes)) / pixelBytes;\n              left = i < pixelBytes ? 0 : pixels[c - pixelBytes];\n              upper =\n                row &&\n                pixels[\n                  (row - 1) * scanlineLength +\n                    col * pixelBytes +\n                    (i % pixelBytes)\n                ];\n              pixels[c++] = (abyte + Math.floor((left + upper) / 2)) % 256;\n            }\n            break;\n          case 4:\n            for (i = _m = 0; _m < scanlineLength; i = _m += 1) {\n              abyte = data[pos++];\n              col = (i - (i % pixelBytes)) / pixelBytes;\n              left = i < pixelBytes ? 0 : pixels[c - pixelBytes];\n              if (row === 0) {\n                upper = upperLeft = 0;\n              } else {\n                upper =\n                  pixels[\n                    (row - 1) * scanlineLength +\n                      col * pixelBytes +\n                      (i % pixelBytes)\n                  ];\n                upperLeft =\n                  col &&\n                  pixels[\n                    (row - 1) * scanlineLength +\n                      (col - 1) * pixelBytes +\n                      (i % pixelBytes)\n                  ];\n              }\n              p = left + upper - upperLeft;\n              pa = Math.abs(p - left);\n              pb = Math.abs(p - upper);\n              pc = Math.abs(p - upperLeft);\n              if (pa <= pb && pa <= pc) {\n                paeth = left;\n              } else if (pb <= pc) {\n                paeth = upper;\n              } else {\n                paeth = upperLeft;\n              }\n              pixels[c++] = (abyte + paeth) % 256;\n            }\n            break;\n          default:\n            throw new Error(\"Invalid filter algorithm: \" + data[pos - 1]);\n        }\n        if (!isFull) {\n          var fullPos = ((y0 + row * dy) * _this.width + x0) * pixelBytes;\n          var partPos = row * scanlineLength;\n          for (i = 0; i < w; i += 1) {\n            for (var j = 0; j < pixelBytes; j += 1)\n              fullPixels[fullPos++] = pixels[partPos++];\n            fullPos += (dx - 1) * pixelBytes;\n          }\n        }\n        row++;\n      }\n    }\n    if (_this.interlaceMethod == 1) {\n      /*\n          1 6 4 6 2 6 4 6\n          7 7 7 7 7 7 7 7\n          5 6 5 6 5 6 5 6\n          7 7 7 7 7 7 7 7\n          3 6 4 6 3 6 4 6\n          7 7 7 7 7 7 7 7\n          5 6 5 6 5 6 5 6\n          7 7 7 7 7 7 7 7\n        */\n      pass(0, 0, 8, 8); // 1\n      /* NOTE these seem to follow the pattern:\n       * pass(x, 0, 2*x, 2*x);\n       * pass(0, x,   x, 2*x);\n       * with x being 4, 2, 1.\n       */\n      pass(4, 0, 8, 8); // 2\n      pass(0, 4, 4, 8); // 3\n\n      pass(2, 0, 4, 4); // 4\n      pass(0, 2, 2, 4); // 5\n\n      pass(1, 0, 2, 2); // 6\n      pass(0, 1, 1, 2); // 7\n    } else {\n      pass(0, 0, 1, 1);\n    }\n    return fullPixels;\n  };\n\n  PNG.prototype.decodePalette = function() {\n    var c, i, length, palette, pos, ret, transparency, _i, _ref, _ref1;\n    palette = this.palette;\n    transparency = this.transparency.indexed || [];\n    ret = new Uint8Array((transparency.length || 0) + palette.length);\n    pos = 0;\n    length = palette.length;\n    c = 0;\n    for (i = _i = 0, _ref = length; _i < _ref; i = _i += 3) {\n      ret[pos++] = palette[i];\n      ret[pos++] = palette[i + 1];\n      ret[pos++] = palette[i + 2];\n      ret[pos++] = (_ref1 = transparency[c++]) != null ? _ref1 : 255;\n    }\n    return ret;\n  };\n\n  PNG.prototype.copyToImageData = function(imageData, pixels) {\n    var alpha, colors, data, i, input, j, k, length, palette, v, _ref;\n    colors = this.colors;\n    palette = null;\n    alpha = this.hasAlphaChannel;\n    if (this.palette.length) {\n      palette =\n        (_ref = this._decodedPalette) != null\n          ? _ref\n          : (this._decodedPalette = this.decodePalette());\n      colors = 4;\n      alpha = true;\n    }\n    data = imageData.data || imageData;\n    length = data.length;\n    input = palette || pixels;\n    i = j = 0;\n    if (colors === 1) {\n      while (i < length) {\n        k = palette ? pixels[i / 4] * 4 : j;\n        v = input[k++];\n        data[i++] = v;\n        data[i++] = v;\n        data[i++] = v;\n        data[i++] = alpha ? input[k++] : 255;\n        j = k;\n      }\n    } else {\n      while (i < length) {\n        k = palette ? pixels[i / 4] * 4 : j;\n        data[i++] = input[k++];\n        data[i++] = input[k++];\n        data[i++] = input[k++];\n        data[i++] = alpha ? input[k++] : 255;\n        j = k;\n      }\n    }\n  };\n\n  PNG.prototype.decode = function() {\n    var ret;\n    ret = new Uint8Array(this.width * this.height * 4);\n    this.copyToImageData(ret, this.decodePixels());\n    return ret;\n  };\n\n  var hasBrowserCanvas = function() {\n    if (Object.prototype.toString.call(globalObject) === \"[object Window]\") {\n      try {\n        scratchCanvas = globalObject.document.createElement(\"canvas\");\n        scratchCtx = scratchCanvas.getContext(\"2d\");\n      } catch (e) {\n        return false;\n      }\n      return true;\n    }\n    return false;\n  };\n\n  hasBrowserCanvas();\n\n  makeImage = function(imageData) {\n    if (hasBrowserCanvas() === true) {\n      var img;\n      scratchCtx.width = imageData.width;\n      scratchCtx.height = imageData.height;\n      scratchCtx.clearRect(0, 0, imageData.width, imageData.height);\n      scratchCtx.putImageData(imageData, 0, 0);\n      img = new Image();\n      img.src = scratchCanvas.toDataURL();\n      return img;\n    }\n    throw new Error(\"This method requires a Browser with Canvas-capability.\");\n  };\n\n  PNG.prototype.decodeFrames = function(ctx) {\n    var frame, i, imageData, pixels, _i, _len, _ref, _results;\n    if (!this.animation) {\n      return;\n    }\n    _ref = this.animation.frames;\n    _results = [];\n    for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n      frame = _ref[i];\n      imageData = ctx.createImageData(frame.width, frame.height);\n      pixels = this.decodePixels(new Uint8Array(frame.data));\n      this.copyToImageData(imageData, pixels);\n      frame.imageData = imageData;\n      _results.push((frame.image = makeImage(imageData)));\n    }\n    return _results;\n  };\n\n  PNG.prototype.renderFrame = function(ctx, number) {\n    var frame, frames, prev;\n    frames = this.animation.frames;\n    frame = frames[number];\n    prev = frames[number - 1];\n    if (number === 0) {\n      ctx.clearRect(0, 0, this.width, this.height);\n    }\n    if (\n      (prev != null ? prev.disposeOp : void 0) === APNG_DISPOSE_OP_BACKGROUND\n    ) {\n      ctx.clearRect(prev.xOffset, prev.yOffset, prev.width, prev.height);\n    } else if (\n      (prev != null ? prev.disposeOp : void 0) === APNG_DISPOSE_OP_PREVIOUS\n    ) {\n      ctx.putImageData(prev.imageData, prev.xOffset, prev.yOffset);\n    }\n    if (frame.blendOp === APNG_BLEND_OP_SOURCE) {\n      ctx.clearRect(frame.xOffset, frame.yOffset, frame.width, frame.height);\n    }\n    return ctx.drawImage(frame.image, frame.xOffset, frame.yOffset);\n  };\n\n  PNG.prototype.animate = function(ctx) {\n    var doFrame,\n      frameNumber,\n      frames,\n      numFrames,\n      numPlays,\n      _ref,\n      _this = this;\n    frameNumber = 0;\n    (_ref = this.animation),\n      (numFrames = _ref.numFrames),\n      (frames = _ref.frames),\n      (numPlays = _ref.numPlays);\n    return (doFrame = function() {\n      var f, frame;\n      f = frameNumber++ % numFrames;\n      frame = frames[f];\n      _this.renderFrame(ctx, f);\n      if (numFrames > 1 && frameNumber / numFrames < numPlays) {\n        return (_this.animation._timeout = setTimeout(doFrame, frame.delay));\n      }\n    })();\n  };\n\n  PNG.prototype.stopAnimation = function() {\n    var _ref;\n    return clearTimeout(\n      (_ref = this.animation) != null ? _ref._timeout : void 0\n    );\n  };\n\n  PNG.prototype.render = function(canvas) {\n    var ctx, data;\n    if (canvas._png) {\n      canvas._png.stopAnimation();\n    }\n    canvas._png = this;\n    canvas.width = this.width;\n    canvas.height = this.height;\n    ctx = canvas.getContext(\"2d\");\n    if (this.animation) {\n      this.decodeFrames(ctx);\n      return this.animate(ctx);\n    } else {\n      data = ctx.createImageData(this.width, this.height);\n      this.copyToImageData(data, this.decodePixels());\n      return ctx.putImageData(data, 0, 0);\n    }\n  };\n\n  return PNG;\n})();\n\nexport { PNG };\n","/**\n * @license\n *\n * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * ====================================================================\n */\n\nimport { jsPDF } from \"../jspdf.js\";\nimport { PNG } from \"../libs/png.js\";\n\n/**\n * jsPDF PNG PlugIn\n * @name png_support\n * @module\n */\n(function(jsPDFAPI) {\n  \"use strict\";\n\n  /*\n   * @see http://www.w3.org/TR/PNG-Chunks.html\n   *\n   Color    Allowed      Interpretation\n   Type     Bit Depths\n\n     0       1,2,4,8,16  Each pixel is a grayscale sample.\n\n     2       8,16        Each pixel is an R,G,B triple.\n\n     3       1,2,4,8     Each pixel is a palette index;\n                         a PLTE chunk must appear.\n\n     4       8,16        Each pixel is a grayscale sample,\n                         followed by an alpha sample.\n\n     6       8,16        Each pixel is an R,G,B triple,\n                         followed by an alpha sample.\n  */\n\n  /*\n   * PNG filter method types\n   *\n   * @see http://www.w3.org/TR/PNG-Filters.html\n   * @see http://www.libpng.org/pub/png/book/chapter09.html\n   *\n   * This is what the value 'Predictor' in decode params relates to\n   *\n   * 15 is \"optimal prediction\", which means the prediction algorithm can change from line to line.\n   * In that case, you actually have to read the first byte off each line for the prediction algorthim (which should be 0-4, corresponding to PDF 10-14) and select the appropriate unprediction algorithm based on that byte.\n   *\n     0       None\n     1       Sub\n     2       Up\n     3       Average\n     4       Paeth\n   */\n\n  var canCompress = function(value) {\n    return value !== jsPDFAPI.image_compression.NONE && hasCompressionJS();\n  };\n\n  var hasCompressionJS = function() {\n    return typeof zlibSync === \"function\";\n  };\n  var compressBytes = function(bytes, lineLength, colorsPerPixel, compression) {\n    var level = 4;\n    var filter_method = filterUp;\n\n    switch (compression) {\n      case jsPDFAPI.image_compression.FAST:\n        level = 1;\n        filter_method = filterSub;\n        break;\n\n      case jsPDFAPI.image_compression.MEDIUM:\n        level = 6;\n        filter_method = filterAverage;\n        break;\n\n      case jsPDFAPI.image_compression.SLOW:\n        level = 9;\n        filter_method = filterPaeth;\n        break;\n    }\n\n    bytes = applyPngFilterMethod(\n      bytes,\n      lineLength,\n      colorsPerPixel,\n      filter_method\n    );\n    var dat = zlibSync(bytes, { level: level });\n    return jsPDFAPI.__addimage__.arrayBufferToBinaryString(dat);\n  };\n\n  var applyPngFilterMethod = function(\n    bytes,\n    lineLength,\n    colorsPerPixel,\n    filter_method\n  ) {\n    var lines = bytes.length / lineLength,\n      result = new Uint8Array(bytes.length + lines),\n      filter_methods = getFilterMethods(),\n      line,\n      prevLine,\n      offset;\n\n    for (var i = 0; i < lines; i += 1) {\n      offset = i * lineLength;\n      line = bytes.subarray(offset, offset + lineLength);\n\n      if (filter_method) {\n        result.set(filter_method(line, colorsPerPixel, prevLine), offset + i);\n      } else {\n        var len = filter_methods.length,\n          results = [];\n\n        for (var j; j < len; j += 1) {\n          results[j] = filter_methods[j](line, colorsPerPixel, prevLine);\n        }\n\n        var ind = getIndexOfSmallestSum(results.concat());\n\n        result.set(results[ind], offset + i);\n      }\n\n      prevLine = line;\n    }\n\n    return result;\n  };\n\n  var filterNone = function(line) {\n    /*var result = new Uint8Array(line.length + 1);\n    result[0] = 0;\n    result.set(line, 1);*/\n\n    var result = Array.apply([], line);\n    result.unshift(0);\n\n    return result;\n  };\n\n  var filterSub = function(line, colorsPerPixel) {\n    var result = [],\n      len = line.length,\n      left;\n\n    result[0] = 1;\n\n    for (var i = 0; i < len; i += 1) {\n      left = line[i - colorsPerPixel] || 0;\n      result[i + 1] = (line[i] - left + 0x0100) & 0xff;\n    }\n\n    return result;\n  };\n\n  var filterUp = function(line, colorsPerPixel, prevLine) {\n    var result = [],\n      len = line.length,\n      up;\n\n    result[0] = 2;\n\n    for (var i = 0; i < len; i += 1) {\n      up = (prevLine && prevLine[i]) || 0;\n      result[i + 1] = (line[i] - up + 0x0100) & 0xff;\n    }\n\n    return result;\n  };\n\n  var filterAverage = function(line, colorsPerPixel, prevLine) {\n    var result = [],\n      len = line.length,\n      left,\n      up;\n\n    result[0] = 3;\n\n    for (var i = 0; i < len; i += 1) {\n      left = line[i - colorsPerPixel] || 0;\n      up = (prevLine && prevLine[i]) || 0;\n      result[i + 1] = (line[i] + 0x0100 - ((left + up) >>> 1)) & 0xff;\n    }\n\n    return result;\n  };\n\n  var filterPaeth = function(line, colorsPerPixel, prevLine) {\n    var result = [],\n      len = line.length,\n      left,\n      up,\n      upLeft,\n      paeth;\n\n    result[0] = 4;\n\n    for (var i = 0; i < len; i += 1) {\n      left = line[i - colorsPerPixel] || 0;\n      up = (prevLine && prevLine[i]) || 0;\n      upLeft = (prevLine && prevLine[i - colorsPerPixel]) || 0;\n      paeth = paethPredictor(left, up, upLeft);\n      result[i + 1] = (line[i] - paeth + 0x0100) & 0xff;\n    }\n\n    return result;\n  };\n\n  var paethPredictor = function(left, up, upLeft) {\n    if (left === up && up === upLeft) {\n      return left;\n    }\n    var pLeft = Math.abs(up - upLeft),\n      pUp = Math.abs(left - upLeft),\n      pUpLeft = Math.abs(left + up - upLeft - upLeft);\n    return pLeft <= pUp && pLeft <= pUpLeft\n      ? left\n      : pUp <= pUpLeft\n      ? up\n      : upLeft;\n  };\n\n  var getFilterMethods = function() {\n    return [filterNone, filterSub, filterUp, filterAverage, filterPaeth];\n  };\n\n  var getIndexOfSmallestSum = function(arrays) {\n    var sum = arrays.map(function(value) {\n      return value.reduce(function(pv, cv) {\n        return pv + Math.abs(cv);\n      }, 0);\n    });\n    return sum.indexOf(Math.min.apply(null, sum));\n  };\n\n  var getPredictorFromCompression = function(compression) {\n    var predictor;\n    switch (compression) {\n      case jsPDFAPI.image_compression.FAST:\n        predictor = 11;\n        break;\n\n      case jsPDFAPI.image_compression.MEDIUM:\n        predictor = 13;\n        break;\n\n      case jsPDFAPI.image_compression.SLOW:\n        predictor = 14;\n        break;\n\n      default:\n        predictor = 12;\n        break;\n    }\n    return predictor;\n  };\n\n  /**\n   * @name processPNG\n   * @function\n   * @ignore\n   */\n  jsPDFAPI.processPNG = function(imageData, index, alias, compression) {\n    \"use strict\";\n\n    var colorSpace,\n      filter = this.decode.FLATE_DECODE,\n      bitsPerComponent,\n      image,\n      decodeParameters = \"\",\n      trns,\n      colors,\n      pal,\n      smask,\n      pixels,\n      len,\n      alphaData,\n      imgData,\n      hasColors,\n      pixel,\n      i,\n      n;\n\n    if (this.__addimage__.isArrayBuffer(imageData))\n      imageData = new Uint8Array(imageData);\n\n    if (this.__addimage__.isArrayBufferView(imageData)) {\n      image = new PNG(imageData);\n      imageData = image.imgData;\n      bitsPerComponent = image.bits;\n      colorSpace = image.colorSpace;\n      colors = image.colors;\n\n      /*\n       * colorType 6 - Each pixel is an R,G,B triple, followed by an alpha sample.\n       *\n       * colorType 4 - Each pixel is a grayscale sample, followed by an alpha sample.\n       *\n       * Extract alpha to create two separate images, using the alpha as a sMask\n       */\n      if ([4, 6].indexOf(image.colorType) !== -1) {\n        /*\n         * processes 8 bit RGBA and grayscale + alpha images\n         */\n        if (image.bits === 8) {\n          pixels =\n            image.pixelBitlength == 32\n              ? new Uint32Array(image.decodePixels().buffer)\n              : image.pixelBitlength == 16\n              ? new Uint16Array(image.decodePixels().buffer)\n              : new Uint8Array(image.decodePixels().buffer);\n          len = pixels.length;\n          imgData = new Uint8Array(len * image.colors);\n          alphaData = new Uint8Array(len);\n          var pDiff = image.pixelBitlength - image.bits;\n          i = 0;\n          n = 0;\n          var pbl;\n\n          for (; i < len; i++) {\n            pixel = pixels[i];\n            pbl = 0;\n\n            while (pbl < pDiff) {\n              imgData[n++] = (pixel >>> pbl) & 0xff;\n              pbl = pbl + image.bits;\n            }\n\n            alphaData[i] = (pixel >>> pbl) & 0xff;\n          }\n        }\n\n        /*\n         * processes 16 bit RGBA and grayscale + alpha images\n         */\n        if (image.bits === 16) {\n          pixels = new Uint32Array(image.decodePixels().buffer);\n          len = pixels.length;\n          imgData = new Uint8Array(\n            len * (32 / image.pixelBitlength) * image.colors\n          );\n          alphaData = new Uint8Array(len * (32 / image.pixelBitlength));\n          hasColors = image.colors > 1;\n          i = 0;\n          n = 0;\n          var a = 0;\n\n          while (i < len) {\n            pixel = pixels[i++];\n\n            imgData[n++] = (pixel >>> 0) & 0xff;\n\n            if (hasColors) {\n              imgData[n++] = (pixel >>> 16) & 0xff;\n\n              pixel = pixels[i++];\n              imgData[n++] = (pixel >>> 0) & 0xff;\n            }\n\n            alphaData[a++] = (pixel >>> 16) & 0xff;\n          }\n          bitsPerComponent = 8;\n        }\n\n        if (canCompress(compression)) {\n          imageData = compressBytes(\n            imgData,\n            image.width * image.colors,\n            image.colors,\n            compression\n          );\n          smask = compressBytes(alphaData, image.width, 1, compression);\n        } else {\n          imageData = imgData;\n          smask = alphaData;\n          filter = undefined;\n        }\n      }\n\n      /*\n       * Indexed png. Each pixel is a palette index.\n       */\n      if (image.colorType === 3) {\n        colorSpace = this.color_spaces.INDEXED;\n        pal = image.palette;\n\n        if (image.transparency.indexed) {\n          var trans = image.transparency.indexed;\n          var total = 0;\n          i = 0;\n          len = trans.length;\n\n          for (; i < len; ++i) {\n            total += trans[i];\n          }\n\n          total = total / 255;\n\n          /*\n           * a single color is specified as 100% transparent (0),\n           * so we set trns to use a /Mask with that index\n           */\n          if (total === len - 1 && trans.indexOf(0) !== -1) {\n            trns = [trans.indexOf(0)];\n\n            /*\n             * there's more than one colour within the palette that specifies\n             * a transparency value less than 255, so we unroll the pixels to create an image sMask\n             */\n          } else if (total !== len) {\n            pixels = image.decodePixels();\n            alphaData = new Uint8Array(pixels.length);\n            i = 0;\n            len = pixels.length;\n\n            for (; i < len; i++) {\n              alphaData[i] = trans[pixels[i]];\n            }\n\n            smask = compressBytes(alphaData, image.width, 1);\n          }\n        }\n      }\n\n      var predictor = getPredictorFromCompression(compression);\n\n      if (filter === this.decode.FLATE_DECODE) {\n        decodeParameters = \"/Predictor \" + predictor + \" \";\n      }\n      decodeParameters +=\n        \"/Colors \" +\n        colors +\n        \" /BitsPerComponent \" +\n        bitsPerComponent +\n        \" /Columns \" +\n        image.width;\n\n      if (\n        this.__addimage__.isArrayBuffer(imageData) ||\n        this.__addimage__.isArrayBufferView(imageData)\n      ) {\n        imageData = this.__addimage__.arrayBufferToBinaryString(imageData);\n      }\n\n      if (\n        (smask && this.__addimage__.isArrayBuffer(smask)) ||\n        this.__addimage__.isArrayBufferView(smask)\n      ) {\n        smask = this.__addimage__.arrayBufferToBinaryString(smask);\n      }\n\n      return {\n        alias: alias,\n        data: imageData,\n        index: index,\n        filter: filter,\n        decodeParameters: decodeParameters,\n        transparency: trns,\n        palette: pal,\n        sMask: smask,\n        predictor: predictor,\n        width: image.width,\n        height: image.height,\n        bitsPerComponent: bitsPerComponent,\n        colorSpace: colorSpace\n      };\n    }\n  };\n})(jsPDF.API);\n"],"names":["globalObject","window","global","self","atob","btoa","bind","consoleLog","console","log","apply","arguments","consoleWarn","str","warn","call","consoleError","error","PubSub","context","Error","topics","subscribe","topic","callback","once","hasOwnProperty","token","Math","random","toString","unsubscribe","Object","keys","length","publish","args","Array","prototype","slice","tokens","sub","ex","message","push","forEach","getTopics","jsPDF","options","orientation","unit","format","compressPdf","filters","userUnit","precision","floatPrecision","compress","abs","toLowerCase","API","internal","__private__","pdfVersion","getPdfVersion","setPdfVersion","value","ApiMode","COMPAT","ADVANCED","apiMode","isAdvancedAPI","roundToPrecision","number","parmPrecision","tmpPrecision","isNaN","toFixed","replace","hpf","scale","scaleFactor","fileId","getFileId","setFileId","test","toUpperCase","split","map","charAt","floor","join","creationDate","convertDateToPDFDate","parmDate","result","tzoffset","getTimezoneOffset","tzsign","tzhour","tzmin","timeZoneString","padd2","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","convertPDFDateToDate","parmPDFDate","year","parseInt","substr","month","date","hour","minutes","seconds","resultingDate","Date","setCreationDate","tmpCreationDateString","regexPDFCreationDate","getCreationDate","type","objectNumber","offsets","content","contentLength","additionalObjects","pages","currentPage","outputDestination","resetDocument","rootDictionaryObjId","newObjectDeferred","resourceDictionaryObjId","setOutputDestination","destination","out","string","write","getArrayBuffer","data","len","ab","ArrayBuffer","u8","Uint8Array","charCodeAt","pageMode","getPageMode","layoutMode","getLayoutMode","documentProperties","title","subject","author","keywords","creator","fonts","activeFontKey","page","pagesContext","events","hotfixes","renderTargets","matrixMult","m1","m2","multiply","newObject","oid","newObjectDeferredBegin","doOutput","newAdditionalObject","objId","obj","getFilters","putStream","alreadyAppliedFilters","addLength1","valueOfLength1","processedData","keyValues","additionalKeyValues","processDataByFilters","reverseChain","filterAsString","isArray","key","j","decodeParmsArray","i","k","putPage","pageNumber","pageObjectNumber","pageContentsObjId","contentsObjId","parseFloat","mediaBox","bottomLeftX","bottomLeftY","topRightX","topRightY","cropBox","bleedBox","trimBox","artBox","pageContext","pageContent","objectId","putPages","n","pageObjectNumbers","kids","putXobjectDict","xObjectKey","putResourceDictionary","objectIds","resourcesOid","putResources","deferredResourceDictionaryIds","objectOid","Number","MAX_SAFE_INTEGER","SAFE","__safeCall","fn","foo","__safeCallWrapper","e","stack","indexOf","m","alert","bar","to8bitStream","text","flags","l","sourceEncoding","encodingBlock","outputEncoding","newtext","isUnicode","ch","bch","autoencode","metadata","encoding","codePages","String","fromCharCode","undefined","noBOM","pdfEscape","beginPage","_setPage","_addPage","parmFormat","width","height","min","getNumberOfPages","putInfo","version","putCatalog","tmpRootDictionaryObjId","putTrailer","putHeader","putXRef","p","offset","buildDocument","offsetOfXRef","output","filename","dataURI","pdfDocument","unescape","encodeURIComponent","hasHotfix","hotfixName","addPage","isValidStyle","style","validStyleVariants","close","getHorizontalCoordinate","getVerticalCoordinate","pageHeight","getHorizontalCoordinateString","getVerticalCoordinateString","plugin","newEvents","eventname","handler_and_args","concat","getCoordinateString","collections","getPDFVersion","jsPDFAPI","namespace","__addimage__","ARRAY_APPLY_BATCH","putImage","image","filter","splice","colorSpace","color_spaces","INDEXED","palette","sMask","DEVICE_CMYK","bitsPerComponent","decodeParameters","transparency","predictor","arrayBufferToBinaryString","putResourcesCallback","images","putXObjectsDictCallback","index","checkCompressValue","image_compression","NONE","initialize","getImages","getImageIndex","notDefined","generateAliasFromImageData","imageData","isArrayBufferView","sHashCode","isImageTypeSupported","checkImagesForAlias","alias","determineWidthAndHeight","writeImageToPDF","x","y","rotation","dims","coord","vcoord","PI","c","cos","s","sin","f4","rotationTransformationMatrix","DEVICE_RGB","DEVICE_GRAY","CAL_GREY","CAL_RGB","LAB","ICC_BASED","PATTERN","SEPARATION","DEVICE_N","decode","DCT_DECODE","FLATE_DECODE","LZW_DECODE","JPX_DECODE","JBIG2_DECODE","ASCII85_DECODE","ASCII_HEX_DECODE","RUN_LENGTH_DECODE","CCITT_FAX_DECODE","FAST","MEDIUM","SLOW","hash","byteLength","validateStringAsBase64","possibleBase64String","trim","extractImageFromDataUrl","dataUrl","dataUrlParts","extractedInfo","exec","mimeType","charset","supportsArrayBuffer","isArrayBuffer","object","Uint32Array","Int8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Float32Array","Float64Array","binaryStringToUint8Array","binary_string","bytes","buffer","buf","subarray","addImage","w","h","compression","processImageData","dataAsBinaryString","tmpImageData","convertBase64ToBinaryString","stringData","throwError","base64Info","rawData","getImageProperties","fileType","PNG","APNG_BLEND_OP_SOURCE","APNG_DISPOSE_OP_BACKGROUND","APNG_DISPOSE_OP_PREVIOUS","makeImage","scratchCanvas","scratchCtx","chunkSize","colors","palLen","delayDen","delayNum","frame","section","palShort","_i","_j","_ref","pos","imgData","animation","readUInt32","_results","bits","colorType","compressionMethod","filterMethod","interlaceMethod","numFrames","numPlays","Infinity","frames","read","xOffset","yOffset","readUInt16","delay","disposeOp","blendOp","indexed","grayscale","rgb","hasAlphaChannel","pixelBitlength","b1","b2","b3","b4","decodePixels","pixelBytes","fullPixels","_this","unzlibSync","pass","x0","y0","dx","dy","abyte","col","left","pa","paeth","pb","pc","pixels","row","scanlineLength","upper","upperLeft","_k","_l","_m","ceil","isFull","fullPos","partPos","decodePalette","ret","_ref1","copyToImageData","alpha","input","v","_decodedPalette","hasBrowserCanvas","document","createElement","getContext","img","clearRect","putImageData","Image","src","toDataURL","decodeFrames","ctx","_len","createImageData","renderFrame","prev","drawImage","animate","doFrame","frameNumber","f","_timeout","setTimeout","stopAnimation","clearTimeout","render","canvas","_png","canCompress","hasCompressionJS","zlibSync","compressBytes","lineLength","colorsPerPixel","level","filter_method","filterUp","filterSub","filterAverage","filterPaeth","applyPngFilterMethod","dat","lines","filter_methods","getFilterMethods","line","prevLine","set","results","ind","getIndexOfSmallestSum","filterNone","unshift","up","upLeft","paethPredictor","pLeft","pUp","pUpLeft","arrays","sum","reduce","pv","cv","getPredictorFromCompression","processPNG","trns","pal","smask","alphaData","hasColors","pixel","pDiff","pbl","a","trans","total"],"mappings":"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"}